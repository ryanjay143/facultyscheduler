import{c as Be,j as e,m as bt,d as qt,f as yr,B as q,R as g,r as d,i as Ce,t as k,a as ce,T as Sr,k as Rt,l as Dt,n as It,o as Bt,p as Nr,h as Cr,P as Ut,q as Tr,u as Lr,A as Er}from"./index-D4cq_vOu.js";import{I as W}from"./input-BY_p0uZ5.js";import{S as Te,a as Le,b as Ee,c as Ae,d as xe,u as Ar}from"./select-YhEn_NCI.js";import{C as kr,T as _r,g as Rr,R as Dr,P as Ir,h as Pr,O as Or,D as $e,a as Me,b as Fe,c as ze,d as lt,e as He,f as Ye}from"./dialog-CMkDFE1D.js";import{B as $r}from"./book-copy-14ErJzuV.js";import{S as vt}from"./square-pen-mZVRwhAV.js";import{T as Tt}from"./trash-2-DYeMOeXt.js";import{S as Pe}from"./skeleton-1een8wfN.js";import{T as jt,a as wt,b as ie,c as Y,d as yt,e as R,f as St}from"./table-CChJsJ2a.js";import{B as mt}from"./badge-zWJmg32f.js";import{C as Mr}from"./calendar-days-CeR8d6__.js";import{L as Pt}from"./layers-CnJRJ7Wd.js";import{P as Lt}from"./plus-KaDjQXw_.js";import{L as X}from"./label-BuqVtY81.js";import{L as Et}from"./loader-circle-CTjplTeF.js";import{C as Ot}from"./circle-alert-DhW4-FNX.js";import{S as Fr}from"./search-DRHFIsZU.js";import"./Combination-aR6sbofW.js";import"./check-CUMF764Q.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Hr=Be("activity",zr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],qr=Be("archive-restore",Yr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ur=Be("archive",Br);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=[["path",{d:"M12 21V7",key:"gj6g52"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V4a1 1 0 0 0-1-1h-5a4 4 0 0 0-4 4 4 4 0 0 0-4-4H3a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h6a3 3 0 0 1 3 3 3 3 0 0 1 3-3h6a1 1 0 0 0 1-1v-1.3",key:"8arnkb"}]],Wr=Be("book-open-check",Vr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Kr=Be("school",Xr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],Gr=Be("sliders-horizontal",Jr),$t=["from-purple-600 to-indigo-600","from-blue-500 to-teal-400","from-pink-500 to-rose-500","from-orange-500 to-amber-500","from-green-500 to-lime-500","from-cyan-500 to-sky-500"],Qr={hidden:{opacity:0,y:20},visible:t=>({opacity:1,y:0,transition:{delay:t*.05}})};function Zr({program:t,index:s,onEdit:r,onArchive:a,onRestore:o,onManage:n,readOnly:j=!1}){const c=t.total_subjects,N=t.total_units,w=()=>e.jsxs(e.Fragment,{children:[e.jsx(q,{size:"icon",variant:"ghost",title:"Edit Program",onClick:h=>{h.stopPropagation(),r&&r(t)},className:"h-8 w-8 bg-black/20 hover:bg-green-500",children:e.jsx(vt,{size:16})}),t.isActive?e.jsx(q,{size:"icon",variant:"ghost",title:"Archive Program",onClick:h=>{h.stopPropagation(),a&&a(t.id)},className:"h-8 w-8 bg-black/20 hover:bg-destructive/80",children:e.jsx(Tt,{size:16})}):e.jsx(q,{size:"icon",variant:"ghost",title:"Restore Program",onClick:h=>{h.stopPropagation(),o&&o(t.id)},className:"h-8 w-8 bg-black/20 hover:bg-green-500",children:e.jsx(qr,{size:16})})]});return e.jsxs(bt.div,{variants:Qr,custom:s,initial:"hidden",animate:"visible",exit:"hidden",className:"bg-card rounded-xl border border-border shadow-sm overflow-hidden group flex flex-col transition-all duration-300 hover:shadow-md hover:-translate-y-1",children:[e.jsxs("div",{className:`p-5 bg-gradient-to-br text-white relative ${$t[s%$t.length]} ${!t.isActive&&"opacity-60"}`,children:[e.jsx("h2",{className:"text-xl font-bold pr-20",children:t.abbreviation}),e.jsx("p",{className:"opacity-80 truncate text-sm pr-20",children:t.name}),!t.isActive&&e.jsx("div",{className:"absolute bottom-2 left-5 px-2.5 py-1 bg-red-600/90 text-white text-[10px] font-bold rounded-full uppercase tracking-wider",children:"Inactive"}),!j&&e.jsx("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(w,{})})]}),e.jsxs("div",{className:"p-5 flex-grow flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-4",children:[e.jsx(qt,{size:15}),e.jsxs("span",{children:["A.Y. ",t.effectiveYear]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center text-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx($r,{size:15,className:"text-muted-foreground"}),e.jsx("span",{children:"Total Subjects"})]}),e.jsx("span",{className:"px-2.5 py-0.5 bg-muted text-muted-foreground rounded-full font-semibold",children:c})]}),e.jsxs("div",{className:"flex justify-between items-center text-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(yr,{size:15,className:"text-muted-foreground"}),e.jsx("span",{children:"Total Units"})]}),e.jsx("span",{className:"px-2.5 py-0.5 bg-muted text-muted-foreground rounded-full font-semibold",children:N})]})]})]}),e.jsx(q,{onClick:n,className:"w-full mt-5",variant:"secondary",disabled:!t.isActive,children:j?"View Curriculum":"Manage Curriculum"})]})]})}function es(){return e.jsxs("div",{className:"bg-card rounded-xl border border-border shadow-sm p-5 space-y-4",children:[e.jsx(Pe,{className:"h-8 w-1/4"}),e.jsx(Pe,{className:"h-5 w-3/4"}),e.jsxs("div",{className:"pt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Pe,{className:"h-5 w-1/2"}),e.jsx(Pe,{className:"h-6 w-10 rounded-full"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Pe,{className:"h-5 w-1/2"}),e.jsx(Pe,{className:"h-6 w-10 rounded-full"})]})]}),e.jsx(Pe,{className:"h-10 w-full mt-5"})]})}function ts(t){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",s.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const Vt=g.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Qe=()=>{const t=g.useContext(Vt);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};ts(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function rs(){const t=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(t)&&/Mobile/.test(t)||/FxiOS/.test(t))}function ss(){return At(/^Mac/)}function ns(){return At(/^iPhone/)}function Mt(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function as(){return At(/^iPad/)||ss()&&navigator.maxTouchPoints>1}function Wt(){return ns()||as()}function At(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const os=24,is=typeof window<"u"?d.useLayoutEffect:d.useEffect;function Ft(...t){return(...s)=>{for(let r of t)typeof r=="function"&&r(...s)}}const ht=typeof document<"u"&&window.visualViewport;function zt(t){let s=window.getComputedStyle(t);return/(auto|scroll)/.test(s.overflow+s.overflowX+s.overflowY)}function Xt(t){for(zt(t)&&(t=t.parentElement);t&&!zt(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const ls=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let ot=0,ft;function cs(t={}){let{isDisabled:s}=t;is(()=>{if(!s)return ot++,ot===1&&Wt()&&(ft=us()),()=>{ot--,ot===0&&ft?.()}},[s])}function us(){let t,s=0,r=m=>{t=Xt(m.target),!(t===document.documentElement&&t===document.body)&&(s=m.changedTouches[0].pageY)},a=m=>{if(!t||t===document.documentElement||t===document.body){m.preventDefault();return}let u=m.changedTouches[0].pageY,P=t.scrollTop,y=t.scrollHeight-t.clientHeight;y!==0&&((P<=0&&u>s||P>=y&&u<s)&&m.preventDefault(),s=u)},o=m=>{let u=m.target;Nt(u)&&u!==document.activeElement&&(m.preventDefault(),u.style.transform="translateY(-2000px)",u.focus(),requestAnimationFrame(()=>{u.style.transform=""}))},n=m=>{let u=m.target;Nt(u)&&(u.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{u.style.transform="",ht&&(ht.height<window.innerHeight?requestAnimationFrame(()=>{Ht(u)}):ht.addEventListener("resize",()=>Ht(u),{once:!0}))}))},j=()=>{window.scrollTo(0,0)},c=window.pageXOffset,N=window.pageYOffset,w=Ft(ds(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let h=Ft(Ke(document,"touchstart",r,{passive:!1,capture:!0}),Ke(document,"touchmove",a,{passive:!1,capture:!0}),Ke(document,"touchend",o,{passive:!1,capture:!0}),Ke(document,"focus",n,!0),Ke(window,"scroll",j));return()=>{w(),h(),window.scrollTo(c,N)}}function ds(t,s,r){let a=t.style[s];return t.style[s]=r,()=>{t.style[s]=a}}function Ke(t,s,r,a){return t.addEventListener(s,r,a),()=>{t.removeEventListener(s,r,a)}}function Ht(t){let s=document.scrollingElement||document.documentElement;for(;t&&t!==s;){let r=Xt(t);if(r!==document.documentElement&&r!==document.body&&r!==t){let a=r.getBoundingClientRect().top,o=t.getBoundingClientRect().top,n=t.getBoundingClientRect().bottom;const j=r.getBoundingClientRect().bottom+os;n>j&&(r.scrollTop+=o-a)}t=r.parentElement}}function Nt(t){return t instanceof HTMLInputElement&&!ls.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function ms(t,s){typeof t=="function"?t(s):t!=null&&(t.current=s)}function hs(...t){return s=>t.forEach(r=>ms(r,s))}function Kt(...t){return d.useCallback(hs(...t),t)}const Jt=new WeakMap;function ee(t,s,r=!1){if(!t||!(t instanceof HTMLElement))return;let a={};Object.entries(s).forEach(([o,n])=>{if(o.startsWith("--")){t.style.setProperty(o,n);return}a[o]=t.style[o],t.style[o]=n}),!r&&Jt.set(t,a)}function fs(t,s){if(!t||!(t instanceof HTMLElement))return;let r=Jt.get(t);r&&(t.style[s]=r[s])}const Q=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function it(t,s){if(!t)return null;const r=window.getComputedStyle(t),a=r.transform||r.webkitTransform||r.mozTransform;let o=a.match(/^matrix3d\((.+)\)$/);return o?parseFloat(o[1].split(", ")[Q(s)?13:12]):(o=a.match(/^matrix\((.+)\)$/),o?parseFloat(o[1].split(", ")[Q(s)?5:4]):null)}function ps(t){return 8*(Math.log(t+1)-2)}function pt(t,s){if(!t)return()=>{};const r=t.style.cssText;return Object.assign(t.style,s),()=>{t.style.cssText=r}}function xs(...t){return(...s)=>{for(const r of t)typeof r=="function"&&r(...s)}}const V={DURATION:.5,EASE:[.32,.72,0,1]},Gt=.4,gs=.25,bs=100,Qt=8,Oe=16,Ct=26,xt="vaul-dragging";function Zt(t){const s=g.useRef(t);return g.useEffect(()=>{s.current=t}),g.useMemo(()=>(...r)=>s.current==null?void 0:s.current.call(s,...r),[])}function vs({defaultProp:t,onChange:s}){const r=g.useState(t),[a]=r,o=g.useRef(a),n=Zt(s);return g.useEffect(()=>{o.current!==a&&(n(a),o.current=a)},[a,o,n]),r}function er({prop:t,defaultProp:s,onChange:r=()=>{}}){const[a,o]=vs({defaultProp:s,onChange:r}),n=t!==void 0,j=n?t:a,c=Zt(r),N=g.useCallback(w=>{if(n){const m=typeof w=="function"?w(t):w;m!==t&&c(m)}else o(w)},[n,t,o,c]);return[j,N]}function js({activeSnapPointProp:t,setActiveSnapPointProp:s,snapPoints:r,drawerRef:a,overlayRef:o,fadeFromIndex:n,onSnapPointChange:j,direction:c="bottom",container:N,snapToSequentialPoint:w}){const[h,m]=er({prop:t,defaultProp:r?.[0],onChange:s}),[u,P]=g.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);g.useEffect(()=>{function E(){P({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const y=g.useMemo(()=>h===r?.[r.length-1]||null,[r,h]),C=g.useMemo(()=>{var E;return(E=r?.findIndex(l=>l===h))!=null?E:null},[r,h]),b=r&&r.length>0&&(n||n===0)&&!Number.isNaN(n)&&r[n]===h||!r,i=g.useMemo(()=>{const E=N?{width:N.getBoundingClientRect().width,height:N.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var l;return(l=r?.map(x=>{const S=typeof x=="string";let D=0;if(S&&(D=parseInt(x,10)),Q(c)){const v=S?D:u?x*E.height:0;return u?c==="bottom"?E.height-v:-E.height+v:v}const z=S?D:u?x*E.width:0;return u?c==="right"?E.width-z:-E.width+z:z}))!=null?l:[]},[r,u,N]),p=g.useMemo(()=>C!==null?i?.[C]:null,[i,C]),L=g.useCallback(E=>{var l;const x=(l=i?.findIndex(S=>S===E))!=null?l:null;j(x),ee(a.current,{transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,transform:Q(c)?`translate3d(0, ${E}px, 0)`:`translate3d(${E}px, 0, 0)`}),i&&x!==i.length-1&&n!==void 0&&x!==n&&x<n?ee(o.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,opacity:"0"}):ee(o.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,opacity:"1"}),m(r?.[Math.max(x,0)])},[a.current,r,i,n,o,m]);g.useEffect(()=>{if(h||t){var E;const l=(E=r?.findIndex(x=>x===t||x===h))!=null?E:-1;i&&l!==-1&&typeof i[l]=="number"&&L(i[l])}},[h,t,r,i,L]);function f({draggedDistance:E,closeDrawer:l,velocity:x,dismissible:S}){if(n===void 0)return;const D=c==="bottom"||c==="right"?(p??0)-E:(p??0)+E,z=C===n-1,v=C===0,K=E>0;if(z&&ee(o.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`}),!w&&x>2&&!K){S?l():L(i[0]);return}if(!w&&x>2&&K&&i&&r){L(i[r.length-1]);return}const $=i?.reduce((Z,ue)=>typeof Z!="number"||typeof ue!="number"?Z:Math.abs(ue-D)<Math.abs(Z-D)?ue:Z),se=Q(c)?window.innerHeight:window.innerWidth;if(x>Gt&&Math.abs(E)<se*.4){const Z=K?1:-1;if(Z>0&&y&&r){L(i[r.length-1]);return}if(v&&Z<0&&S&&l(),C===null)return;L(i[C+Z]);return}L($)}function _({draggedDistance:E}){if(p===null)return;const l=c==="bottom"||c==="right"?p-E:p+E;(c==="bottom"||c==="right")&&l<i[i.length-1]||(c==="top"||c==="left")&&l>i[i.length-1]||ee(a.current,{transform:Q(c)?`translate3d(0, ${l}px, 0)`:`translate3d(${l}px, 0, 0)`})}function U(E,l){if(!r||typeof C!="number"||!i||n===void 0)return null;const x=C===n-1;if(C>=n&&l)return 0;if(x&&!l)return 1;if(!b&&!x)return null;const D=x?C+1:C-1,z=x?i[D]-i[D-1]:i[D+1]-i[D],v=E/Math.abs(z);return x?1-v:v}return{isLastSnapPoint:y,activeSnapPoint:h,shouldFade:b,getPercentageDragged:U,setActiveSnapPoint:m,activeSnapPointIndex:C,onRelease:f,onDrag:_,snapPointsOffset:i}}const ws=()=>()=>{};function ys(){const{direction:t,isOpen:s,shouldScaleBackground:r,setBackgroundColorOnScale:a,noBodyStyles:o}=Qe(),n=g.useRef(null),j=d.useMemo(()=>document.body.style.backgroundColor,[]);function c(){return(window.innerWidth-Ct)/window.innerWidth}g.useEffect(()=>{if(s&&r){n.current&&clearTimeout(n.current);const N=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!N)return;xs(a&&!o?pt(document.body,{background:"black"}):ws,pt(N,{transformOrigin:Q(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${V.DURATION}s`,transitionTimingFunction:`cubic-bezier(${V.EASE.join(",")})`}));const w=pt(N,{borderRadius:`${Qt}px`,overflow:"hidden",...Q(t)?{transform:`scale(${c()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${c()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{w(),n.current=window.setTimeout(()=>{j?document.body.style.background=j:document.body.style.removeProperty("background")},V.DURATION*1e3)}}},[s,r,j])}let Je=null;function Ss({isOpen:t,modal:s,nested:r,hasBeenOpened:a,preventScrollRestoration:o,noBodyStyles:n}){const[j,c]=g.useState(()=>typeof window<"u"?window.location.href:""),N=g.useRef(0),w=g.useCallback(()=>{if(Mt()&&Je===null&&t&&!n){Je={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:m,innerHeight:u}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-N.current}px`,left:`${-m}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const P=u-window.innerHeight;P&&N.current>=u&&(document.body.style.top=`${-(N.current+P)}px`)}),300)}},[t]),h=g.useCallback(()=>{if(Mt()&&Je!==null&&!n){const m=-parseInt(document.body.style.top,10),u=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Je),window.requestAnimationFrame(()=>{if(o&&j!==window.location.href){c(window.location.href);return}window.scrollTo(u,m)}),Je=null}},[j]);return g.useEffect(()=>{function m(){N.current=window.scrollY}return m(),window.addEventListener("scroll",m),()=>{window.removeEventListener("scroll",m)}},[]),g.useEffect(()=>{if(s)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||h()}},[s,h]),g.useEffect(()=>{r||!a||(t?(!window.matchMedia("(display-mode: standalone)").matches&&w(),s||window.setTimeout(()=>{h()},500)):h())},[t,a,j,s,r,w,h]),{restorePositionSetting:h}}function Ns({open:t,onOpenChange:s,children:r,onDrag:a,onRelease:o,snapPoints:n,shouldScaleBackground:j=!1,setBackgroundColorOnScale:c=!0,closeThreshold:N=gs,scrollLockTimeout:w=bs,dismissible:h=!0,handleOnly:m=!1,fadeFromIndex:u=n&&n.length-1,activeSnapPoint:P,setActiveSnapPoint:y,fixed:C,modal:b=!0,onClose:i,nested:p,noBodyStyles:L=!1,direction:f="bottom",defaultOpen:_=!1,disablePreventScroll:U=!0,snapToSequentialPoint:E=!1,preventScrollRestoration:l=!1,repositionInputs:x=!0,onAnimationEnd:S,container:D,autoFocus:z=!1}){var v,K;const[$=!1,se]=er({defaultProp:_,prop:t,onChange:A=>{s?.(A),!A&&!p&&Re(),setTimeout(()=>{S?.(A)},V.DURATION*1e3),A&&!b&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),A||(document.body.style.pointerEvents="auto")}}),[Z,ue]=g.useState(!1),[de,le]=g.useState(!1),[Ue,me]=g.useState(!1),je=g.useRef(null),qe=g.useRef(null),Ve=g.useRef(null),We=g.useRef(null),ke=g.useRef(null),ne=g.useRef(!1),be=g.useRef(null),_e=g.useRef(0),ve=g.useRef(!1),Ze=g.useRef(!_),et=g.useRef(0),I=g.useRef(null),tt=g.useRef(((v=I.current)==null?void 0:v.getBoundingClientRect().height)||0),rt=g.useRef(((K=I.current)==null?void 0:K.getBoundingClientRect().width)||0),Xe=g.useRef(0),ut=g.useCallback(A=>{n&&A===T.length-1&&(qe.current=new Date)},[]),{activeSnapPoint:dt,activeSnapPointIndex:we,setActiveSnapPoint:st,onRelease:nt,snapPointsOffset:T,onDrag:O,shouldFade:M,getPercentageDragged:ye}=js({snapPoints:n,activeSnapPointProp:P,setActiveSnapPointProp:y,drawerRef:I,fadeFromIndex:u,overlayRef:je,onSnapPointChange:ut,direction:f,container:D,snapToSequentialPoint:E});cs({isDisabled:!$||de||!b||Ue||!Z||!x||!U});const{restorePositionSetting:Re}=Ss({isOpen:$,modal:b,nested:p??!1,hasBeenOpened:Z,preventScrollRestoration:l,noBodyStyles:L});function G(){return(window.innerWidth-Ct)/window.innerWidth}function De(A){var H,B;!h&&!n||I.current&&!I.current.contains(A.target)||(tt.current=((H=I.current)==null?void 0:H.getBoundingClientRect().height)||0,rt.current=((B=I.current)==null?void 0:B.getBoundingClientRect().width)||0,le(!0),Ve.current=new Date,Wt()&&window.addEventListener("touchend",()=>ne.current=!1,{once:!0}),A.target.setPointerCapture(A.pointerId),_e.current=Q(f)?A.pageY:A.pageX)}function te(A,H){var B;let F=A;const J=(B=window.getSelection())==null?void 0:B.toString(),oe=I.current?it(I.current,f):null,ae=new Date;if(F.tagName==="SELECT"||F.hasAttribute("data-vaul-no-drag")||F.closest("[data-vaul-no-drag]"))return!1;if(f==="right"||f==="left")return!0;if(qe.current&&ae.getTime()-qe.current.getTime()<500)return!1;if(oe!==null&&(f==="bottom"?oe>0:oe<0))return!0;if(J&&J.length>0)return!1;if(ke.current&&ae.getTime()-ke.current.getTime()<w&&oe===0||H)return ke.current=ae,!1;for(;F;){if(F.scrollHeight>F.clientHeight){if(F.scrollTop!==0)return ke.current=new Date,!1;if(F.getAttribute("role")==="dialog")return!0}F=F.parentNode}return!0}function he(A){if(I.current&&de){const H=f==="bottom"||f==="right"?1:-1,B=(_e.current-(Q(f)?A.pageY:A.pageX))*H,F=B>0,J=n&&!h&&!F;if(J&&we===0)return;const oe=Math.abs(B),ae=document.querySelector("[data-vaul-drawer-wrapper]"),Se=f==="bottom"||f==="top"?tt.current:rt.current;let fe=oe/Se;const Ie=ye(oe,F);if(Ie!==null&&(fe=Ie),J&&fe>=1||!ne.current&&!te(A.target,F))return;if(I.current.classList.add(xt),ne.current=!0,ee(I.current,{transition:"none"}),ee(je.current,{transition:"none"}),n&&O({draggedDistance:B}),F&&!n){const pe=ps(B),at=Math.min(pe*-1,0)*H;ee(I.current,{transform:Q(f)?`translate3d(0, ${at}px, 0)`:`translate3d(${at}px, 0, 0)`});return}const Ne=1-fe;if((M||u&&we===u-1)&&(a?.(A,fe),ee(je.current,{opacity:`${Ne}`,transition:"none"},!0)),ae&&je.current&&j){const pe=Math.min(G()+fe*(1-G()),1),at=8-fe*8,_t=Math.max(0,14-fe*14);ee(ae,{borderRadius:`${at}px`,transform:Q(f)?`scale(${pe}) translate3d(0, ${_t}px, 0)`:`scale(${pe}) translate3d(${_t}px, 0, 0)`,transition:"none"},!0)}if(!n){const pe=oe*H;ee(I.current,{transform:Q(f)?`translate3d(0, ${pe}px, 0)`:`translate3d(${pe}px, 0, 0)`})}}}g.useEffect(()=>{window.requestAnimationFrame(()=>{Ze.current=!0})},[]),g.useEffect(()=>{var A;function H(){if(!I.current||!x)return;const B=document.activeElement;if(Nt(B)||ve.current){var F;const J=((F=window.visualViewport)==null?void 0:F.height)||0,oe=window.innerHeight;let ae=oe-J;const Se=I.current.getBoundingClientRect().height||0,fe=Se>oe*.8;Xe.current||(Xe.current=Se);const Ie=I.current.getBoundingClientRect().top;if(Math.abs(et.current-ae)>60&&(ve.current=!ve.current),n&&n.length>0&&T&&we){const Ne=T[we]||0;ae+=Ne}if(et.current=ae,Se>J||ve.current){const Ne=I.current.getBoundingClientRect().height;let pe=Ne;Ne>J&&(pe=J-(fe?Ie:Ct)),C?I.current.style.height=`${Ne-Math.max(ae,0)}px`:I.current.style.height=`${Math.max(pe,J-Ie)}px`}else rs()||(I.current.style.height=`${Xe.current}px`);n&&n.length>0&&!ve.current?I.current.style.bottom="0px":I.current.style.bottom=`${Math.max(ae,0)}px`}}return(A=window.visualViewport)==null||A.addEventListener("resize",H),()=>{var B;return(B=window.visualViewport)==null?void 0:B.removeEventListener("resize",H)}},[we,n,T]);function re(A){gr(),i?.(),A||se(!1),setTimeout(()=>{n&&st(n[0])},V.DURATION*1e3)}function kt(){if(!I.current)return;const A=document.querySelector("[data-vaul-drawer-wrapper]"),H=it(I.current,f);ee(I.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`}),ee(je.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,opacity:"1"}),j&&H&&H>0&&$&&ee(A,{borderRadius:`${Qt}px`,overflow:"hidden",...Q(f)?{transform:`scale(${G()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${G()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${V.DURATION}s`,transitionTimingFunction:`cubic-bezier(${V.EASE.join(",")})`},!0)}function gr(){!de||!I.current||(I.current.classList.remove(xt),ne.current=!1,le(!1),We.current=new Date)}function br(A){if(!de||!I.current)return;I.current.classList.remove(xt),ne.current=!1,le(!1),We.current=new Date;const H=it(I.current,f);if(!A||!te(A.target,!1)||!H||Number.isNaN(H)||Ve.current===null)return;const B=We.current.getTime()-Ve.current.getTime(),F=_e.current-(Q(f)?A.pageY:A.pageX),J=Math.abs(F)/B;if(J>.05&&(me(!0),setTimeout(()=>{me(!1)},200)),n){nt({draggedDistance:F*(f==="bottom"||f==="right"?1:-1),closeDrawer:re,velocity:J,dismissible:h}),o?.(A,!0);return}if(f==="bottom"||f==="right"?F>0:F<0){kt(),o?.(A,!0);return}if(J>Gt){re(),o?.(A,!1);return}var oe;const ae=Math.min((oe=I.current.getBoundingClientRect().height)!=null?oe:0,window.innerHeight);var Se;const fe=Math.min((Se=I.current.getBoundingClientRect().width)!=null?Se:0,window.innerWidth),Ie=f==="left"||f==="right";if(Math.abs(H)>=(Ie?fe:ae)*N){re(),o?.(A,!1);return}o?.(A,!0),kt()}g.useEffect(()=>($&&(ee(document.documentElement,{scrollBehavior:"auto"}),qe.current=new Date),()=>{fs(document.documentElement,"scrollBehavior")}),[$]);function vr(A){const H=A?(window.innerWidth-Oe)/window.innerWidth:1,B=A?-Oe:0;be.current&&window.clearTimeout(be.current),ee(I.current,{transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,transform:Q(f)?`scale(${H}) translate3d(0, ${B}px, 0)`:`scale(${H}) translate3d(${B}px, 0, 0)`}),!A&&I.current&&(be.current=setTimeout(()=>{const F=it(I.current,f);ee(I.current,{transition:"none",transform:Q(f)?`translate3d(0, ${F}px, 0)`:`translate3d(${F}px, 0, 0)`})},500))}function jr(A,H){if(H<0)return;const B=(window.innerWidth-Oe)/window.innerWidth,F=B+H*(1-B),J=-Oe+H*Oe;ee(I.current,{transform:Q(f)?`scale(${F}) translate3d(0, ${J}px, 0)`:`scale(${F}) translate3d(${J}px, 0, 0)`,transition:"none"})}function wr(A,H){const B=Q(f)?window.innerHeight:window.innerWidth,F=H?(B-Oe)/B:1,J=H?-Oe:0;H&&ee(I.current,{transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,transform:Q(f)?`scale(${F}) translate3d(0, ${J}px, 0)`:`scale(${F}) translate3d(${J}px, 0, 0)`})}return g.useEffect(()=>{b||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[b]),g.createElement(Dr,{defaultOpen:_,onOpenChange:A=>{!h&&!A||(A?ue(!0):re(!0),se(A))},open:$},g.createElement(Vt.Provider,{value:{activeSnapPoint:dt,snapPoints:n,setActiveSnapPoint:st,drawerRef:I,overlayRef:je,onOpenChange:s,onPress:De,onRelease:br,onDrag:he,dismissible:h,shouldAnimate:Ze,handleOnly:m,isOpen:$,isDragging:de,shouldFade:M,closeDrawer:re,onNestedDrag:jr,onNestedOpenChange:vr,onNestedRelease:wr,keyboardIsOpen:ve,modal:b,snapPointsOffset:T,activeSnapPointIndex:we,direction:f,shouldScaleBackground:j,setBackgroundColorOnScale:c,noBodyStyles:L,container:D,autoFocus:z}},r))}const tr=g.forwardRef(function({...t},s){const{overlayRef:r,snapPoints:a,onRelease:o,shouldFade:n,isOpen:j,modal:c,shouldAnimate:N}=Qe(),w=Kt(s,r),h=a&&a.length>0;if(!c)return null;const m=g.useCallback(u=>o(u),[o]);return g.createElement(Or,{onMouseUp:m,ref:w,"data-vaul-overlay":"","data-vaul-snap-points":j&&h?"true":"false","data-vaul-snap-points-overlay":j&&n?"true":"false","data-vaul-animate":N?.current?"true":"false",...t})});tr.displayName="Drawer.Overlay";const rr=g.forwardRef(function({onPointerDownOutside:t,style:s,onOpenAutoFocus:r,...a},o){const{drawerRef:n,onPress:j,onRelease:c,onDrag:N,keyboardIsOpen:w,snapPointsOffset:h,activeSnapPointIndex:m,modal:u,isOpen:P,direction:y,snapPoints:C,container:b,handleOnly:i,shouldAnimate:p,autoFocus:L}=Qe(),[f,_]=g.useState(!1),U=Kt(o,n),E=g.useRef(null),l=g.useRef(null),x=g.useRef(!1),S=C&&C.length>0;ys();const D=(v,K,$=0)=>{if(x.current)return!0;const se=Math.abs(v.y),Z=Math.abs(v.x),ue=Z>se,de=["bottom","right"].includes(K)?1:-1;if(K==="left"||K==="right"){if(!(v.x*de<0)&&Z>=0&&Z<=$)return ue}else if(!(v.y*de<0)&&se>=0&&se<=$)return!ue;return x.current=!0,!0};g.useEffect(()=>{S&&window.requestAnimationFrame(()=>{_(!0)})},[]);function z(v){E.current=null,x.current=!1,c(v)}return g.createElement(Pr,{"data-vaul-drawer-direction":y,"data-vaul-drawer":"","data-vaul-delayed-snap-points":f?"true":"false","data-vaul-snap-points":P&&S?"true":"false","data-vaul-custom-container":b?"true":"false","data-vaul-animate":p?.current?"true":"false",...a,ref:U,style:h&&h.length>0?{"--snap-point-height":`${h[m??0]}px`,...s}:s,onPointerDown:v=>{i||(a.onPointerDown==null||a.onPointerDown.call(a,v),E.current={x:v.pageX,y:v.pageY},j(v))},onOpenAutoFocus:v=>{r?.(v),L||v.preventDefault()},onPointerDownOutside:v=>{if(t?.(v),!u||v.defaultPrevented){v.preventDefault();return}w.current&&(w.current=!1)},onFocusOutside:v=>{if(!u){v.preventDefault();return}},onPointerMove:v=>{if(l.current=v,i||(a.onPointerMove==null||a.onPointerMove.call(a,v),!E.current))return;const K=v.pageY-E.current.y,$=v.pageX-E.current.x,se=v.pointerType==="touch"?10:2;D({x:$,y:K},y,se)?N(v):(Math.abs($)>se||Math.abs(K)>se)&&(E.current=null)},onPointerUp:v=>{a.onPointerUp==null||a.onPointerUp.call(a,v),E.current=null,x.current=!1,c(v)},onPointerOut:v=>{a.onPointerOut==null||a.onPointerOut.call(a,v),z(l.current)},onContextMenu:v=>{a.onContextMenu==null||a.onContextMenu.call(a,v),l.current&&z(l.current)}})});rr.displayName="Drawer.Content";const Cs=250,Ts=120,Ls=g.forwardRef(function({preventCycle:t=!1,children:s,...r},a){const{closeDrawer:o,isDragging:n,snapPoints:j,activeSnapPoint:c,setActiveSnapPoint:N,dismissible:w,handleOnly:h,isOpen:m,onPress:u,onDrag:P}=Qe(),y=g.useRef(null),C=g.useRef(!1);function b(){if(C.current){L();return}window.setTimeout(()=>{i()},Ts)}function i(){if(n||t||C.current){L();return}if(L(),!j||j.length===0){w||o();return}if(c===j[j.length-1]&&w){o();return}const _=j.findIndex(E=>E===c);if(_===-1)return;const U=j[_+1];N(U)}function p(){y.current=window.setTimeout(()=>{C.current=!0},Cs)}function L(){y.current&&window.clearTimeout(y.current),C.current=!1}return g.createElement("div",{onClick:b,onPointerCancel:L,onPointerDown:f=>{h&&u(f),p()},onPointerMove:f=>{h&&P(f)},ref:a,"data-vaul-drawer-visible":m?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},g.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},s))});Ls.displayName="Drawer.Handle";function Es(t){const s=Qe(),{container:r=s.container,...a}=t;return g.createElement(Ir,{container:r,...a})}const ge={Root:Ns,Content:rr,Overlay:tr,Portal:Es,Close:kr,Title:_r,Description:Rr},sr=({shouldScaleBackground:t=!0,...s})=>e.jsx(ge.Root,{shouldScaleBackground:t,...s});sr.displayName="Drawer";const As=ge.Portal,ks=ge.Close,nr=d.forwardRef(({className:t,...s},r)=>e.jsx(ge.Overlay,{ref:r,className:Ce("fixed inset-0 z-50 bg-black/80",t),...s}));nr.displayName=ge.Overlay.displayName;const ar=d.forwardRef(({className:t,children:s,...r},a)=>e.jsxs(As,{children:[e.jsx(nr,{}),e.jsxs(ge.Content,{ref:a,className:Ce("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",t),...r,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),s]})]}));ar.displayName="DrawerContent";const or=({className:t,...s})=>e.jsx("div",{className:Ce("grid gap-1.5 p-4 text-center sm:text-left",t),...s});or.displayName="DrawerHeader";const ir=({className:t,...s})=>e.jsx("div",{className:Ce("mt-auto flex flex-col gap-2 p-4",t),...s});ir.displayName="DrawerFooter";const lr=d.forwardRef(({className:t,...s},r)=>e.jsx(ge.Title,{ref:r,className:Ce("text-lg font-semibold leading-none tracking-tight",t),...s}));lr.displayName=ge.Title.displayName;const cr=d.forwardRef(({className:t,...s},r)=>e.jsx(ge.Description,{ref:r,className:Ce("text-sm text-muted-foreground",t),...s}));cr.displayName=ge.Description.displayName;const Ge=[{code:"CSCC 21.1",name:"Software Engineering 1",units:3,instructional:"integrated lec/lab"},{code:"CSCC 36",name:"Advanced Topics in Human Computer Interaction",units:3,instructional:"lecture only"},{code:"CSCC 37",name:"User Interface Design and Development",units:3,instructional:"integrated lec/lab"},{code:"CSCC 40",name:"Introduction to Artificial Intelligence",units:3,instructional:"lecture only"},{code:"CSCC 44",name:"Introduction to Data Mining",units:3,instructional:"integrated lec/lab"},{code:"CSCC 46",name:"Introduction to Robotics",units:3,instructional:"integrated lec/lab"},{code:"ISCC 11",name:"Organization and Management Concepts",units:3,instructional:"lecture only"},{code:"ISCC 12",name:"Financial Management",units:3,instructional:"lecture only"},{code:"ISCC 16",name:"Technopreneurship",units:3,instructional:"lecture only"},{code:"ISCC 17",name:"Electronic Commerce",units:3,instructional:"lecture only"},{code:"ISCC 18",name:"Introduction to Enterprise Resource Planning",units:3,instructional:"lecture only"},{code:"ISCC 21.1",name:"IS Project Management",units:3,instructional:"lecture only"},{code:"ISCC 22.1",name:"Systems Analysis and Design",units:3,instructional:"lecture only"},{code:"ISCC 31",name:"Current Issues and Trends in Computing",units:3,instructional:"lecture only"},{code:"ITCC 12",name:"Platform Technologies",units:3,instructional:"integrated lec/lab"},{code:"ITCC 17",name:"Advanced Systems Integration and Architecture",units:3,instructional:"integrated lec/lab"},{code:"ITCC 18",name:"Advanced Integrative Programming and Technologies",units:3,instructional:"lec and lab"},{code:"ITCC 19",name:"Introduction to Geographic Information Systems",units:3,instructional:"integrated lec/lab"},{code:"ITCC 34",name:"Contemporary Database Technologies",units:3,instructional:"integrated lec/lab"},{code:"ITCC 35",name:"Advanced Web Systems and Technologies",units:3,instructional:"integrated lec/lab"},{code:"ITCC 36",name:"Introduction to Cloud Computing",units:3,instructional:"integrated lec/lab"},{code:"ITCC 37",name:"Data Warehousing",units:3,instructional:"integrated lec/lab"},{code:"ITCC 38",name:"Parallel and Distributed Computing",units:3,instructional:"integrated lec/lab"},{code:"ITCC 39",name:"IT Industry Management",units:3,instructional:"lecture only"},{code:"ITCC 40",name:"Web Design and Development",units:3,instructional:"integrated lec/lab"},{code:"ITCC 41",name:"Mobile Applications Development",units:3,instructional:"integrated lec/lab"}],_s=(t,s)=>{const[r,a]=t.split(", "),[o,n]=s.split(", "),j=parseInt(r),c=parseInt(o);return j!==c?j-c:a?.includes("Summer")?1:n?.includes("Summer")||a?.includes("1st")?-1:n?.includes("1st")?1:0};function Rs({isOpen:t,onClose:s,program:r,onAddSemester:a,onEditSemester:o,onAddSubject:n,onEditSubject:j,onDeleteSubject:c,onSetSemesterStatus:N,refreshKey:w,updatedSubjectData:h,newSemesterData:m,updatedSemesterData:u,readOnly:P=!1}){const[y,C]=d.useState({}),[b,i]=d.useState(!1),[p,L]=d.useState(!1),[f,_]=d.useState(null),U=l=>{_(l),L(!0)};d.useEffect(()=>{if(!t)return;(async()=>{i(!0);const x=localStorage.getItem("accessToken");if(!x){k.error("Authentication required."),i(!1);return}try{const S=await ce.get("/semester-with-subjects",{params:{program_id:r.id},headers:{Authorization:`Bearer ${x}`}}),D=Array.isArray(S.data.semesters)?S.data.semesters:[],z={};D.forEach(v=>{const K=`${v.year_level}, ${v.semester_level}`;z[K]={id:v.id,subjects:(v.subjects||[]).map($=>({id:$.id,code:$.subject_code,name:$.des_title,unitsTotal:$.total_units,unitsLec:$.lec_units,unitsLab:$.lab_units,hoursTotal:$.total_hrs,hoursLec:$.total_lec_hrs,hoursLab:$.total_lab_hrs,prerequisite:$.pre_requisite||"None"})),isActive:v.status===0,startDate:v.start_date,endDate:v.end_date}}),C(z)}catch{k.error("Failed to load semester data.")}finally{i(!1)}})()},[t,r.id,w]),d.useEffect(()=>{if(h){const{semesterName:l,subject:x}=h;C(S=>{const D=JSON.parse(JSON.stringify(S)),z=D[l];if(z){const v=z.subjects.findIndex(K=>K.id===x.id);v!==-1?z.subjects[v]=x:z.subjects.push(x)}return D})}},[h]),d.useEffect(()=>{if(m){const{name:l,semester:x}=m;C(S=>({...S,[l]:x}))}},[m]),d.useEffect(()=>{if(u){const{name:l,semester:x,newName:S}=u;C(D=>{const z={...D},v=z[l];return v?(S&&S!==l?(z[S]={...v,...x},delete z[l]):z[l]={...v,...x},z):D})}},[u]);const E=d.useMemo(()=>Object.entries(y).sort(([l],[x])=>_s(l,x)),[y]);return e.jsxs($e,{open:t,onOpenChange:s,children:[e.jsxs(Me,{className:"max-w-7xl h-[95vh] flex flex-col p-0",children:[e.jsxs(Fe,{className:"p-6 pb-4 bg-muted/50 border-b rounded-t-lg",children:[e.jsxs(ze,{className:"text-2xl md:text-3xl font-bold text-foreground flex items-center gap-3",children:[r.name,e.jsx("span",{className:"text-sm font-semibold text-primary bg-primary/10 px-3 py-1 rounded-full",children:r.abbreviation})]}),e.jsxs(lt,{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"h-4 w-4"}),"Academic Year of Effectivity: ",r.effectiveYear]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto px-6 py-4 space-y-8",children:b?e.jsx("div",{className:"space-y-6",children:[1,2].map(l=>e.jsxs("div",{className:"bg-card border rounded-xl p-4 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-muted/60 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-48 bg-muted/30 rounded"})]},l))}):E.length===0?e.jsxs("div",{className:"text-center py-20 text-muted-foreground flex flex-col items-center justify-center h-full",children:[e.jsx(Pt,{size:56,className:"mx-auto mb-4"}),e.jsx("h4",{className:"font-semibold text-xl text-foreground",children:"No Semesters Found"}),e.jsx("p",{className:"max-w-md mx-auto mt-2 text-sm",children:"This curriculum is empty."})]}):E.map(([l,x])=>e.jsxs("div",{className:`group/semester border rounded-xl overflow-hidden shadow-sm transition-opacity ${x.isActive?"bg-card":"opacity-70 bg-muted/20"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-muted/30 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground",children:l}),e.jsx(mt,{variant:x.isActive?"default":"destructive",children:x.isActive?"Active":"Inactive"})]}),!P&&e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/semester:opacity-100 transition-opacity",children:[e.jsx(q,{variant:"ghost",size:"icon",title:"Set Status & Dates",className:"h-8 w-8 text-muted-foreground",onClick:()=>N(l,x,r.effectiveYear),children:e.jsx(Gr,{size:16})}),e.jsx(q,{variant:"ghost",size:"icon",title:"Rename Semester",className:"h-8 w-8 text-green-500 hover:text-green-500",onClick:()=>o(x.id,l),children:e.jsx(vt,{size:16})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(jt,{className:"min-w-[1200px]",children:[e.jsxs(wt,{className:"bg-muted/50 sticky top-0 z-10",children:[e.jsxs(ie,{children:[e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Course Code"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r w-[350px]",children:"Descriptive Title"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Units"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Hours per week"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Pre-requisite"}),e.jsx(Y,{rowSpan:2,className:"align-middle w-[100px] text-center",children:"Actions"})]}),e.jsxs(ie,{children:[e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"}),e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"})]})]}),e.jsx(yt,{children:x.subjects.length>0?x.subjects.map(S=>{const D=S.name.toUpperCase().startsWith("PROFESSIONAL ELECTIVE")&&S.code.toUpperCase().startsWith("ELECTIVE");return e.jsxs(ie,{children:[e.jsx(R,{className:"w-[150px] font-semibold uppercase text-center",children:S.code}),e.jsx(R,{children:D?e.jsx(q,{variant:"link",className:"text-left p-0 h-auto font-normal text-base text-blue-600 hover:underline",onClick:()=>U(S),children:S.name}):S.name}),e.jsx(R,{className:"text-center font-bold text-primary",children:S.unitsTotal}),e.jsx(R,{className:"text-center",children:S.unitsLec}),e.jsx(R,{className:"text-center",children:S.unitsLab}),e.jsx(R,{className:"text-center font-bold text-primary",children:S.hoursTotal}),e.jsx(R,{className:"text-center",children:S.hoursLec}),e.jsx(R,{className:"text-center",children:S.hoursLab}),e.jsx(R,{className:"w-[150px] text-center",children:S.prerequisite}),e.jsx(R,{className:"text-center",children:e.jsx("div",{className:"flex justify-end items-center gap-1",children:!P&&e.jsxs(e.Fragment,{children:[e.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-500 hover:text-green-500",onClick:()=>j(l,S),children:e.jsx(vt,{size:16})}),e.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>c(l,S.id),children:e.jsx(Tt,{size:16})})]})})})]},S.id||S.code)}):e.jsx(ie,{children:e.jsx(R,{colSpan:10,className:"text-center h-24 text-muted-foreground",children:"No subjects added for this semester."})})}),e.jsx(St,{className:"sticky bottom-0 bg-muted/80 backdrop-blur-sm",children:e.jsxs(ie,{children:[e.jsx(R,{colSpan:2,className:"text-right font-bold text-lg",children:"SEMESTER TOTALS"}),e.jsx(R,{className:"text-center font-bold text-lg text-primary",children:x.subjects.reduce((S,D)=>S+(Number(D.unitsTotal)||0),0)}),e.jsx(R,{className:"text-center font-semibold",children:x.subjects.reduce((S,D)=>S+(Number(D.unitsLec)||0),0)}),e.jsx(R,{className:"text-center font-semibold",children:x.subjects.reduce((S,D)=>S+(Number(D.unitsLab)||0),0)}),e.jsx(R,{className:"text-center font-bold text-lg text-primary",children:x.subjects.reduce((S,D)=>S+(Number(D.hoursTotal)||0),0)}),e.jsx(R,{className:"text-center font-semibold",children:x.subjects.reduce((S,D)=>S+(Number(D.hoursLec)||0),0)}),e.jsx(R,{className:"text-center font-semibold",children:x.subjects.reduce((S,D)=>S+(Number(D.hoursLab)||0),0)}),e.jsx(R,{colSpan:2})]})})]})}),!P&&e.jsx("div",{className:"p-2 border-t",children:e.jsxs(q,{onClick:()=>n(l,x.id),variant:"link",children:[e.jsx(Lt,{size:16,className:"mr-1"})," Add Subject"]})})]},l))}),e.jsxs(He,{className:"mt-auto p-6 bg-gray-50 border-t rounded-b-lg flex flex-col md:flex-row md:justify-end gap-2",children:[e.jsx(Ye,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",children:"Cancel"})}),e.jsxs(q,{onClick:a,className:"flex items-center gap-2",children:[e.jsx(Pt,{size:16})," Add Year/Semester"]})]})]}),e.jsx(sr,{open:p,onOpenChange:L,children:e.jsxs(ar,{className:"p-0",children:[e.jsxs(or,{className:"text-left px-5 py-4 border-b bg-background/95 backdrop-blur-sm sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(lr,{className:"text-xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(Wr,{className:"h-5 w-5 text-primary"}),f?.name||"Elective Subjects"]}),e.jsx(cr,{className:"text-sm mt-1 text-muted-foreground",children:"List of subjects that can be taken for this elective slot. (Read-only view)"})]}),e.jsxs(mt,{variant:"outline",className:"text-xs font-semibold py-1 px-3 mt-1 text-primary border-primary",children:[Ge.length," Options"]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-primary",children:"Placeholder Code:"})," ",f?.code,e.jsx("span",{className:"ml-4 font-medium text-primary",children:"Units Required:"})," ",f?.unitsTotal]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-y-auto px-5 py-4",children:e.jsxs(jt,{className:"min-w-[720px]",children:[e.jsx(wt,{className:"sticky top-0 bg-background z-10",children:e.jsxs(ie,{className:"[&>th]:py-3 [&>th]:text-xs [&>th]:text-white [&>th]:font-bold [&>th]:uppercase",children:[e.jsx(Y,{className:"w-[120px]",children:"Code"}),e.jsx(Y,{className:"w-[400px]",children:"Descriptive Title"}),e.jsx(Y,{className:"text-right w-[80px]",children:"Units"}),e.jsx(Y,{className:"w-[180px]",children:"Instructional Type"})]})}),e.jsx(yt,{children:Ge.length===0?e.jsx(ie,{children:e.jsx(R,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:"No elective subjects available."})}):Ge.map(l=>e.jsxs(ie,{className:"transition-colors [&>td]:py-3 text-sm",children:[e.jsx(R,{className:"font-semibold text-foreground",children:l.code}),e.jsx(R,{title:l.name,className:"font-medium text-wrap",children:l.name}),e.jsx(R,{className:"text-right tabular-nums font-bold text-primary",children:l.units}),e.jsx(R,{children:e.jsx(mt,{variant:"secondary",className:"capitalize text-xs font-medium",children:l.instructional.replace("integrated lec/lab","Lec/Lab").replace("lecture only","Lecture")})})]},l.code))}),Ge.length>0&&e.jsx(St,{className:"bg-muted/60 sticky bottom-0 z-10 backdrop-blur-sm",children:e.jsxs(ie,{className:"[&>td]:py-3",children:[e.jsx(R,{colSpan:2,className:"text-right font-bold text-base",children:"Total Units Available"}),e.jsx(R,{className:"text-right font-extrabold text-xl text-primary",children:Ge.reduce((l,x)=>l+(Number(x.units)||0),0)}),e.jsx(R,{})]})})]})}),e.jsx(ir,{className:"px-5 py-3 border-t bg-background/95 backdrop-blur-sm sticky bottom-0 z-20 flex justify-center",children:e.jsx(ks,{asChild:!0,children:e.jsx(q,{variant:"outline",size:"sm",className:"w-full max-w-xs",children:"Close View"})})})]})})]})}const Ds=()=>{const r=new Date().getFullYear()+5,a=[];for(let o=2015;o<=r;o++)a.push(String(o));return a},Yt=Ds();function Is({isOpen:t,onClose:s,onSave:r,initialData:a}){const[o,n]=d.useState(""),[j,c]=d.useState(""),[N,w]=d.useState(""),[h,m]=d.useState(""),[u,P]=d.useState(!1);d.useEffect(()=>{if(a){n(a.name),c(a.abbreviation);const[b="",i=""]=a.effectiveYear.split("-");w(b),m(i)}else{n(""),c("");const b=new Date().getFullYear();w(String(b)),m(String(b+1))}},[a,t]);const y=async b=>{b.preventDefault(),P(!0);const i={program_name:o,abbreviation:j,year_from:N,year_to:h},p=localStorage.getItem("accessToken");if(!p){k.error("Authentication required."),P(!1);return}const L={Authorization:`Bearer ${p}`};try{const f=!!a,_=f?`/edit-program/${a.id}`:"/add-program",E=await ce["post"](_,i,{headers:L});k.success(E.data.message||"Program saved successfully!");const l=E.data.program,x=l.subjects||a?.subjects||{},S=typeof l.total_subjects=="number"?l.total_subjects:Object.keys(x).length,D=typeof l.total_units=="number"?l.total_units:a?.total_units??0,z={id:l.id,name:l.program_name,abbreviation:l.abbreviation,effectiveYear:`${l.year_from}-${l.year_to}`,semesters:l.semesters||a?.semesters||{},subjects:x,total_subjects:S,total_units:D,isActive:l.isActive??l.is_active??a?.isActive??!0};r(z),s()}catch(f){if(ce.isAxiosError(f)&&f.response){if(f.response.status===401){k.error("Your session has expired. Please log in again.");return}const _=f.response.data,U=_.errors;if(U&&typeof U=="object"&&Object.keys(U).length>0){const E=Object.keys(U)[0],l=U[E]?.[0];k.error(l||"A validation error occurred.")}else _&&typeof _.message=="string"?k.error(_.message):k.error("An unknown API error occurred.")}else k.error("Failed to connect to the server. Please check your connection."),console.error("Non-Axios error:",f)}finally{P(!1)}},C=b=>{w(b),m(String(Number(b)+1))};return e.jsx($e,{open:t,onOpenChange:s,children:e.jsxs(Me,{children:[e.jsx(Fe,{children:e.jsx(ze,{children:a?"Edit Program":"Add New Program"})}),e.jsxs("form",{onSubmit:y,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"progName",children:"Program Name"}),e.jsx(W,{id:"progName",value:o,onChange:b=>n(b.target.value),placeholder:"e.g., Bachelor of Science...",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"progAbbr",children:"Abbreviation"}),e.jsx(W,{id:"progAbbr",value:j,onChange:b=>c(b.target.value),placeholder:"e.g., BSIT",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{children:"Effectivity A.Y."}),e.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr] items-center gap-2",children:[e.jsxs(Te,{value:N,onValueChange:C,required:!0,children:[e.jsx(Le,{children:e.jsx(Ee,{placeholder:"Start Year"})}),e.jsx(Ae,{children:Yt.map(b=>e.jsx(xe,{value:b,children:b},b))})]}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsxs(Te,{value:h,onValueChange:m,required:!0,children:[e.jsx(Le,{children:e.jsx(Ee,{placeholder:"End Year"})}),e.jsx(Ae,{children:Yt.map(b=>e.jsx(xe,{value:b,children:b},b))})]})]})]}),e.jsxs(He,{className:"pt-4",children:[e.jsx(Ye,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:u,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:u,children:u?"Saving...":a?"Save Changes":"Save Program"})]})]})]})})}const gt={id:0,code:"",name:"",unitsTotal:0,unitsLec:"",unitsLab:"",hoursTotal:0,hoursLec:"",hoursLab:"",prerequisite:""},Ps=["1st Year","2nd Year","3rd Year","4th Year"],Os=["1st Semester","2nd Semester","Summer"];function $s({isOpen:t,onClose:s,onSave:r,programId:a}){const[o,n]=d.useState(""),[j,c]=d.useState(""),[N,w]=d.useState([gt]),[h,m]=d.useState(!1);d.useEffect(()=>{const i=N.map(p=>({...p,unitsTotal:(Number(p.unitsLec)||0)+(Number(p.unitsLab)||0),hoursTotal:(Number(p.hoursLec)||0)+(Number(p.hoursLab)||0)}));JSON.stringify(i)!==JSON.stringify(N)&&w(i)},[N]);const u=d.useMemo(()=>N.reduce((i,p)=>(i.totalUnits+=Number(p.unitsTotal)||0,i.totalLecUnits+=Number(p.unitsLec)||0,i.totalLabUnits+=Number(p.unitsLab)||0,i.totalHours+=Number(p.hoursTotal)||0,i.totalLecHours+=Number(p.hoursLec)||0,i.totalLabHours+=Number(p.hoursLab)||0,i),{totalUnits:0,totalLecUnits:0,totalLabUnits:0,totalHours:0,totalLecHours:0,totalLabHours:0}),[N]),P=()=>w(i=>[...i,{...gt}]),y=i=>w(p=>p.length>1?p.filter((L,f)=>f!==i):p),C=(i,p,L)=>w(f=>f.map((_,U)=>U===i?{..._,[p]:L}:_)),b=async i=>{if(i.preventDefault(),!o||!j){k.error("Please select a year level and semester.");return}if(N.some(p=>!p.code.trim()||!p.name.trim())){k.error("Please fill out all subject codes and titles.");return}m(!0);try{const p=localStorage.getItem("accessToken");if(!p){k.error("Authentication required."),m(!1);return}const L={program_id:a,year_level:o,semester_level:j,subjects:N.map(_=>({subject_code:_.code,des_title:_.name,total_units:_.unitsTotal,lec_units:Number(_.unitsLec)||0,lab_units:Number(_.unitsLab)||0,total_hrs:_.hoursTotal,total_lec_hrs:Number(_.hoursLec)||0,total_lab_hrs:Number(_.hoursLab)||0,pre_requisite:_.prerequisite||null}))},f=await ce.post("/semester-with-subjects",L,{headers:{Authorization:`Bearer ${p}`}});if(f.status===201&&f.data.semester){k.success("Semester and subjects added successfully!");const _=f.data.semester,U=`${_.year_level}, ${_.semester_level}`,E={id:_.id,isActive:_.status===1,startDate:_.start_date,endDate:_.end_date,subjects:(_.subjects||[]).map(l=>({id:l.id,code:l.subject_code,name:l.des_title,unitsTotal:l.total_units,unitsLec:l.lec_units,unitsLab:l.lab_units,hoursTotal:l.total_hrs,hoursLec:l.total_lec_hrs,hoursLab:l.total_lab_hrs,prerequisite:l.pre_requisite||"None"}))};r&&r({name:U,semester:E}),s()}}catch(p){k.error(p.response?.data?.error||"Failed to save. Please try again.")}finally{m(!1)}};return d.useEffect(()=>{t&&(n(""),c(""),w([gt]))},[t]),e.jsx($e,{open:t,onOpenChange:s,children:e.jsx(Sr,{children:e.jsxs(Me,{className:"max-w-7xl h-[95vh] flex flex-col",children:[e.jsxs(Fe,{children:[e.jsx(ze,{children:"Add New Semester and Subjects"}),e.jsx(lt,{children:"Add subjects in bulk for a new semester. Totals are calculated automatically."})]}),e.jsxs("form",{onSubmit:b,className:"flex-grow flex flex-col min-h-0 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"yearLevel",className:"text-base",children:"Year Level"}),e.jsxs(Te,{value:o,onValueChange:n,required:!0,children:[e.jsx(Le,{id:"yearLevel",children:e.jsx(Ee,{placeholder:"Select a year level"})}),e.jsx(Ae,{children:Ps.map(i=>e.jsx(xe,{value:i,children:i},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"semester",className:"text-base",children:"Semester"}),e.jsxs(Te,{value:j,onValueChange:c,required:!0,children:[e.jsx(Le,{id:"semester",children:e.jsx(Ee,{placeholder:"Select a semester"})}),e.jsx(Ae,{children:Os.map(i=>e.jsx(xe,{value:i,children:i},i))})]})]})]}),e.jsx("div",{className:"flex-grow overflow-auto border rounded-lg",children:e.jsxs(jt,{className:"min-w-[1200px]",children:[e.jsxs(wt,{className:"bg-muted/50 sticky top-0 z-10",children:[e.jsxs(ie,{children:[e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Course Code"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r w-[350px]",children:"Descriptive Title"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Units"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Hours per week"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Pre-requisite"}),e.jsx(Y,{rowSpan:2,className:"align-middle w-[50px]"})]}),e.jsxs(ie,{children:[e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"}),e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"})]})]}),e.jsx(yt,{children:N.map((i,p)=>e.jsxs(ie,{children:[e.jsx(R,{className:"w-[150px]",children:e.jsx(W,{required:!0,className:"uppercase",placeholder:"e.g. CS101",value:i.code,onChange:L=>C(p,"code",L.target.value)})}),e.jsx(R,{children:e.jsx(W,{required:!0,placeholder:"e.g. Intro to Programming",value:i.name,onChange:L=>C(p,"name",L.target.value)})}),e.jsx(R,{children:e.jsxs(Rt,{children:[e.jsx(Dt,{asChild:!0,children:e.jsx(W,{value:i.unitsTotal||"",readOnly:!0,className:"text-center font-bold bg-muted/50 cursor-not-allowed"})}),e.jsx(It,{children:"Auto-calculated"})]})}),e.jsx(R,{children:e.jsx(W,{min:"0",type:"number",value:i.unitsLec,onChange:L=>C(p,"unitsLec",L.target.value),className:"text-center"})}),e.jsx(R,{children:e.jsx(W,{min:"0",type:"number",value:i.unitsLab,onChange:L=>C(p,"unitsLab",L.target.value),className:"text-center"})}),e.jsx(R,{children:e.jsxs(Rt,{children:[e.jsx(Dt,{asChild:!0,children:e.jsx(W,{value:i.hoursTotal||"",readOnly:!0,className:"text-center font-bold bg-muted/50 cursor-not-allowed"})}),e.jsx(It,{children:"Auto-calculated"})]})}),e.jsx(R,{children:e.jsx(W,{min:"0",type:"number",value:i.hoursLec,onChange:L=>C(p,"hoursLec",L.target.value),className:"text-center"})}),e.jsx(R,{children:e.jsx(W,{min:"0",type:"number",value:i.hoursLab,onChange:L=>C(p,"hoursLab",L.target.value),className:"text-center"})}),e.jsx(R,{className:"w-[150px]",children:e.jsx(W,{placeholder:"None",value:i.prerequisite,onChange:L=>C(p,"prerequisite",L.target.value)})}),e.jsx(R,{className:"text-center",children:e.jsx(q,{type:"button",variant:"ghost",size:"icon",onClick:()=>y(p),disabled:N.length<=1,className:"text-destructive h-8 w-8 shrink-0 disabled:opacity-50",children:e.jsx(Tt,{size:16})})})]},p))}),e.jsx(St,{className:"sticky bottom-0 bg-muted/80 backdrop-blur-sm",children:e.jsxs(ie,{children:[e.jsx(R,{colSpan:2,className:"text-right font-bold text-lg",children:"SEMESTER TOTALS"}),e.jsx(R,{className:"text-center font-bold text-lg text-primary",children:u.totalUnits}),e.jsx(R,{className:"text-center font-semibold",children:u.totalLecUnits}),e.jsx(R,{className:"text-center font-semibold",children:u.totalLabUnits}),e.jsx(R,{className:"text-center font-bold text-lg text-primary",children:u.totalHours}),e.jsx(R,{className:"text-center font-semibold",children:u.totalLecHours}),e.jsx(R,{className:"text-center font-semibold",children:u.totalLabHours}),e.jsx(R,{colSpan:2})]})})]})}),e.jsxs(q,{type:"button",variant:"outline",onClick:P,className:"mt-4 w-full sm:w-auto",children:[e.jsx(Lt,{size:16,className:"mr-2"})," Add Subject Row"]}),e.jsxs(He,{className:"mt-5 pt-4 border-t",children:[e.jsx(Ye,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:h,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"mr-2 h-4 w-4 animate-spin"})," Saving..."]}):"Save Curriculum"})]})]})]})})})}const Ms=["1st Year","2nd Year","3rd Year","4th Year"],Fs=["1st Semester","2nd Semester","Summer"];function zs({isOpen:t,onClose:s,onSaveSuccess:r,semesterId:a,initialData:o}){const[n,j]=d.useState(!1),[c,N]=d.useState(""),[w,h]=d.useState("");d.useEffect(()=>{if(t&&o){const u=o.split(", ");u.length===2&&(N(u[0]),h(u[1]))}},[t,o]);const m=async u=>{u.preventDefault();const P=`${c}, ${w}`;if(!c||!w){k.error("Please select both a year level and a semester.");return}if(P===o){k.info("No changes were made."),s();return}if(!a){k.error("Semester ID is missing.");return}j(!0);try{const y=localStorage.getItem("accessToken");if(!y){k.error("Authentication required."),j(!1);return}const C={year_level:c,semester_level:w};await ce.put(`/semesters/${a}/rename`,C,{headers:{Authorization:`Bearer ${y}`}}),k.success("Semester renamed successfully!"),r(o,P),s()}catch(y){k.error(y.response?.data?.message||"Failed to rename semester.")}finally{j(!1)}};return e.jsx($e,{open:t,onOpenChange:s,children:e.jsxs(Me,{children:[e.jsx(Fe,{children:e.jsx(ze,{children:"Rename Semester"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"yearPart",children:"Year Level"}),e.jsxs(Te,{value:c,onValueChange:N,children:[e.jsx(Le,{id:"yearPart",children:e.jsx(Ee,{placeholder:"Select a year level"})}),e.jsx(Ae,{children:Ms.map(u=>e.jsx(xe,{value:u,children:u},u))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"semesterPart",children:"Semester"}),e.jsxs(Te,{value:w,onValueChange:h,children:[e.jsx(Le,{id:"semesterPart",children:e.jsx(Ee,{placeholder:"Select a semester"})}),e.jsx(Ae,{children:Fs.map(u=>e.jsx(xe,{value:u,children:u},u))})]})]}),e.jsxs(He,{className:"pt-4",children:[e.jsx(Ye,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:n,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:n||!c||!w,children:n?e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"mr-2 h-4 w-4 animate-spin"})," Renaming..."]}):"Rename"})]})]})]})})}function Hs(t){const{isOpen:s,onClose:r,onSave:a,initialData:o}=t,[n,j]=d.useState({id:0,code:"",name:"",unitsTotal:0,unitsLec:0,unitsLab:0,hoursTotal:0,hoursLec:0,hoursLab:0,prerequisite:""}),[c,N]=d.useState(null);d.useEffect(()=>{const y=(Number(n.unitsLec)||0)+(Number(n.unitsLab)||0),C=(Number(n.hoursLec)||0)+(Number(n.hoursLab)||0);j(b=>({...b,unitsTotal:y,hoursTotal:C}))},[n.unitsLec,n.unitsLab,n.hoursLec,n.hoursLab]),d.useEffect(()=>{const y=Number(n.unitsLec)||0,C=Number(n.unitsLab)||0,b=Number(n.unitsTotal)||0,i=y+C>b?"Lec + Lab units cannot exceed Total.":null,p=Number(n.hoursLec)||0,L=Number(n.hoursLab)||0,f=Number(n.hoursTotal)||0,_=p+L>f?"Lec + Lab hours cannot exceed Total.":null;N(i||_?{unitError:i,hourError:_}:null)},[n]),d.useEffect(()=>{s&&j(o||{id:0,code:"",name:"",unitsTotal:0,unitsLec:0,unitsLab:0,hoursTotal:0,hoursLec:0,hoursLab:0,prerequisite:""})},[s,o]);const w=(y,C)=>{j(b=>({...b,[y]:C}))},h=(y,C)=>{const b=Number(C);w(y,b>=0?b:0)},[m,u]=d.useState(!1),P=async y=>{if(y.preventDefault(),c){k.error("Please fix the validation errors before saving.");return}const C=!!o;u(!0);try{await a(n,C),r()}catch(b){console.error("Subject save failed:",b),k.error("The subject code has already been taken")}finally{u(!1)}};return e.jsx($e,{open:s,onOpenChange:r,children:e.jsxs(Me,{children:[e.jsx(Fe,{children:e.jsx(ze,{children:o?`Edit Subject: ${o.code}`:"Add New Subject"})}),e.jsxs("form",{onSubmit:P,className:"py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"code",children:"Course Code"}),e.jsx(W,{id:"code",value:n.code,onChange:y=>w("code",y.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"prerequisite",children:"Pre-requisite"}),e.jsx(W,{id:"prerequisite",value:n.prerequisite,onChange:y=>w("prerequisite",y.target.value),placeholder:"None"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"name",children:"Descriptive Title"}),e.jsx(W,{id:"name",value:n.name,onChange:y=>w("name",y.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx(X,{className:"font-semibold",children:"Unit Allocation"}),e.jsxs("div",{className:`grid grid-cols-3 gap-4 p-4 border rounded-lg bg-muted/30 ${c?.unitError?"border-destructive":""}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"unitsTotal",children:"Total"}),e.jsx(W,{id:"unitsTotal",type:"number",value:n.unitsTotal||"",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"unitsLec",children:"Lec"}),e.jsx(W,{id:"unitsLec",type:"number",value:n.unitsLec||"",onChange:y=>h("unitsLec",y.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"unitsLab",children:"Lab"}),e.jsx(W,{id:"unitsLab",type:"number",value:n.unitsLab||"",onChange:y=>h("unitsLab",y.target.value)})]})]}),c?.unitError&&e.jsxs("p",{className:"text-destructive text-sm flex items-center gap-2 mt-2",children:[e.jsx(Ot,{size:16}),c.unitError]})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx(X,{className:"font-semibold",children:"Hour Allocation"}),e.jsxs("div",{className:`grid grid-cols-3 gap-4 p-4 border rounded-lg bg-muted/30 ${c?.hourError?"border-destructive":""}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"hoursTotal",children:"Total"}),e.jsx(W,{id:"hoursTotal",type:"number",value:n.hoursTotal||"",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"hoursLec",children:"Lec"}),e.jsx(W,{id:"hoursLec",type:"number",value:n.hoursLec||"",onChange:y=>h("hoursLec",y.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"hoursLab",children:"Lab"}),e.jsx(W,{id:"hoursLab",type:"number",value:n.hoursLab||"",onChange:y=>h("hoursLab",y.target.value)})]})]}),c?.hourError&&e.jsxs("p",{className:"text-destructive text-sm flex items-center gap-2 mt-2",children:[e.jsx(Ot,{size:16}),c.hourError]})]})]}),e.jsxs(He,{className:"mt-8 pt-4 border-t",children:[e.jsx(Ye,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:m,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:!!c||m,children:m?"Saving...":o?"Save Changes":"Save Subject"})]})]})]})})}function Ys(t,s,{checkForDefaultPrevented:r=!0}={}){return function(o){if(t?.(o),r===!1||!o.defaultPrevented)return s?.(o)}}var ct="Switch",[qs,xn]=Cr(ct),[Bs,Us]=qs(ct),ur=d.forwardRef((t,s)=>{const{__scopeSwitch:r,name:a,checked:o,defaultChecked:n,required:j,disabled:c,value:N="on",onCheckedChange:w,form:h,...m}=t,[u,P]=d.useState(null),y=Bt(s,L=>P(L)),C=d.useRef(!1),b=u?h||!!u.closest("form"):!0,[i,p]=Nr({prop:o,defaultProp:n??!1,onChange:w,caller:ct});return e.jsxs(Bs,{scope:r,checked:i,disabled:c,children:[e.jsx(Ut.button,{type:"button",role:"switch","aria-checked":i,"aria-required":j,"data-state":fr(i),"data-disabled":c?"":void 0,disabled:c,value:N,...m,ref:y,onClick:Ys(t.onClick,L=>{p(f=>!f),b&&(C.current=L.isPropagationStopped(),C.current||L.stopPropagation())})}),b&&e.jsx(hr,{control:u,bubbles:!C.current,name:a,value:N,checked:i,required:j,disabled:c,form:h,style:{transform:"translateX(-100%)"}})]})});ur.displayName=ct;var dr="SwitchThumb",mr=d.forwardRef((t,s)=>{const{__scopeSwitch:r,...a}=t,o=Us(dr,r);return e.jsx(Ut.span,{"data-state":fr(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:s})});mr.displayName=dr;var Vs="SwitchBubbleInput",hr=d.forwardRef(({__scopeSwitch:t,control:s,checked:r,bubbles:a=!0,...o},n)=>{const j=d.useRef(null),c=Bt(j,n),N=Ar(r),w=Tr(s);return d.useEffect(()=>{const h=j.current;if(!h)return;const m=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(m,"checked").set;if(N!==r&&P){const y=new Event("click",{bubbles:a});P.call(h,r),h.dispatchEvent(y)}},[N,r,a]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:c,style:{...o.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});hr.displayName=Vs;function fr(t){return t?"checked":"unchecked"}var pr=ur,Ws=mr;const xr=d.forwardRef(({className:t,...s},r)=>e.jsx(pr,{className:Ce("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...s,ref:r,children:e.jsx(Ws,{className:Ce("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));xr.displayName=pr.displayName;function Xs({isOpen:t,onClose:s,onSaveSuccess:r,semesterId:a,semesterName:o,initialData:n,effectiveYear:j}){const[c,N]=d.useState(!1),[w,h]=d.useState(""),[m,u]=d.useState(""),[P,y]=d.useState(!1);d.useEffect(()=>{if(t&&n){N(n.isActive);const b=i=>{if(!i)return"";try{return new Date(i).toISOString().split("T")[0]}catch{return""}};h(b(n.startDate)),u(b(n.endDate))}},[t,n]);const C=async b=>{if(b.preventDefault(),!a){k.error("Semester ID is missing.");return}if(c&&(!w||!m)){k.error("Start and end dates are required when semester is Active.");return}if(w&&m&&new Date(w)>new Date(m)){k.error("Start date cannot be after the end date.");return}const i=localStorage.getItem("accessToken");if(!i){k.error("Authentication required.");return}y(!0);try{const p=`/semesters/${a}/status`,L={status:c?1:0,start_date:w||null,end_date:m||null},f=await ce.put(p,L,{headers:{Authorization:`Bearer ${i}`}});k.success(f.data.message||"Semester status updated!"),r(o,{isActive:L.status===1,startDate:L.start_date||void 0,endDate:L.end_date||void 0})}catch(p){k.error(p.response?.data?.message||"Failed to update semester.")}finally{y(!1)}};return e.jsx($e,{open:t,onOpenChange:s,children:e.jsxs(Me,{children:[e.jsxs(Fe,{children:[e.jsx(ze,{children:"Set Semester Status & Dates"}),e.jsxs(lt,{className:"flex items-center gap-2 pt-1",children:[e.jsx(Kr,{className:"h-4 w-4"}),"School Year: ",j]})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{children:"Semester"}),e.jsx("p",{className:"font-semibold text-lg",children:o})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(xr,{id:"semester-status",checked:c,onCheckedChange:N}),e.jsx(X,{htmlFor:"semester-status",className:"cursor-pointer",children:c?"Active":"Inactive"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"startDate",children:"Start Date"}),e.jsx(W,{id:"startDate",type:"date",value:w,onChange:b=>h(b.target.value),required:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"endDate",children:"End Date"}),e.jsx(W,{id:"endDate",type:"date",value:m,onChange:b=>u(b.target.value),required:c})]})]}),e.jsxs(He,{className:"pt-4",children:[e.jsx(Ye,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:P,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:P,children:P?e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"mr-2 h-4 w-4 animate-spin"})," Saving..."]}):"Save Settings"})]})]})]})})}function Ks({readOnly:t=!1}){const[s,r]=d.useState([]),[a,o]=d.useState(!0),[n,j]=d.useState(""),[c,N]=d.useState("All Years"),[w,h]=d.useState("Active"),[m,u]=d.useState(null),[P,y]=d.useState(!1),[C,b]=d.useState(null),[i,p]=d.useState(!1),[L,f]=d.useState(!1),[_,U]=d.useState(!1),[E,l]=d.useState(0),[x,S]=d.useState(null),[D,z]=d.useState(null),[v,K]=d.useState(null),[$,se]=d.useState(null),[Z,ue]=d.useState({id:null,name:null}),de=Lr(),[le,Ue]=d.useState(null),me=d.useCallback(async(T=!0)=>{T&&o(!0);const O=localStorage.getItem("accessToken");if(!O){k.error("Authentication required."),o(!1),de("/facultyscheduler/user-login");return}try{const M=await ce.get("/program",{headers:{Authorization:`Bearer ${O}`}}),Re=(Array.isArray(M.data.programs)?M.data.programs:Object.values(M.data.programs||{})).map(G=>({id:G.id,name:G.program_name||"",abbreviation:G.abbreviation||"",effectiveYear:`${G.year_from}-${G.year_to}`,total_subjects:G.total_subjects||0,total_units:G.total_units||0,isActive:G.status===0,semesters:G.semesters?Object.entries(G.semesters).reduce((De,[te,he])=>(De[te]={id:he.id,subjects:(he.subjects||[]).map(re=>({id:re.id,code:re.subject_code,name:re.des_title,unitsTotal:re.total_units,unitsLec:re.lec_units,unitsLab:re.lab_units,hoursTotal:re.total_hrs,hoursLec:re.total_lec_hrs,hoursLab:re.total_lab_hrs,prerequisite:re.pre_requisite||""})),isActive:he.status===1,startDate:he.start_date,endDate:he.end_date},De),{}):{},subjects:G.subjects||{}}));r(Re)}catch{k.error("Failed to fetch programs.")}finally{T&&o(!1)}},[de]);d.useEffect(()=>{me(!0)},[me]),d.useEffect(()=>{x&&S(null)},[x]),d.useEffect(()=>{D&&z(null)},[D]),d.useEffect(()=>{v&&K(null)},[v]);const je=(T,O,M)=>{Ue({name:T,semester:O,effectiveYear:M})},qe=(T,O)=>{ue({id:T,name:O}),f(!0)},Ve=()=>{me(!1),y(!1)},We=()=>{b(null),y(!0)},ke=T=>{b(T),y(!0)},[ne,be]=d.useState(null),[_e,ve]=d.useState(!1),Ze=T=>{be({open:!0,title:"Archive Program",description:"This will move the program to the archives and make it inactive.",confirmText:"Yes, archive it!",confirmVariant:"destructive",onConfirm:async()=>{const O=localStorage.getItem("accessToken");if(!O){k.error("Authentication required.");return}try{const M=await ce.post(`/archive-program/${T}`,{},{headers:{Authorization:`Bearer ${O}`}});k.success(M.data?.message||"Program archived successfully."),await me(!1)}catch{k.error("Failed to archive program.")}}})},et=T=>{be({open:!0,title:"Restore Program",description:"This will make the program active again.",confirmText:"Yes, restore it!",confirmVariant:"default",onConfirm:async()=>{const O=localStorage.getItem("accessToken");if(!O){k.error("Authentication required.");return}try{await ce.post(`/restore-program/${T}`,{},{headers:{Authorization:`Bearer ${O}`}}),k.success("Program restored successfully."),await me(!1)}catch{k.error("Failed to restore program.")}}})},I=(T,O)=>{se({semester:T,semesterId:O,subject:null}),U(!0)},tt=(T,O)=>{const M=m?.semesters?.[T]?.id;se({semester:T,semesterId:M,subject:O}),U(!0)},rt=(T,O)=>{if(!O){k.error("Could not find subject ID to delete.");return}be({open:!0,title:"Delete Subject",description:"This will permanently delete this subject. This action cannot be reverted.",confirmText:"Yes, delete it!",confirmVariant:"destructive",onConfirm:async()=>{const M=localStorage.getItem("accessToken");if(!M){k.error("Authentication required.");return}try{await ce.delete(`/subjects/${O}`,{headers:{Authorization:`Bearer ${M}`}}),k.success("Subject deleted successfully!"),l(ye=>ye+1),await me(!1)}catch{k.error("Failed to delete subject.")}}})},Xe=async(T,O,M,ye)=>{if(!m){k.error("No program selected.");return}const Re=localStorage.getItem("accessToken");if(!Re){k.error("Authentication required.");return}try{const G=O??m?.semesters?.[T]?.id;if(!ye&&!G){k.error("Semester ID not found.");return}const De={subject_code:M.code,des_title:M.name,total_units:M.unitsTotal,lec_units:M.unitsLec,lab_units:M.unitsLab,total_hrs:M.hoursTotal,total_lec_hrs:M.hoursLec,total_lab_hrs:M.hoursLab,pre_requisite:M.prerequisite||null};let te;if(ye){if(!M.id){k.error("Subject ID missing for update.");return}te=await ce.put(`/subjects/${M.id}`,De,{headers:{Authorization:`Bearer ${Re}`}}),k.success("Subject updated successfully.")}else te=await ce.post(`/semesters/${G}/subjects`,De,{headers:{Authorization:`Bearer ${Re}`}}),k.success("Subject added successfully.");if(te.data?.subject){const he={id:te.data.subject.id,code:te.data.subject.subject_code,name:te.data.subject.des_title,unitsTotal:te.data.subject.total_units,unitsLec:te.data.subject.lec_units,unitsLab:te.data.subject.lab_units,hoursTotal:te.data.subject.total_hrs,hoursLec:te.data.subject.total_lec_hrs,hoursLab:te.data.subject.total_lab_hrs,prerequisite:te.data.subject.pre_requisite||"None"};S({semesterName:T,subject:he})}else l(he=>he+1);await me(!1)}catch{k.error("The subject code has already been taken")}},ut=T=>{z(T),me(!1)},dt=(T,O)=>{K({name:T,semester:O}),Ue(null)},we=(T,O)=>{K({name:T,semester:{},newName:O})},st=d.useMemo(()=>{const T=new Set(s.map(O=>O.effectiveYear));return["All Years",...Array.from(T).sort((O,M)=>M.localeCompare(O))]},[s]),nt=d.useMemo(()=>s.filter(T=>T.name.toLowerCase().includes(n.toLowerCase())||T.abbreviation.toLowerCase().includes(n.toLowerCase())).filter(T=>c==="All Years"||T.effectiveYear===c).filter(T=>w==="All"?!0:w==="Active"?T.isActive:!T.isActive),[s,n,c,w]);return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground tracking-tight",children:"Curriculum Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage academic programs, semesters, and their subjects."})]}),e.jsx("div",{className:"bg-card p-4 md:p-6 rounded-lg shadow-sm border border-border mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[e.jsxs("div",{className:"relative w-full md:flex-grow",children:[e.jsx(Fr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(W,{type:"text",placeholder:"Search program...",className:"pl-10 w-full",value:n,onChange:T=>j(T.target.value)})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto",children:[e.jsxs(Te,{value:c,onValueChange:N,children:[e.jsxs(Le,{className:"w-full sm:w-auto md:w-[180px]",children:[e.jsx(qt,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx(Ee,{placeholder:"Filter by A.Y."})]}),e.jsx(Ae,{children:st.map(T=>e.jsx(xe,{value:T,children:T},T))})]}),e.jsxs(Te,{value:w,onValueChange:h,children:[e.jsxs(Le,{className:"w-full sm:w-auto md:w-[180px]",children:[e.jsx(Hr,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx(Ee,{placeholder:"Filter by Status"})]}),e.jsxs(Ae,{children:[e.jsx(xe,{value:"All",children:"All"}),e.jsx(xe,{value:"Active",children:"Active"}),e.jsx(xe,{value:"Inactive",children:"Inactive"})]})]}),!t&&e.jsxs(q,{onClick:We,className:"w-full sm:w-auto",children:[e.jsx(Lt,{size:16,className:"mr-2"})," Add Program"]})]})]})}),a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:3}).map((T,O)=>e.jsx(es,{},O))}):e.jsx(Er,{children:nt.length>0?e.jsx(bt.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:nt.map((T,O)=>e.jsx(Zr,{program:T,index:O,onEdit:t?()=>{}:ke,onArchive:t?()=>{}:Ze,onRestore:t?()=>{}:et,onManage:()=>u(T),readOnly:t},T.id))}):e.jsxs(bt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-20 text-muted-foreground",children:[e.jsx(Ur,{size:56,className:"mx-auto mb-4"}),e.jsx("h4",{className:"font-semibold text-xl text-foreground",children:"No Programs Found"}),e.jsx("p",{children:"Try adjusting your filters or add a new program."})]})}),e.jsx(Is,{isOpen:P,onClose:()=>y(!1),onSave:Ve,initialData:C}),ne&&e.jsx($e,{open:ne.open,onOpenChange:T=>!T&&be(null),children:e.jsxs(Me,{children:[e.jsxs(Fe,{children:[e.jsx(ze,{children:ne.title}),ne.description&&e.jsx(lt,{children:ne.description})]}),e.jsxs(He,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx(q,{variant:"outline",disabled:_e,children:"Cancel"})}),e.jsx(q,{onClick:async()=>{if(ne?.onConfirm){ve(!0);try{await ne.onConfirm()}finally{ve(!1),be(null)}}},disabled:_e,variant:ne.confirmVariant,children:_e?"Processing...":ne.confirmText||"Confirm"})]})]})}),m&&e.jsx(Rs,{isOpen:!!m,onClose:()=>u(null),program:m,onAddSemester:()=>p(!0),onEditSemester:qe,onDeleteSemester:()=>{},onAddSubject:I,onEditSubject:tt,onDeleteSubject:rt,onSetSemesterStatus:je,refreshKey:E,updatedSubjectData:x,newSemesterData:D,updatedSemesterData:v,readOnly:t}),!t&&e.jsx($s,{isOpen:i,onClose:()=>p(!1),onSave:ut,programId:m?m.id:0}),!t&&e.jsx(zs,{isOpen:L,onClose:()=>f(!1),onSaveSuccess:we,semesterId:Z.id,initialData:Z.name||""}),!t&&$&&e.jsx(Hs,{isOpen:_,onClose:()=>U(!1),onSave:(T,O)=>Xe($.semester,$.semesterId,T,O),initialData:$.subject,programId:m?.id??0,semesterName:$.semester||"",semesterId:$.semesterId}),le&&e.jsx(Xs,{isOpen:!!le,onClose:()=>Ue(null),onSaveSuccess:dt,semesterId:le.semester?.id||null,semesterName:le.name||"",initialData:le.semester||null,effectiveYear:le.effectiveYear})]})}function gn({readOnly:t=!1}){return e.jsx("main",{children:e.jsx(Ks,{readOnly:t})})}export{gn as default};
