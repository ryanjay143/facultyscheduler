import{c as ce,j as e,C as ge,r as l,a as I,t as H,B as Q,k as it,l as ct,n as nr,o as X,p as te,i as se,q as K,h as or,P as de,U as dt,d as ut,A as ar}from"./index-D-mCsc05.js";import{S as Ge}from"./sweetalert2.esm.all-ePrzfkxH.js";import{I as be}from"./input-WdzOX4yL.js";import{S as Y,D as mt,a as ft,b as ht,c as xt,d as lr,e as pt,f as gt}from"./dialog-ClZw9g1P.js";import{B as ie}from"./badge-pVb_z3Pi.js";import{C as ir}from"./calendar-off-COJu9YEp.js";import{L as Le}from"./label-C4TF9PIB.js";import{C as cr}from"./chevron-right-DEWTpSnt.js";import{L as G}from"./loader-circle-qJ_8jGOU.js";import{T as $e}from"./triangle-alert-DBTA2Mh0.js";import{C as le}from"./check-Vx4rEt9t.js";import{S as bt}from"./search-Cz4LFRIi.js";import{C as dr}from"./circle-check-big-CtVaPk81.js";import{C as ur}from"./calendar-x-2-CExkuhQA.js";import{u as mr,c as fr}from"./Combination-BEZVJ90C.js";import{T as hr,a as xr,b as pr,c as gr}from"./tabs-Bkl0Rs7m.js";import{C as br,b as vr}from"./card-CLJOKC44.js";import{C as jr}from"./circle-alert-DX0R_umE.js";import{C as yr}from"./calendar-check-j3nJunZ6.js";import{P as Sr,F as wr}from"./presentation-BFRtecln.js";import{M as Nr}from"./map-pin-B2_AyuUy.js";import{C as _r}from"./circle-plus-BO6uY8Zs.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],Ar=ce("circle-arrow-down",Cr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Er=ce("circle-check",Tr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Rr=ce("info",Lr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],$r=ce("list",Pr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Qe=ce("trending-up",kr);function Mr(){return e.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-lg border flex",children:[e.jsx("div",{className:"relative flex-shrink-0 w-1/3 bg-slate-50 flex items-center justify-center p-6",children:e.jsx(Y,{className:"w-24 h-24 rounded-full"})}),e.jsxs("div",{className:"flex-grow flex flex-col p-5 w-2/3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"h-6 w-4/5"}),e.jsx(Y,{className:"h-4 w-3/5"})]}),e.jsx("div",{className:"flex-grow"}),e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsx(Y,{className:"h-3 w-1/3"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Y,{className:"h-5 w-20 rounded-full"}),e.jsx(Y,{className:"h-5 w-24 rounded-full"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx(Y,{className:"h-9 w-full rounded-md"}),e.jsx(Y,{className:"h-9 w-full rounded-md"})]})]})]})}const Ir=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ze=t=>{if(!t||!t.includes(":"))return"Invalid Time";const[s,r]=t.split(":");let n=parseInt(s,10);const o=n>=12?"PM":"AM";return n=n%12||12,`${n}:${r} ${o}`};function Dr({schedule:t}){const s=new Date().toLocaleString("en-US",{weekday:"long"});return e.jsx("div",{className:"bg-background p-2 rounded-lg border max-h-64 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 gap-2",children:Ir.map(r=>{const n=t[r],o=n&&n.length>0,a=r===s;return e.jsxs("div",{className:`rounded-md p-3 flex flex-col min-h-[80px] transition-all duration-200 ${a?"bg-primary/10 border-2 border-primary/80":"bg-muted/50 border border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:`font-bold text-sm ${a?"text-primary":"text-foreground"}`,children:r}),a&&e.jsx(ie,{variant:"default",className:"text-[10px] h-5",children:"TODAY"})]}),o?e.jsx("div",{className:"space-y-1.5 flex-grow",children:n.map((d,i)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0"}),e.jsxs("p",{className:"font-mono text-xs text-foreground font-medium",children:[Ze(d.start)," - ",Ze(d.end)]})]},i))}):e.jsxs("div",{className:"flex flex-col items-center justify-center flex-grow text-center text-slate-400",children:[e.jsx(ir,{className:"h-5 w-5 mb-1"}),e.jsx("p",{className:"text-xs italic",children:"Not available"})]})]},r)})})})}const D=t=>{if(!t)return 0;const[s,r]=t.split(":").map(Number);return s*60+r},Or=t=>{const s=Math.floor(t/60),r=t%60;return`${String(s).padStart(2,"0")}:${String(r).padStart(2,"0")}`},Fr=(t,s)=>{if(!t)return"";const r=D(t)+s,n=Math.max(0,Math.min(1439,r));return Or(n)},ve=t=>{if(!t)return"";const s=t.split(":");if(s.length<2)return t;const r=parseInt(s[0]||"0",10),n=parseInt(s[1]||"0",10),o=r>=12?"PM":"AM";return`${r%12===0?12:r%12}:${String(n).padStart(2,"0")} ${o}`},zr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Wr=(t,s,r,n)=>{if(!t||!s||!r||!n)return!1;const o=D(t),a=D(s),d=D(r),i=D(n);return Math.max(o,d)<Math.min(a,i)},Ur=(t,s)=>{if(!t)return!1;const r=t.toString().toLowerCase(),n=s.toString().toLowerCase();return n.includes("lab")?r.includes("lab")||r.includes("labor"):n.includes("lec")||n.includes("lecture")?r.includes("lec")||r.includes("lecture"):r===n},Ke=({type:t,hours:s,schedules:r,facultySchedule:n,onScheduleChange:o,timeError:a})=>{const d=l.useMemo(()=>{const i=r[t].day;if(!i||!n[i]?.length)return{min:void 0,max:void 0};const u=n[i],c=u.reduce((f,m)=>m.start<f?m.start:f,u[0].start),h=u.reduce((f,m)=>m.end>f?m.end:f,u[0].end);return{min:c,max:h}},[r[t].day,n,t,r]);return e.jsxs("div",{className:"pt-4 border-t space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-md text-foreground",children:[t==="lec"?"Lecture":"Laboratory"," Schedule (",s," hours)"]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx(Le,{htmlFor:`${t}-day`,children:"Day of Class"}),e.jsxs("select",{id:`${t}-day`,value:r[t].day,onChange:i=>o(t,"day",i.target.value),className:"w-full mt-1 p-2 border rounded-md bg-background disabled:opacity-50",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a day"}),zr.map(i=>e.jsxs("option",{value:i,disabled:!n[i]?.length,children:[i," ",!n[i]?.length&&"(Unavailable)"]},i))]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Le,{htmlFor:`${t}-start-time`,className:"text-xs font-semibold text-muted-foreground",children:"Start Time"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(be,{id:`${t}-start-time`,type:"time",value:r[t].startTime,onChange:i=>o(t,"startTime",i.target.value),className:"pl-9",step:"1800",min:d.min,max:d.max,disabled:!r[t].day})]})]}),e.jsxs("div",{children:[e.jsx(Le,{htmlFor:`${t}-end-time`,className:"text-xs font-semibold text-muted-foreground",children:"End Time"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(be,{id:`${t}-end-time`,type:"time",value:r[t].endTime,onChange:i=>o(t,"endTime",i.target.value),className:"pl-9",step:"1800",min:d.min,max:d.max,disabled:!r[t].day})]})]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:(()=>{const i=u=>{if(!u)return"--:--";const c=u.split(":");return`${c[0]?.padStart(2,"0")}:${c[1]?.padStart(2,"0")}`};return`Window: ${i(d.min)} - ${i(d.max)}`})()}),(s??0)>0&&r[t].startTime&&e.jsxs(Q,{type:"button",size:"sm",variant:"outline",onClick:()=>o(t,"endTime",Fr(r[t].startTime,(s||0)*60)),children:["Auto-fill end (+",s,"h)"]})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-destructive/10 border-destructive/30 rounded-lg text-destructive text-sm",children:[e.jsx($e,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("p",{children:a})]})]})},Je=({type:t,schedules:s,availableRooms:r,isLoadingRooms:n,selectedRooms:o,onSelectRoom:a})=>{const d=s[t].day||"",i=s[t].startTime||"",u=s[t].endTime||"",c=t==="lec"?"Lecture":"Laboratory",h=l.useMemo(()=>{if(!d||!i||!u)return new Set;const p=r[t].filter(S=>Ur(S.type,c)?(S.availabilities||[]).filter(A=>(A.day||"").toString().toLowerCase()===d.toString().toLowerCase()).some(A=>{const O=A.start_time??A.start??"",$=A.end_time??A.end??"";return!O||!$?!1:D(O)<=D(i)&&D($)>=D(u)}):!1);return new Set(p.map(S=>S.id))},[r,t,d,i,u,c]),f=r[t],m=!!d&&!!i&&!!u,x=m?`${ve(i)} - ${ve(u)}`:"--:-- - --:--";return e.jsx("div",{className:"pt-4 border-t space-y-3",children:n[t]?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx(G,{className:"h-6 w-6 animate-spin text-primary"})}):m?f.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-24 text-center text-destructive bg-destructive/5 border border-destructive/20 rounded-lg p-3",children:[e.jsx($e,{className:"h-5 w-5 mb-1 flex-shrink-0"}),e.jsxs("p",{className:"text-sm font-semibold",children:["ALL ",c.toUpperCase()," ROOMS ARE BUSY"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["No rooms are free for the slot: (",d,", ",x,"). Please change the time or day."]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-xs text-muted-foreground font-semibold",children:["Showing ",h.size," available ",c," rooms for ",d,", ",x,":"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto pr-2 -mr-2",children:f.map(p=>{const S=h.has(p.id),E=S?"AVAILABLE":"BUSY",P=S?"bg-green-100 text-green-700":"bg-red-100 text-red-700",A=S?o[t]===p.id?"bg-primary/10 border-primary shadow-sm":"bg-background hover:border-primary/50":"bg-red-50 border-red-300 opacity-70 cursor-not-allowed";return e.jsxs("button",{onClick:()=>S&&a(t,p.id),disabled:!S,className:`p-2 border rounded-md text-left transition-all relative ${A}`,children:[e.jsx("div",{className:`absolute top-0 right-0 p-1 px-2 rounded-tr-md rounded-bl-md text-xs font-semibold ${P}`,children:E}),o[t]===p.id&&S&&e.jsx(le,{className:"h-4 w-4 text-primary absolute top-2 right-2 mt-2"}),e.jsx("p",{className:"font-semibold text-sm pt-2",children:p.roomNumber}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Cap: ",p.capacity??"--"]}),p.type&&e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-slate-100 text-slate-700 font-medium",children:p.type})]}),e.jsxs("p",{className:`text-[10px] mt-1 truncate ${S?"text-green-700 font-medium":"text-red-700 font-medium"}`,children:["Slot: ",x," is ",E]})]},p.id)})})]}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Set a full valid day and time schedule to view room status."})})};function Vr({isOpen:t,onClose:s,faculty:r,availableSubjects:n=[],onAssign:o}){const[a,d]=l.useState(1),[i,u]=l.useState(""),[c,h]=l.useState(null),[f,m]=l.useState(0),[x,p]=l.useState(!0),[S,E]=l.useState([]),[P,A]=l.useState([]),[O,$]=l.useState(!1),[V,z]=l.useState(null),[C,T]=l.useState({lec:{day:"",startTime:"",endTime:""},lab:{day:"",startTime:"",endTime:""}}),[y,_]=l.useState({lec:null,lab:null}),[R,B]=l.useState({lec:[],lab:[]}),[J,M]=l.useState({lec:!1,lab:!1}),[W,ze]=l.useState({lec:null,lab:null}),[ee,We]=l.useState({}),[Zt,Ce]=l.useState([]),[Kt,Ae]=l.useState(!0),[Te,me]=l.useState(!1),Ue=l.useCallback(()=>{d(1),u(""),h(null),T({lec:{day:"",startTime:"",endTime:""},lab:{day:"",startTime:"",endTime:""}}),_({lec:null,lab:null}),B({lec:[],lab:[]}),ze({lec:null,lab:null}),me(!1)},[]);l.useEffect(()=>{if(t){if(u(""),Ue(),n&&Array.isArray(n)){const g=n.map(b=>{const j=b.total_lec_hrs??b.lec_units??0,v=b.total_lab_hrs??b.lab_units??0,w=b.total_hrs??j+v;return{...b,total_lec_hrs:j,total_lab_hrs:v,total_hrs:w,total_units:b.total_units??w}});z(g),A(g)}else(async()=>{$(!0);try{const b=localStorage.getItem("accessToken");let j;try{j=await I.get("get-subjects",{headers:b?{Authorization:`Bearer ${b}`}:void 0})}catch{j=await I.get("get-subjects")}const w=(j.data?.subject||j.data?.data||[]).map(N=>{const L=N.total_lec_hrs??N.lec_units??0,k=N.total_lab_hrs??N.lab_units??0,q=N.total_hrs??L+k;return{...N,total_lec_hrs:L,total_lab_hrs:k,total_hrs:q,total_units:N.total_units??q}});z(w),A(w)}catch(b){console.error("Failed to fetch subjects:",b),A([]),z([])}finally{$(!1)}})();if(r){const g=async()=>{p(!0);const v=localStorage.getItem("accessToken");if(!v){p(!1);return}try{const w=await I.get(`/faculties/${r.id}/current-load`,{headers:{Authorization:`Bearer ${v}`}});m(w.data.current_load_units??0),E(w.data.assigned_subject_ids??w.data.assigned_subjects??[])}catch(w){console.error("Error fetching current load:",w),m(0),H.error("Failed to fetch faculty's current load.")}finally{p(!1)}},b=async()=>{Ae(!0);const v=localStorage.getItem("accessToken");if(!v){Ae(!1);return}try{const w=await I.get(`/faculties/${r.id}/availability`,{headers:{Authorization:`Bearer ${v}`}});We(w.data)}catch{We({})}finally{Ae(!1)}},j=async()=>{const v=localStorage.getItem("accessToken");if(!v){Ce([]);return}try{const w=await I.get(`faculty-loading/${r.id}/schedules`,{headers:{Authorization:`Bearer ${v}`}}),N=w.data?.data||w.data||[];Ce(Array.isArray(N)?N:[])}catch(w){console.error("Failed to fetch assigned schedules",w),Ce([])}};g(),b(),j()}}},[t,r,n,Ue]);const{totalAllowedLoad:Ee,potentialTotalLoad:Ve,isLoadExceeded:ne}=l.useMemo(()=>{const g=r.t_load_units??0,b=r.overload_units??0,j=g+b,v=c?.total_hrs??c?.total_units??0,w=f+v,N=j>0&&w>j;return{totalAllowedLoad:j,potentialTotalLoad:w,isLoadExceeded:N}},[r,f,c]),Jt=c?.total_hrs??c?.total_units??0,Be=async()=>{const g=i.trim();if(!g){V&&A(V);return}$(!0);try{const b=localStorage.getItem("accessToken");let j;try{j=await I.get("filter-subjects",{params:{subject:g},headers:b?{Authorization:`Bearer ${b}`}:void 0})}catch{j=await I.get("filter-subjects",{params:{subject:g}})}const w=(j.data?.data||j.data?.subject||[]).map(N=>{const L=N.total_lec_hrs??N.lec_units??0,k=N.total_lab_hrs??N.lab_units??0,q=N.total_hrs??L+k;return{id:N.id,subject_code:N.subject_code,des_title:N.des_title,total_lec_hrs:L,total_lab_hrs:k,total_hrs:q,total_units:N.total_units??q}});A(w)}catch(b){console.error("Subject search failed:",b),H.error("Search failed"),A([])}finally{$(!1)}};l.useEffect(()=>{c&&d(2)},[c]),l.useEffect(()=>{const g=(b,j)=>{const{day:v,startTime:w,endTime:N}=C[b];if(!w||!N||!c||!v||j===0)return null;const L=D(w),k=D(N),q=j*60,sr=k-L;if(L>=k)return"End time must be after start time.";if(sr>q)return`Duration cannot exceed ${j} hour(s).`;const Xe=ee[v];return Xe?.length?Xe.some(qe=>L>=D(qe.start)&&k<=D(qe.end))?null:"Time is outside faculty's availability.":"Faculty is not available on this day."};c&&ze({lec:g("lec",c.total_lec_hrs??0),lab:g("lab",c.total_lab_hrs??0)})},[C,c,ee]);const fe=l.useCallback(async g=>{const b=C[g];if(!b.day||!b.startTime||!b.endTime||W[g]){B(v=>({...v,[g]:[]}));return}M(v=>({...v,[g]:!0}));const j=localStorage.getItem("accessToken");if(!j){M(v=>({...v,[g]:!1}));return}try{const w=(await I.get("/rooms/availabilities",{headers:{Authorization:`Bearer ${j}`},params:{day:b.day,start_time:b.startTime,end_time:b.endTime,type:g==="lec"?"Lecture":"Laboratory"}})).data.rooms||[],N=await Promise.all(w.map(async L=>{try{const k=await I.get(`/rooms/${L.id}/availabilities`,{headers:{Authorization:`Bearer ${j}`}});return{...L,availabilities:k.data.availabilities||[]}}catch{return{...L,availabilities:[]}}}));B(L=>({...L,[g]:N}))}catch{H.error(`Failed to fetch available ${g} rooms.`),B(w=>({...w,[g]:[]}))}finally{M(v=>({...v,[g]:!1}))}},[C,W]),oe=l.useMemo(()=>(c?.total_lec_hrs??0)>0?C.lec.day&&C.lec.startTime&&C.lec.endTime&&!W.lec:!0,[C.lec,W.lec,c]),ae=l.useMemo(()=>(c?.total_lab_hrs??0)>0?C.lab.day&&C.lab.startTime&&C.lab.endTime&&!W.lab:!0,[C.lab,W.lab,c]);l.useEffect(()=>{oe&&(c?.total_lec_hrs??0)>0&&fe("lec")},[oe,C.lec,c,fe]),l.useEffect(()=>{ae&&(c?.total_lab_hrs??0)>0&&fe("lab")},[ae,C.lab,c,fe]),l.useEffect(()=>{c||d(1)},[c]);const He=(g,b,j)=>{T(v=>({...v,[g]:{...v[g],[b]:j}})),_(v=>({...v,[g]:null}))},Ye=(g,b)=>{_(j=>({...j,[g]:b}))},er=async()=>{if(!c)return;if(ne){H.error(`Assignment blocked: Potential load of ${Ve} exceeds maximum allowed load of ${Ee} units.`);return}const g=[];if((c.total_lec_hrs??0)>0){const{day:b,startTime:j,endTime:v}=C.lec;if(!b||!j||!v||!y.lec){H.error("Incomplete lecture schedule or room selection.");return}g.push({type:"LEC",day:b,time:`${j}-${v}`,roomId:y.lec})}if((c.total_lab_hrs??0)>0){const{day:b,startTime:j,endTime:v}=C.lab;if(!b||!j||!v||!y.lab){H.error("Incomplete laboratory schedule or room selection.");return}g.push({type:"LAB",day:b,time:`${j}-${v}`,roomId:y.lab})}me(!0);try{for(const b of g){const[j,v]=b.time.split("-");for(const w of Zt){if(!w.day||w.day.toString().toLowerCase()!==b.day.toString().toLowerCase())continue;const N=w.start_time??w.start??"",L=w.end_time??w.end??"";if(Wr(j,v,N,L)){const k=`Conflict: Faculty is already assigned a class on ${b.day} from ${ve(N)} to ${ve(L)}. Assignment failed.`;H.error(k),me(!1);return}}}}catch(b){console.error("Conflict check failed",b)}try{const b=localStorage.getItem("accessToken"),j={facultyId:r.id,subjectId:c.id,schedules:g},v=await I.post("faculty-loading/assign",j,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`}});v.data.success&&(H.success(v.data.message||"Subject assigned successfully!"),o(r.id,c.id,g),s())}catch(b){console.error("Assignment Error:",b);const j=b.response?.data?.message||"Failed to assign subject. Please check conflicts.";H.error(j)}finally{me(!1)}},he=(c?.total_lec_hrs??0)>0?!!y.lec:!0,xe=(c?.total_lab_hrs??0)>0?!!y.lab:!0,tr=!c||!oe||!ae||!he||!xe||Te||ne||x,rr=Object.values(ee).some(g=>g.length>0);return e.jsx(mt,{open:t,onOpenChange:s,children:e.jsxs(ft,{className:"max-w-7xl w-[96%] h-[92vh] flex flex-col p-0",children:[e.jsxs(ht,{className:"p-6 pb-4 border-b bg-gradient-to-r from-indigo-50 to-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(xt,{className:"text-2xl font-bold tracking-tight",children:"Assign Subject"}),e.jsxs(lr,{children:["Assign a subject to ",e.jsx("span",{className:"font-semibold text-foreground",children:r.name}),"."]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:`h-6 px-2 rounded-full flex items-center gap-1 ${c?"bg-green-100 text-green-700":"bg-indigo-100 text-indigo-700"}`,children:[e.jsx("span",{className:"font-semibold",children:"1"}),e.jsx("span",{children:"Select"})]}),e.jsx(cr,{className:"w-4 h-4"}),e.jsxs("div",{className:`h-6 px-2 rounded-full flex items-center gap-1 ${a>=2?he&&xe?"bg-green-100 text-green-700":"bg-indigo-100 text-indigo-700":"bg-muted text-muted-foreground"}`,children:[e.jsx("span",{className:"font-semibold",children:"2"}),e.jsx("span",{children:"Details"})]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-white border rounded-lg shadow-sm",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Faculty Load Status"}),x?e.jsxs("div",{className:"flex items-center gap-2 text-primary text-sm",children:[e.jsx(G,{className:"h-4 w-4 animate-spin"})," Fetching Load..."]}):e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("p",{className:"font-medium",children:["Normal Load: ",e.jsxs("span",{className:"text-foreground font-bold",children:[r.t_load_units??0," units"]})]}),e.jsxs("p",{className:"font-medium",children:["Max Overload: ",e.jsxs("span",{className:"text-foreground font-bold",children:[r.overload_units??0," units"]})]}),e.jsxs("p",{className:"font-medium",children:["Total Max: ",e.jsxs("span",{className:"text-foreground font-bold",children:[Ee," units"]})]}),e.jsxs("p",{className:"col-span-3 text-sm pt-2 border-t mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Current Assigned:"}),e.jsxs("span",{className:"text-foreground font-bold ml-1",children:[f," units"]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(Current + ",Jt," units)"]}),e.jsxs("span",{className:`font-bold ml-2 ${ne?"text-destructive":"text-primary"}`,children:["â†’ Potential Total: ",Ve," units"]})]})]})]}),ne&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 p-2 bg-destructive/10 border-destructive/30 rounded-lg text-destructive text-sm",children:[e.jsx($e,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("p",{className:"font-medium",children:["Warning: This assignment will exceed the total allowed load of ",Ee," units. Please select another faculty or subject."]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 flex-grow overflow-y-auto px-6 py-6 bg-muted/30",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg transition-colors ${c?"bg-green-500 text-white":"bg-primary text-primary-foreground"}`,children:c?e.jsx(le,{className:"h-5 w-5"}):"1"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Select Subject"})]})}),e.jsxs("div",{className:"flex flex-col flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(bt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx(be,{placeholder:"Search by code or title...",value:i,onChange:g=>u(g.target.value),onKeyDown:g=>g.key==="Enter"&&Be(),className:"pl-10 bg-background"})]}),e.jsx(Q,{variant:"default",onClick:Be,disabled:O||!i.trim(),children:O?e.jsx(G,{className:"h-4 w-4 animate-spin"}):"Search"})]}),e.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 -mr-2 pr-2",children:P.length>0?P.map(g=>e.jsxs("button",{onClick:()=>h(g),className:`w-full text-left p-3 rounded-md border transition-all duration-200 relative ${c?.id===g.id?"bg-primary/10 border-primary shadow-sm":"bg-background hover:border-primary/50 hover:bg-primary/5"}`,children:[c?.id===g.id&&e.jsx(dr,{className:"h-5 w-5 text-primary absolute top-3 right-3"}),e.jsx("p",{className:"font-semibold text-foreground pr-6 uppercase",children:g.subject_code}),e.jsx("p",{className:"text-sm text-muted-foreground truncate mb-2 uppercase",children:g.des_title}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded",children:["Lec: ",g.total_lec_hrs??0]}),e.jsxs("span",{className:"bg-amber-50 text-amber-700 px-2 py-0.5 rounded",children:["Lab: ",g.total_lab_hrs??0]}),e.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-0.5 rounded",children:["Units: ",g.total_hrs??g.total_units??0]})]})]},g.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground rounded-lg bg-background border-2 border-dashed p-4",children:[e.jsx(G,{className:"h-8 w-8 mb-2"}),e.jsx("p",{className:"text-sm",children:O?"Searching...":i?"No subjects found.":"Enter a subject to search."})]})})]})]}),e.jsxs("div",{className:`bg-white p-4 rounded-xl border shadow-sm flex flex-col transition-all ${a<2&&"opacity-50 pointer-events-none"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg transition-colors ${a>=2&&oe&&ae?"bg-green-500 text-white":a>=2?"bg-primary text-primary-foreground":"bg-muted-foreground/30 text-muted-foreground"}`,children:a>=2&&oe&&ae?e.jsx(le,{className:"h-5 w-5"}):"2"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Set Schedule"})]}),a>=2&&e.jsx("div",{className:"flex-grow overflow-y-auto -mr-2 pr-2",children:Kt?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(G,{className:"h-8 w-8 animate-spin text-primary"})}):rr?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Dr,{schedule:ee}),(c?.total_lec_hrs??0)>0&&e.jsx(Ke,{type:"lec",hours:c?.total_lec_hrs??0,schedules:C,facultySchedule:ee,onScheduleChange:He,timeError:W.lec}),(c?.total_lab_hrs??0)>0&&e.jsx(Ke,{type:"lab",hours:c?.total_lab_hrs??0,schedules:C,facultySchedule:ee,onScheduleChange:He,timeError:W.lab})]}):e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-destructive/10 border-destructive/30 rounded-lg text-destructive",children:[e.jsx(ur,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("p",{className:"text-sm font-medium",children:"No faculty availability found."})]})})]}),e.jsxs("div",{className:`flex flex-col gap-4 h-full ${a<2&&"opacity-50 pointer-events-none"}`,children:[(c?.total_lec_hrs??0)>0&&e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm flex flex-col flex-1 min-h-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg transition-colors ${a>=3&&he?"bg-green-500 text-white":a>=3?"bg-primary text-primary-foreground":"bg-muted-foreground/30 text-muted-foreground"}`,children:a>=3&&he?e.jsx(le,{className:"h-5 w-5"}):"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Lecture Room"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select room"})]})]}),a>=2&&e.jsx("div",{className:"flex-grow overflow-y-auto -mr-2 pr-2",children:e.jsx(Je,{type:"lec",schedules:C,availableRooms:R,isLoadingRooms:J,selectedRooms:y,onSelectRoom:Ye})})]}),(c?.total_lab_hrs??0)>0&&e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm flex flex-col flex-1 min-h-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg transition-colors ${a>=3&&xe?"bg-green-500 text-white":a>=3?"bg-primary text-primary-foreground":"bg-muted-foreground/30 text-muted-foreground"}`,children:a>=3&&xe?e.jsx(le,{className:"h-5 w-5"}):"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Laboratory Room"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select room"})]})]}),a>=2&&e.jsx("div",{className:"flex-grow overflow-y-auto -mr-2 pr-2",children:e.jsx(Je,{type:"lab",schedules:C,availableRooms:R,isLoadingRooms:J,selectedRooms:y,onSelectRoom:Ye})})]}),(c?.total_lec_hrs??0)===0&&(c?.total_lab_hrs??0)===0&&e.jsx("div",{className:"bg-white p-4 rounded-xl border shadow-sm flex flex-col items-center justify-center h-full text-muted-foreground",children:e.jsx("p",{children:"Select a subject to view room options."})})]})]}),e.jsxs(pt,{className:"p-6 pt-4 border-t bg-background",children:[e.jsx(gt,{asChild:!0,children:e.jsx(Q,{variant:"outline",disabled:Te,children:"Cancel"})}),e.jsx(Q,{onClick:er,disabled:tr,children:Te?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"})," Assigning..."]}):ne?"Load Exceeded":"Assign Subject"})]})]})})}function Br(t,s=[]){let r=[];function n(a,d){const i=l.createContext(d);i.displayName=a+"Context";const u=r.length;r=[...r,d];const c=f=>{const{scope:m,children:x,...p}=f,S=m?.[t]?.[u]||i,E=l.useMemo(()=>p,Object.values(p));return e.jsx(S.Provider,{value:E,children:x})};c.displayName=a+"Provider";function h(f,m){const x=m?.[t]?.[u]||i,p=l.useContext(x);if(p)return p;if(d!==void 0)return d;throw new Error(`\`${f}\` must be used within \`${a}\``)}return[c,h]}const o=()=>{const a=r.map(d=>l.createContext(d));return function(i){const u=i?.[t]||a;return l.useMemo(()=>({[`__scope${t}`]:{...i,[t]:u}}),[i,u])}};return o.scopeName=t,[n,Hr(o,...s)]}function Hr(...t){const s=t[0];if(t.length===1)return s;const r=()=>{const n=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(a){const d=n.reduce((i,{useScope:u,scopeName:c})=>{const f=u(a)[`__scope${c}`];return{...i,...f}},{});return l.useMemo(()=>({[`__scope${s.scopeName}`]:d}),[d])}};return r.scopeName=s.scopeName,r}var Yr=Symbol.for("react.lazy"),je=it[" use ".trim().toString()];function Xr(t){return typeof t=="object"&&t!==null&&"then"in t}function vt(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Yr&&"_payload"in t&&Xr(t._payload)}function qr(t){const s=Gr(t),r=l.forwardRef((n,o)=>{let{children:a,...d}=n;vt(a)&&typeof je=="function"&&(a=je(a._payload));const i=l.Children.toArray(a),u=i.find(Zr);if(u){const c=u.props.children,h=i.map(f=>f===u?l.Children.count(c)>1?l.Children.only(null):l.isValidElement(c)?c.props.children:null:f);return e.jsx(s,{...d,ref:o,children:l.isValidElement(c)?l.cloneElement(c,void 0,h):null})}return e.jsx(s,{...d,ref:o,children:a})});return r.displayName=`${t}.Slot`,r}function Gr(t){const s=l.forwardRef((r,n)=>{let{children:o,...a}=r;if(vt(o)&&typeof je=="function"&&(o=je(o._payload)),l.isValidElement(o)){const d=Jr(o),i=Kr(a,o.props);return o.type!==l.Fragment&&(i.ref=n?ct(n,d):d),l.cloneElement(o,i)}return l.Children.count(o)>1?l.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Qr=Symbol("radix.slottable");function Zr(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Qr}function Kr(t,s){const r={...s};for(const n in s){const o=t[n],a=s[n];/^on[A-Z]/.test(n)?o&&a?r[n]=(...i)=>{const u=a(...i);return o(...i),u}:o&&(r[n]=o):n==="style"?r[n]={...o,...a}:n==="className"&&(r[n]=[o,a].filter(Boolean).join(" "))}return{...t,...r}}function Jr(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var es=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ke=es.reduce((t,s)=>{const r=qr(`Primitive.${s}`),n=l.forwardRef((o,a)=>{const{asChild:d,...i}=o,u=d?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(u,{...i,ref:a})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{}),Re={exports:{}},Pe={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et;function ts(){if(et)return Pe;et=1;var t=nr();function s(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var r=typeof Object.is=="function"?Object.is:s,n=t.useState,o=t.useEffect,a=t.useLayoutEffect,d=t.useDebugValue;function i(f,m){var x=m(),p=n({inst:{value:x,getSnapshot:m}}),S=p[0].inst,E=p[1];return a(function(){S.value=x,S.getSnapshot=m,u(S)&&E({inst:S})},[f,x,m]),o(function(){return u(S)&&E({inst:S}),f(function(){u(S)&&E({inst:S})})},[f]),d(x),x}function u(f){var m=f.getSnapshot;f=f.value;try{var x=m();return!r(f,x)}catch{return!0}}function c(f,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:i;return Pe.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,Pe}var tt;function rs(){return tt||(tt=1,Re.exports=ts()),Re.exports}var ss=rs();function ns(){return ss.useSyncExternalStore(os,()=>!0,()=>!1)}function os(){return()=>{}}var Me="Avatar",[as,xn]=Br(Me),[ls,jt]=as(Me),yt=l.forwardRef((t,s)=>{const{__scopeAvatar:r,...n}=t,[o,a]=l.useState("idle");return e.jsx(ls,{scope:r,imageLoadingStatus:o,onImageLoadingStatusChange:a,children:e.jsx(ke.span,{...n,ref:s})})});yt.displayName=Me;var St="AvatarImage",wt=l.forwardRef((t,s)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:o=()=>{},...a}=t,d=jt(St,r),i=is(n,a),u=X(c=>{o(c),d.onImageLoadingStatusChange(c)});return te(()=>{i!=="idle"&&u(i)},[i,u]),i==="loaded"?e.jsx(ke.img,{...a,ref:s,src:n}):null});wt.displayName=St;var Nt="AvatarFallback",_t=l.forwardRef((t,s)=>{const{__scopeAvatar:r,delayMs:n,...o}=t,a=jt(Nt,r),[d,i]=l.useState(n===void 0);return l.useEffect(()=>{if(n!==void 0){const u=window.setTimeout(()=>i(!0),n);return()=>window.clearTimeout(u)}},[n]),d&&a.imageLoadingStatus!=="loaded"?e.jsx(ke.span,{...o,ref:s}):null});_t.displayName=Nt;function rt(t,s){return t?s?(t.src!==s&&(t.src=s),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function is(t,{referrerPolicy:s,crossOrigin:r}){const n=ns(),o=l.useRef(null),a=n?(o.current||(o.current=new window.Image),o.current):null,[d,i]=l.useState(()=>rt(a,t));return te(()=>{i(rt(a,t))},[a,t]),te(()=>{const u=f=>()=>{i(f)};if(!a)return;const c=u("loaded"),h=u("error");return a.addEventListener("load",c),a.addEventListener("error",h),s&&(a.referrerPolicy=s),typeof r=="string"&&(a.crossOrigin=r),()=>{a.removeEventListener("load",c),a.removeEventListener("error",h)}},[a,r,s]),d}var Ct=yt,At=wt,Tt=_t;const Et=l.forwardRef(({className:t,...s},r)=>e.jsx(Ct,{ref:r,className:se("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));Et.displayName=Ct.displayName;const Lt=l.forwardRef(({className:t,...s},r)=>e.jsx(At,{ref:r,className:se("aspect-square h-full w-full",t),...s}));Lt.displayName=At.displayName;const Rt=l.forwardRef(({className:t,...s},r)=>e.jsx(Tt,{ref:r,className:se("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));Rt.displayName=Tt.displayName;function cs(t,s){return l.useReducer((r,n)=>s[r][n]??r,t)}var ue=t=>{const{present:s,children:r}=t,n=ds(s),o=typeof r=="function"?r({present:n.isPresent}):l.Children.only(r),a=K(n.ref,us(o));return typeof r=="function"||n.isPresent?l.cloneElement(o,{ref:a}):null};ue.displayName="Presence";function ds(t){const[s,r]=l.useState(),n=l.useRef(null),o=l.useRef(t),a=l.useRef("none"),d=t?"mounted":"unmounted",[i,u]=cs(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return l.useEffect(()=>{const c=pe(n.current);a.current=i==="mounted"?c:"none"},[i]),te(()=>{const c=n.current,h=o.current;if(h!==t){const m=a.current,x=pe(c);t?u("MOUNT"):x==="none"||c?.display==="none"?u("UNMOUNT"):u(h&&m!==x?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,u]),te(()=>{if(s){let c;const h=s.ownerDocument.defaultView??window,f=x=>{const S=pe(n.current).includes(CSS.escape(x.animationName));if(x.target===s&&S&&(u("ANIMATION_END"),!o.current)){const E=s.style.animationFillMode;s.style.animationFillMode="forwards",c=h.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=E)})}},m=x=>{x.target===s&&(a.current=pe(n.current))};return s.addEventListener("animationstart",m),s.addEventListener("animationcancel",f),s.addEventListener("animationend",f),()=>{h.clearTimeout(c),s.removeEventListener("animationstart",m),s.removeEventListener("animationcancel",f),s.removeEventListener("animationend",f)}}else u("ANIMATION_END")},[s,u]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:l.useCallback(c=>{n.current=c?getComputedStyle(c):null,r(c)},[])}}function pe(t){return t?.animationName||"none"}function us(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function Z(t,s,{checkForDefaultPrevented:r=!0}={}){return function(o){if(t?.(o),r===!1||!o.defaultPrevented)return s?.(o)}}function ms(t,s){return l.useReducer((r,n)=>s[r][n]??r,t)}var Ie="ScrollArea",[Pt,pn]=or(Ie),[fs,F]=Pt(Ie),$t=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,type:n="hover",dir:o,scrollHideDelay:a=600,...d}=t,[i,u]=l.useState(null),[c,h]=l.useState(null),[f,m]=l.useState(null),[x,p]=l.useState(null),[S,E]=l.useState(null),[P,A]=l.useState(0),[O,$]=l.useState(0),[V,z]=l.useState(!1),[C,T]=l.useState(!1),y=K(s,R=>u(R)),_=mr(o);return e.jsx(fs,{scope:r,type:n,dir:_,scrollHideDelay:a,scrollArea:i,viewport:c,onViewportChange:h,content:f,onContentChange:m,scrollbarX:x,onScrollbarXChange:p,scrollbarXEnabled:V,onScrollbarXEnabledChange:z,scrollbarY:S,onScrollbarYChange:E,scrollbarYEnabled:C,onScrollbarYEnabledChange:T,onCornerWidthChange:A,onCornerHeightChange:$,children:e.jsx(de.div,{dir:_,...d,ref:y,style:{position:"relative","--radix-scroll-area-corner-width":P+"px","--radix-scroll-area-corner-height":O+"px",...t.style}})})});$t.displayName=Ie;var kt="ScrollAreaViewport",Mt=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,children:n,nonce:o,...a}=t,d=F(kt,r),i=l.useRef(null),u=K(s,i,d.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),e.jsx(de.div,{"data-radix-scroll-area-viewport":"",...a,ref:u,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});Mt.displayName=kt;var U="ScrollAreaScrollbar",De=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,o=F(U,t.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:d}=o,i=t.orientation==="horizontal";return l.useEffect(()=>(i?a(!0):d(!0),()=>{i?a(!1):d(!1)}),[i,a,d]),o.type==="hover"?e.jsx(hs,{...n,ref:s,forceMount:r}):o.type==="scroll"?e.jsx(xs,{...n,ref:s,forceMount:r}):o.type==="auto"?e.jsx(It,{...n,ref:s,forceMount:r}):o.type==="always"?e.jsx(Oe,{...n,ref:s}):null});De.displayName=U;var hs=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,o=F(U,t.__scopeScrollArea),[a,d]=l.useState(!1);return l.useEffect(()=>{const i=o.scrollArea;let u=0;if(i){const c=()=>{window.clearTimeout(u),d(!0)},h=()=>{u=window.setTimeout(()=>d(!1),o.scrollHideDelay)};return i.addEventListener("pointerenter",c),i.addEventListener("pointerleave",h),()=>{window.clearTimeout(u),i.removeEventListener("pointerenter",c),i.removeEventListener("pointerleave",h)}}},[o.scrollArea,o.scrollHideDelay]),e.jsx(ue,{present:r||a,children:e.jsx(It,{"data-state":a?"visible":"hidden",...n,ref:s})})}),xs=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,o=F(U,t.__scopeScrollArea),a=t.orientation==="horizontal",d=_e(()=>u("SCROLL_END"),100),[i,u]=ms("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return l.useEffect(()=>{if(i==="idle"){const c=window.setTimeout(()=>u("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(c)}},[i,o.scrollHideDelay,u]),l.useEffect(()=>{const c=o.viewport,h=a?"scrollLeft":"scrollTop";if(c){let f=c[h];const m=()=>{const x=c[h];f!==x&&(u("SCROLL"),d()),f=x};return c.addEventListener("scroll",m),()=>c.removeEventListener("scroll",m)}},[o.viewport,a,u,d]),e.jsx(ue,{present:r||i!=="hidden",children:e.jsx(Oe,{"data-state":i==="hidden"?"hidden":"visible",...n,ref:s,onPointerEnter:Z(t.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:Z(t.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),It=l.forwardRef((t,s)=>{const r=F(U,t.__scopeScrollArea),{forceMount:n,...o}=t,[a,d]=l.useState(!1),i=t.orientation==="horizontal",u=_e(()=>{if(r.viewport){const c=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;d(i?c:h)}},10);return re(r.viewport,u),re(r.content,u),e.jsx(ue,{present:n||a,children:e.jsx(Oe,{"data-state":a?"visible":"hidden",...o,ref:s})})}),Oe=l.forwardRef((t,s)=>{const{orientation:r="vertical",...n}=t,o=F(U,t.__scopeScrollArea),a=l.useRef(null),d=l.useRef(0),[i,u]=l.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=Wt(i.viewport,i.content),h={...n,sizes:i,onSizesChange:u,hasThumb:c>0&&c<1,onThumbChange:m=>a.current=m,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:m=>d.current=m};function f(m,x){return ys(m,d.current,i,x)}return r==="horizontal"?e.jsx(ps,{...h,ref:s,onThumbPositionChange:()=>{if(o.viewport&&a.current){const m=o.viewport.scrollLeft,x=st(m,i,o.dir);a.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:m=>{o.viewport&&(o.viewport.scrollLeft=m)},onDragScroll:m=>{o.viewport&&(o.viewport.scrollLeft=f(m,o.dir))}}):r==="vertical"?e.jsx(gs,{...h,ref:s,onThumbPositionChange:()=>{if(o.viewport&&a.current){const m=o.viewport.scrollTop,x=st(m,i);a.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:m=>{o.viewport&&(o.viewport.scrollTop=m)},onDragScroll:m=>{o.viewport&&(o.viewport.scrollTop=f(m))}}):null}),ps=l.forwardRef((t,s)=>{const{sizes:r,onSizesChange:n,...o}=t,a=F(U,t.__scopeScrollArea),[d,i]=l.useState(),u=l.useRef(null),c=K(s,u,a.onScrollbarXChange);return l.useEffect(()=>{u.current&&i(getComputedStyle(u.current))},[u]),e.jsx(Ot,{"data-orientation":"horizontal",...o,ref:c,sizes:r,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Ne(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,f)=>{if(a.viewport){const m=a.viewport.scrollLeft+h.deltaX;t.onWheelScroll(m),Vt(m,f)&&h.preventDefault()}},onResize:()=>{u.current&&a.viewport&&d&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:Se(d.paddingLeft),paddingEnd:Se(d.paddingRight)}})}})}),gs=l.forwardRef((t,s)=>{const{sizes:r,onSizesChange:n,...o}=t,a=F(U,t.__scopeScrollArea),[d,i]=l.useState(),u=l.useRef(null),c=K(s,u,a.onScrollbarYChange);return l.useEffect(()=>{u.current&&i(getComputedStyle(u.current))},[u]),e.jsx(Ot,{"data-orientation":"vertical",...o,ref:c,sizes:r,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Ne(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,f)=>{if(a.viewport){const m=a.viewport.scrollTop+h.deltaY;t.onWheelScroll(m),Vt(m,f)&&h.preventDefault()}},onResize:()=>{u.current&&a.viewport&&d&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:Se(d.paddingTop),paddingEnd:Se(d.paddingBottom)}})}})}),[bs,Dt]=Pt(U),Ot=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:o,onThumbChange:a,onThumbPointerUp:d,onThumbPointerDown:i,onThumbPositionChange:u,onDragScroll:c,onWheelScroll:h,onResize:f,...m}=t,x=F(U,r),[p,S]=l.useState(null),E=K(s,y=>S(y)),P=l.useRef(null),A=l.useRef(""),O=x.viewport,$=n.content-n.viewport,V=X(h),z=X(u),C=_e(f,10);function T(y){if(P.current){const _=y.clientX-P.current.left,R=y.clientY-P.current.top;c({x:_,y:R})}}return l.useEffect(()=>{const y=_=>{const R=_.target;p?.contains(R)&&V(_,$)};return document.addEventListener("wheel",y,{passive:!1}),()=>document.removeEventListener("wheel",y,{passive:!1})},[O,p,$,V]),l.useEffect(z,[n,z]),re(p,C),re(x.content,C),e.jsx(bs,{scope:r,scrollbar:p,hasThumb:o,onThumbChange:X(a),onThumbPointerUp:X(d),onThumbPositionChange:z,onThumbPointerDown:X(i),children:e.jsx(de.div,{...m,ref:E,style:{position:"absolute",...m.style},onPointerDown:Z(t.onPointerDown,y=>{y.button===0&&(y.target.setPointerCapture(y.pointerId),P.current=p.getBoundingClientRect(),A.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),T(y))}),onPointerMove:Z(t.onPointerMove,T),onPointerUp:Z(t.onPointerUp,y=>{const _=y.target;_.hasPointerCapture(y.pointerId)&&_.releasePointerCapture(y.pointerId),document.body.style.webkitUserSelect=A.current,x.viewport&&(x.viewport.style.scrollBehavior=""),P.current=null})})})}),ye="ScrollAreaThumb",Ft=l.forwardRef((t,s)=>{const{forceMount:r,...n}=t,o=Dt(ye,t.__scopeScrollArea);return e.jsx(ue,{present:r||o.hasThumb,children:e.jsx(vs,{ref:s,...n})})}),vs=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,style:n,...o}=t,a=F(ye,r),d=Dt(ye,r),{onThumbPositionChange:i}=d,u=K(s,f=>d.onThumbChange(f)),c=l.useRef(void 0),h=_e(()=>{c.current&&(c.current(),c.current=void 0)},100);return l.useEffect(()=>{const f=a.viewport;if(f){const m=()=>{if(h(),!c.current){const x=Ss(f,i);c.current=x,i()}};return i(),f.addEventListener("scroll",m),()=>f.removeEventListener("scroll",m)}},[a.viewport,h,i]),e.jsx(de.div,{"data-state":d.hasThumb?"visible":"hidden",...o,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:Z(t.onPointerDownCapture,f=>{const x=f.target.getBoundingClientRect(),p=f.clientX-x.left,S=f.clientY-x.top;d.onThumbPointerDown({x:p,y:S})}),onPointerUp:Z(t.onPointerUp,d.onThumbPointerUp)})});Ft.displayName=ye;var Fe="ScrollAreaCorner",zt=l.forwardRef((t,s)=>{const r=F(Fe,t.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?e.jsx(js,{...t,ref:s}):null});zt.displayName=Fe;var js=l.forwardRef((t,s)=>{const{__scopeScrollArea:r,...n}=t,o=F(Fe,r),[a,d]=l.useState(0),[i,u]=l.useState(0),c=!!(a&&i);return re(o.scrollbarX,()=>{const h=o.scrollbarX?.offsetHeight||0;o.onCornerHeightChange(h),u(h)}),re(o.scrollbarY,()=>{const h=o.scrollbarY?.offsetWidth||0;o.onCornerWidthChange(h),d(h)}),c?e.jsx(de.div,{...n,ref:s,style:{width:a,height:i,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Se(t){return t?parseInt(t,10):0}function Wt(t,s){const r=t/s;return isNaN(r)?0:r}function Ne(t){const s=Wt(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=(t.scrollbar.size-r)*s;return Math.max(n,18)}function ys(t,s,r,n="ltr"){const o=Ne(r),a=o/2,d=s||a,i=o-d,u=r.scrollbar.paddingStart+d,c=r.scrollbar.size-r.scrollbar.paddingEnd-i,h=r.content-r.viewport,f=n==="ltr"?[0,h]:[h*-1,0];return Ut([u,c],f)(t)}function st(t,s,r="ltr"){const n=Ne(s),o=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,a=s.scrollbar.size-o,d=s.content-s.viewport,i=a-n,u=r==="ltr"?[0,d]:[d*-1,0],c=fr(t,u);return Ut([0,d],[0,i])(c)}function Ut(t,s){return r=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const n=(s[1]-s[0])/(t[1]-t[0]);return s[0]+n*(r-t[0])}}function Vt(t,s){return t>0&&t<s}var Ss=(t,s=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},n=0;return function o(){const a={left:t.scrollLeft,top:t.scrollTop},d=r.left!==a.left,i=r.top!==a.top;(d||i)&&s(),r=a,n=window.requestAnimationFrame(o)}(),()=>window.cancelAnimationFrame(n)};function _e(t,s){const r=X(t),n=l.useRef(0);return l.useEffect(()=>()=>window.clearTimeout(n.current),[]),l.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,s)},[r,s])}function re(t,s){const r=X(s);te(()=>{let n=0;if(t){const o=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return o.observe(t),()=>{window.cancelAnimationFrame(n),o.unobserve(t)}}},[t,r])}var Bt=$t,ws=Mt,Ns=zt;const Ht=l.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(Bt,{ref:n,className:se("relative overflow-hidden",t),...r,children:[e.jsx(ws,{className:"h-full w-full rounded-[inherit]",children:s}),e.jsx(Yt,{}),e.jsx(Ns,{})]}));Ht.displayName=Bt.displayName;const Yt=l.forwardRef(({className:t,orientation:s="vertical",...r},n)=>e.jsx(De,{ref:n,orientation:s,className:se("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:e.jsx(Ft,{className:"relative flex-1 rounded-full bg-border"})}));Yt.displayName=De.displayName;var _s=Symbol.for("react.lazy"),we=it[" use ".trim().toString()];function Cs(t){return typeof t=="object"&&t!==null&&"then"in t}function Xt(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===_s&&"_payload"in t&&Cs(t._payload)}function As(t){const s=Ts(t),r=l.forwardRef((n,o)=>{let{children:a,...d}=n;Xt(a)&&typeof we=="function"&&(a=we(a._payload));const i=l.Children.toArray(a),u=i.find(Ls);if(u){const c=u.props.children,h=i.map(f=>f===u?l.Children.count(c)>1?l.Children.only(null):l.isValidElement(c)?c.props.children:null:f);return e.jsx(s,{...d,ref:o,children:l.isValidElement(c)?l.cloneElement(c,void 0,h):null})}return e.jsx(s,{...d,ref:o,children:a})});return r.displayName=`${t}.Slot`,r}function Ts(t){const s=l.forwardRef((r,n)=>{let{children:o,...a}=r;if(Xt(o)&&typeof we=="function"&&(o=we(o._payload)),l.isValidElement(o)){const d=Ps(o),i=Rs(a,o.props);return o.type!==l.Fragment&&(i.ref=n?ct(n,d):d),l.cloneElement(o,i)}return l.Children.count(o)>1?l.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Es=Symbol("radix.slottable");function Ls(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Es}function Rs(t,s){const r={...s};for(const n in s){const o=t[n],a=s[n];/^on[A-Z]/.test(n)?o&&a?r[n]=(...i)=>{const u=a(...i);return o(...i),u}:o&&(r[n]=o):n==="style"?r[n]={...o,...a}:n==="className"&&(r[n]=[o,a].filter(Boolean).join(" "))}return{...t,...r}}function Ps(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var $s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ks=$s.reduce((t,s)=>{const r=As(`Primitive.${s}`),n=l.forwardRef((o,a)=>{const{asChild:d,...i}=o,u=d?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(u,{...i,ref:a})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{}),Ms="Separator",nt="horizontal",Is=["horizontal","vertical"],qt=l.forwardRef((t,s)=>{const{decorative:r,orientation:n=nt,...o}=t,a=Ds(n)?n:nt,i=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return e.jsx(ks.div,{"data-orientation":a,...i,...o,ref:s})});qt.displayName=Ms;function Ds(t){return Is.includes(t)}var Gt=qt;const Qt=l.forwardRef(({className:t,orientation:s="horizontal",decorative:r=!0,...n},o)=>e.jsx(Gt,{ref:o,decorative:r,orientation:s,className:se("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));Qt.displayName=Gt.displayName;const ot=t=>{if(!t)return"";const[s,r]=t.split(":"),n=new Date;return n.setHours(parseInt(s),parseInt(r)),n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},Os=(t,s)=>{if(!t||!s)return"";const r=new Date(`1970-01-01T${t}`),o=new Date(`1970-01-01T${s}`).getTime()-r.getTime(),a=Math.round(o/6e4),d=Math.floor(a/60),i=a%60;return d>0&&i>0?`${d} hr ${i} mins`:d>0?`${d} hr${d>1?"s":""}`:`${i} mins`},at={Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6,Sunday:7};function Fs({facultyId:t,onDataLoaded:s}){const[r,n]=l.useState([]),[o,a]=l.useState(!0),[d,i]=l.useState(!1),u=new Date().toLocaleDateString("en-US",{weekday:"long"});l.useEffect(()=>{(async()=>{if(t){a(!0),i(!1);try{const x=localStorage.getItem("accessToken"),p=await I.get(`faculty-loading/${t}/schedules`,{headers:{Authorization:`Bearer ${x}`}});if(p.data.success){const S=p.data.data;n(S),s&&s(S.length)}}catch(x){console.error("Error fetching schedules",x),i(!0)}finally{a(!1)}}})()},[t]);const c=l.useMemo(()=>{const m=new Map;return Object.keys(at).forEach(x=>m.set(x,[])),r.forEach(x=>{const p=x.day;m.has(p)&&m.get(p).push(x)}),m.forEach(x=>{x.sort((p,S)=>p.start_time.localeCompare(S.start_time))}),m},[r]),h=Object.keys(at).filter(m=>m!=="Sunday"),f=h.includes(u)?u:"Monday";return o?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-2 text-muted-foreground",children:[e.jsx(G,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{children:"Loading schedule..."})]}):d?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-destructive p-6 text-center",children:[e.jsx(jr,{className:"h-10 w-10 mb-2"}),e.jsx("p",{className:"font-medium",children:"Failed to load schedule."})]}):e.jsx("div",{className:"h-full flex flex-col bg-muted/10 rounded-lg overflow-hidden border",children:e.jsxs(hr,{defaultValue:f,className:"flex-1 flex flex-col h-full w-full",children:[e.jsx("div",{className:"bg-background border-b px-2 pt-2",children:e.jsx(xr,{className:"w-full justify-start h-auto p-0 bg-transparent gap-2 overflow-x-auto no-scrollbar pb-2",children:h.map(m=>{const x=c.get(m)?.length||0,p=x>0;return e.jsxs(pr,{value:m,className:`
                                        flex flex-col gap-1 rounded-md border px-4 py-2 min-w-[90px] transition-all
                                        data-[state=active]:border-primary data-[state=active]:bg-primary/5
                                        ${p?"":"opacity-60"}
                                    `,children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-muted-foreground",children:m.substring(0,3)}),e.jsx("span",{className:`text-lg font-bold ${p?"text-primary":"text-muted-foreground"}`,children:x})]},m)})})}),e.jsx("div",{className:"flex-1 bg-muted/5 relative",children:h.map(m=>{const x=c.get(m)||[];return e.jsx(gr,{value:m,className:"h-full m-0 absolute inset-0",children:e.jsx(Ht,{className:"h-full px-4 py-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 pb-10",children:[e.jsxs("div",{className:"mb-4 pl-1 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-lg font-semibold text-foreground",children:[m," Schedule"]}),e.jsxs(ie,{variant:"outline",className:"text-muted-foreground",children:[x.length," ",x.length===1?"Subject":"Subjects"]})]}),x.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center opacity-60",children:[e.jsx(yr,{className:"h-14 w-14 mb-4 text-muted-foreground/30"}),e.jsx("p",{className:"font-medium",children:"No classes scheduled."})]}):e.jsx("div",{className:"grid gap-4",children:x.map(p=>e.jsx(zs,{sched:p},p.id))})]})})},m)})})]})})}function zs({sched:t}){const s=t.type==="LEC",r=s?{border:"border-l-blue-500",bg:"bg-blue-50/40",badge:"bg-blue-100 hover:bg-blue-200 text-blue-800"}:{border:"border-l-amber-500",bg:"bg-amber-50/40",badge:"bg-amber-100 hover:bg-amber-200 text-amber-800"},n=s?Sr:wr,o=Os(t.start_time,t.end_time);return e.jsx(br,{className:`overflow-hidden shadow-sm hover:shadow-md transition-shadow border-l-[6px] ${r.border}`,children:e.jsxs(vr,{className:"p-0 flex flex-col sm:flex-row",children:[e.jsxs("div",{className:`p-4 flex flex-col justify-center items-center sm:w-36 border-b sm:border-b-0 sm:border-r ${r.bg}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"block text-lg font-bold text-foreground leading-none",children:ot(t.start_time)}),e.jsx("span",{className:"text-[10px] text-muted-foreground font-medium my-1 block",children:"to"}),e.jsx("span",{className:"block text-sm font-medium text-muted-foreground leading-none",children:ot(t.end_time)})]}),e.jsx(Qt,{className:"my-3 w-12 bg-black/10"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-muted-foreground",children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{children:o})]})]}),e.jsxs("div",{className:"flex-1 p-4 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-start gap-2 mb-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground tracking-tight uppercase",children:t.subject.subject_code}),e.jsxs(ie,{variant:"secondary",className:`${r.badge} border-none`,children:[e.jsx(n,{className:"h-3 w-3 mr-1"}),t.type==="LEC"?"Lecture":"Laboratory"]})]})}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t.subject.des_title})]}),e.jsx("div",{className:"mt-4 pt-3 border-t flex flex-wrap items-center gap-x-6 gap-y-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted p-1.5 rounded-md",children:e.jsx(Nr,{className:"h-4 w-4 text-foreground/70"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-muted-foreground leading-tight",children:"Room"}),e.jsx("span",{className:"text-sm font-bold text-foreground",children:t.room.roomNumber})]})]})})]})]})})}function Ws({isOpen:t,onClose:s,faculty:r}){const[n,o]=l.useState(0);if(!r)return null;const a=u=>u.split(" ").map(c=>c[0]).join("").toUpperCase().substring(0,2),d=u=>u?u.startsWith("http")||u.startsWith("data:")?u:`https://green-deer-882383.hostingersite.com/${u}`:"",i=u=>{o(u)};return e.jsx(mt,{open:t,onOpenChange:s,children:e.jsxs(ft,{className:"sm:max-w-3xl h-[85vh] flex flex-col p-0 gap-0 overflow-hidden border-0 shadow-2xl",children:[e.jsx(ht,{className:"px-6 py-6 border-b bg-muted/20",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(Et,{className:"h-20 w-20 border-4 border-background shadow-lg ring-1 ring-muted",children:[e.jsx(Lt,{src:d(r.profile_picture),alt:r.name,className:"object-cover"}),e.jsx(Rt,{className:"bg-gradient-to-br from-blue-500 to-indigo-600 text-white text-lg font-bold",children:a(r.name)})]}),e.jsx("span",{className:"absolute bottom-1 right-1 h-4 w-4 rounded-full bg-emerald-500 ring-2 ring-white"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(xt,{className:"text-2xl font-bold tracking-tight text-foreground",children:r.name}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5 bg-background px-2.5 py-1 rounded-md border shadow-sm",children:[e.jsx(dt,{className:"h-3.5 w-3.5 text-blue-500"}),"Faculty Member"]}),e.jsxs("span",{className:"flex items-center gap-1.5 bg-background px-2.5 py-1 rounded-md border shadow-sm",children:[e.jsx(ut,{className:"h-3.5 w-3.5 text-amber-500"}),e.jsx("span",{className:"font-semibold text-foreground",children:n})," Total Subjects Assigned"]})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-background",children:e.jsx(Fs,{facultyId:r.id,onDataLoaded:i})}),e.jsxs(pt,{className:"px-6 py-4 border-t bg-muted/10 flex items-center justify-between sm:justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground italic",children:"* Schedule is subject to changes by the department head."}),e.jsx(gt,{asChild:!0,children:e.jsx(Q,{variant:"outline",className:"px-6",children:"Close"})})]})]})})}const lt=[{bg:"bg-blue-100",text:"text-blue-800"},{bg:"bg-emerald-100",text:"text-emerald-800"},{bg:"bg-amber-100",text:"text-amber-800"},{bg:"bg-rose-100",text:"text-rose-800"},{bg:"bg-indigo-100",text:"text-indigo-800"},{bg:"bg-cyan-100",text:"text-cyan-800"},{bg:"bg-pink-100",text:"text-pink-800"}];function Us(t){let s=0;const r=(t||"").toLowerCase();for(let o=0;o<r.length;o++)s=(s<<5)-s+r.charCodeAt(o),s|=0;const n=Math.abs(s)%lt.length;return lt[n]}function Vs({data:t,onAssignClick:s,onViewSubjectsClick:r}){return t.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 gap-6",children:t.map(n=>{const o=n.profile_picture?n.profile_picture.startsWith("http")?n.profile_picture:`https://green-deer-882383.hostingersite.com/${n.profile_picture}`:null,d=n.overload_units>0?"overloaded":"ok",u={overloaded:{label:"Overload",icon:Qe,text:"text-red-700",bg:"bg-red-50",ring:"ring-1 ring-red-200",dot:"bg-red-500"},ok:{label:"Teaching",icon:Er,text:"text-emerald-700",bg:"bg-emerald-50",ring:"ring-1 ring-emerald-200",dot:"bg-emerald-500"}}[d],c=u.icon;return e.jsxs("div",{className:`relative overflow-hidden rounded-2xl border bg-white p-5 shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5 ${u.ring}`,children:[e.jsx("div",{className:"pointer-events-none absolute -right-16 -top-16 h-40 w-40 rounded-full bg-gradient-to-br from-primary/15 to-indigo-100 blur-2xl"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative",children:[o?e.jsx("img",{src:o,alt:n.name,className:"h-16 w-16 rounded-full object-cover border-4 border-white shadow-md ring-2 ring-primary/20"}):e.jsx("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-indigo-500 to-violet-500 text-white grid place-items-center text-lg font-bold border-4 border-white shadow-md ring-2 ring-primary/20",children:e.jsx(dt,{className:"w-7 h-7 opacity-90"})}),e.jsx("span",{className:`absolute -bottom-1 -right-1 h-3.5 w-3.5 rounded-full ring-2 ring-white ${u.dot}`})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"truncate text-lg font-bold text-foreground",children:n.name}),e.jsxs("div",{className:`ml-2 inline-flex items-center gap-1.5 rounded-full px-2 py-0.5 text-[11px] font-semibold ${u.bg} ${u.text}`,children:[e.jsx(c,{size:12}),e.jsx("span",{children:u.label})]})]}),e.jsx("div",{className:"mt-1",children:e.jsx(ie,{variant:"secondary",className:"text-[10px] px-2 py-0 font-normal text-muted-foreground border-slate-200",children:n.department})}),n.expertise?.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-1.5",children:n.expertise.slice(0,3).map((h,f)=>{const m=Us(h);return e.jsx(ie,{className:`text-[10px] px-2 py-0.5 ${m.bg} hover:${m.bg} ${m.text} border-0`,children:h},`${h}-${f}`)})})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center p-3 rounded-xl bg-blue-50/50 border border-blue-100 text-center",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-blue-600 mb-1",children:[e.jsx(ut,{size:14}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide",children:"Teaching"})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-2xl font-bold text-blue-900 leading-none",children:n.t_load_units||0}),e.jsx("span",{className:"block text-[10px] font-medium text-blue-600/70 mt-0.5",children:"Units"})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-3 rounded-xl bg-amber-50/50 border border-amber-100 text-center",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-amber-600 mb-1",children:[e.jsx(Ar,{size:14}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide",children:"Deload"})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-2xl font-bold text-amber-900 leading-none",children:n.deload_units||0}),e.jsx("span",{className:"block text-[10px] font-medium text-amber-600/70 mt-0.5",children:"Units"})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-3 rounded-xl bg-red-50/50 border border-red-100 text-center",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-red-600 mb-1",children:[e.jsx(Qe,{size:14}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide",children:"Overload"})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"text-2xl font-bold text-red-900 leading-none",children:n.overload_units||0}),e.jsx("span",{className:"block text-[10px] font-medium text-red-600/70 mt-0.5",children:"Units"})]})]})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2 border-t pt-4",children:[e.jsxs(Q,{size:"sm",onClick:()=>s(n),className:"shadow-sm h-8",children:[e.jsx(_r,{className:"mr-2 h-3.5 w-3.5"})," Assign"]}),e.jsxs(Q,{size:"sm",variant:"outline",onClick:()=>r(n),className:"h-8",children:[e.jsx($r,{className:"mr-2 h-3.5 w-3.5"})," View Schedule"]})]})]},n.id)})}):e.jsx("div",{className:"flex items-center justify-center h-48 text-muted-foreground",children:"No faculty found."})}function Bs(){const[t,s]=l.useState([]),[r,n]=l.useState([]),[o,a]=l.useState([]),[d,i]=l.useState(""),[u,c]=l.useState(!0),[h,f]=l.useState(!1),[m,x]=l.useState(null),[p,S]=l.useState(!1),[E,P]=l.useState(null);l.useEffect(()=>{(async()=>{c(!0);try{const y=localStorage.getItem("accessToken");if(!y){Ge.fire({icon:"warning",title:"Authentication Error",text:"You must be logged in."}),c(!1);return}const _={headers:{Authorization:`Bearer ${y}`}},[R,B]=await Promise.all([I.get("/faculties",_),I.get("/get-subjects",_)]),J=R.data.faculties.map(M=>({id:M.id,name:M.user.name,department:M.department||"No Department",expertise:M.expertises?M.expertises.map(W=>W.list_of_expertise):[],profile_picture:M.profile_picture,t_load_units:M.t_load_units??0,deload_units:M.deload_units??0,overload_units:M.overload_units??0,availability:{},assignedSubjects:[]}));s(J),n(B.data.subject||[])}catch(y){console.error("Error fetching data:",y),Ge.fire({icon:"error",title:"Fetch Error",text:"Failed to retrieve data from the server."})}finally{c(!1)}})()},[]);const A=t.filter(T=>T.name.toLowerCase().includes(d.toLowerCase())||T.expertise.some(y=>y.toLowerCase().includes(d.toLowerCase()))),O=T=>{const y=T.expertise.map(_=>(_||"").toLowerCase().trim()).filter(Boolean).flatMap(_=>_.split(/\s+|[,;/]+/).map(R=>R.trim())).filter(_=>_.length>2);if(!y.length)a([]);else{const _=r.filter(R=>{const B=`${R.des_title??""} ${R.subject_code??""} ${R.pre_requisite??""}`.toLowerCase();return y.some(J=>B.includes(J))});a(_)}x(T),f(!0)},$=()=>{f(!1),x(null),a([])},V=T=>{P(T),S(!0)},z=()=>{S(!1),P(null)},C=(T,y,_)=>{console.log("Assigning Subject:",{facultyId:T,subjectId:y,schedules:_})};return e.jsxs(e.Fragment,{children:[e.jsxs(ar,{children:[h&&m&&e.jsx(Vr,{isOpen:h,onClose:$,faculty:m,availableSubjects:o,onAssign:C}),p&&E&&e.jsx(Ws,{isOpen:p,onClose:z,faculty:E})]}),e.jsxs("header",{className:"mb-8 text-start",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground tracking-tight",children:"Faculty Loading"}),e.jsx("p",{className:"text-muted-foreground mt-3 ",children:"Assign subjects to faculty based on expertise and availability."})]}),e.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-sm border border-border",children:[e.jsx("div",{className:"flex justify-start mb-8",children:e.jsxs("div",{className:"relative w-full md:max-w-lg",children:[e.jsx(bt,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(be,{placeholder:"Search by faculty name or expertise...",value:d,onChange:T=>i(T.target.value),className:"pl-12 h-12 rounded-full text-base"})]})}),u?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Array.from({length:6}).map((T,y)=>e.jsx(Mr,{},y))}):A.length>0?e.jsx(Vs,{data:A,onAssignClick:O,onViewSubjectsClick:V}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center text-muted-foreground bg-muted/50 rounded-lg border-2 border-dashed",children:[e.jsx(Rr,{size:40,className:"mb-4 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"No Faculty Found"}),e.jsxs("p",{children:['Your search for "',d,'" did not match any faculty profiles.']})]})]})]})}function gn(){return e.jsx("main",{children:e.jsx(Bs,{})})}export{gn as default};
