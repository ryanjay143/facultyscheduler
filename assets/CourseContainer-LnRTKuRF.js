import{c as Be,j as e,m as bt,b as qt,f as wr,B as q,R as b,r as u,i as Te,t as _,a as de,T as Sr,s as Rt,v as Dt,w as It,q as Bt,x as Nr,h as Cr,P as Ut,y as Tr,u as Lr,A as Er}from"./index-D-mCsc05.js";import{I as W}from"./input-WdzOX4yL.js";import{S as Le,a as Ee,b as Ae,c as _e,d as ge,u as Ar}from"./select-Xu_IC8vo.js";import{S as Ie,C as _r,T as kr,g as Rr,R as Dr,P as Ir,h as Pr,O as Or,D as Oe,a as $e,b as Me,c as Fe,d as lt,e as ze,f as He}from"./dialog-ClZw9g1P.js";import{B as $r}from"./book-copy-D-PhtI3z.js";import{S as vt}from"./square-pen-DrgQm7HW.js";import{T as Tt,P as Lt}from"./trash-2-DMn9QGXq.js";import{T as jt,a as yt,b as ie,c as Y,d as wt,e as k,f as St}from"./table-k-Jfn7D_.js";import{B as mt}from"./badge-pVb_z3Pi.js";import{C as Mr}from"./calendar-days-K8lzIaNJ.js";import{L as Pt}from"./layers-Zz84WfB-.js";import{L as X}from"./label-C4TF9PIB.js";import{L as Et}from"./loader-circle-qJ_8jGOU.js";import{C as Ot}from"./circle-alert-DX0R_umE.js";import{S as Fr}from"./search-Cz4LFRIi.js";import"./Combination-BEZVJ90C.js";import"./check-Vx4rEt9t.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Hr=Be("activity",zr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],qr=Be("archive-restore",Yr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ur=Be("archive",Br);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=[["path",{d:"M12 21V7",key:"gj6g52"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V4a1 1 0 0 0-1-1h-5a4 4 0 0 0-4 4 4 4 0 0 0-4-4H3a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h6a3 3 0 0 1 3 3 3 3 0 0 1 3-3h6a1 1 0 0 0 1-1v-1.3",key:"8arnkb"}]],Wr=Be("book-open-check",Vr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Kr=Be("school",Xr);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],Gr=Be("sliders-horizontal",Jr),$t=["from-purple-600 to-indigo-600","from-blue-500 to-teal-400","from-pink-500 to-rose-500","from-orange-500 to-amber-500","from-green-500 to-lime-500","from-cyan-500 to-sky-500"],Qr={hidden:{opacity:0,y:20},visible:t=>({opacity:1,y:0,transition:{delay:t*.05}})};function Zr({program:t,index:s,onEdit:r,onArchive:a,onRestore:o,onManage:n}){const v=t.total_subjects,d=t.total_units,w=()=>e.jsxs(e.Fragment,{children:[e.jsx(q,{size:"icon",variant:"ghost",title:"Edit Program",onClick:y=>{y.stopPropagation(),r(t)},className:"h-8 w-8 bg-black/20 hover:bg-green-500",children:e.jsx(vt,{size:16})}),t.isActive?e.jsx(q,{size:"icon",variant:"ghost",title:"Archive Program",onClick:y=>{y.stopPropagation(),a(t.id)},className:"h-8 w-8 bg-black/20 hover:bg-destructive/80",children:e.jsx(Tt,{size:16})}):e.jsx(q,{size:"icon",variant:"ghost",title:"Restore Program",onClick:y=>{y.stopPropagation(),o(t.id)},className:"h-8 w-8 bg-black/20 hover:bg-green-500",children:e.jsx(qr,{size:16})})]});return e.jsxs(bt.div,{variants:Qr,custom:s,initial:"hidden",animate:"visible",exit:"hidden",className:"bg-card rounded-xl border border-border shadow-sm overflow-hidden group flex flex-col transition-all duration-300 hover:shadow-md hover:-translate-y-1",children:[e.jsxs("div",{className:`p-5 bg-gradient-to-br text-white relative ${$t[s%$t.length]} ${!t.isActive&&"opacity-60"}`,children:[e.jsx("h2",{className:"text-xl font-bold pr-20",children:t.abbreviation}),e.jsx("p",{className:"opacity-80 truncate text-sm pr-20",children:t.name}),!t.isActive&&e.jsx("div",{className:"absolute bottom-2 left-5 px-2.5 py-1 bg-red-600/90 text-white text-[10px] font-bold rounded-full uppercase tracking-wider",children:"Inactive"}),e.jsx("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(w,{})})]}),e.jsxs("div",{className:"p-5 flex-grow flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-4",children:[e.jsx(qt,{size:15}),e.jsxs("span",{children:["A.Y. ",t.effectiveYear]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center text-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx($r,{size:15,className:"text-muted-foreground"}),e.jsx("span",{children:"Total Subjects"})]}),e.jsx("span",{className:"px-2.5 py-0.5 bg-muted text-muted-foreground rounded-full font-semibold",children:v})]}),e.jsxs("div",{className:"flex justify-between items-center text-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(wr,{size:15,className:"text-muted-foreground"}),e.jsx("span",{children:"Total Units"})]}),e.jsx("span",{className:"px-2.5 py-0.5 bg-muted text-muted-foreground rounded-full font-semibold",children:d})]})]})]}),e.jsx(q,{onClick:n,className:"w-full mt-5",variant:"secondary",disabled:!t.isActive,children:"Manage Curriculum"})]})]})}function es(){return e.jsxs("div",{className:"bg-card rounded-xl border border-border shadow-sm p-5 space-y-4",children:[e.jsx(Ie,{className:"h-8 w-1/4"}),e.jsx(Ie,{className:"h-5 w-3/4"}),e.jsxs("div",{className:"pt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ie,{className:"h-5 w-1/2"}),e.jsx(Ie,{className:"h-6 w-10 rounded-full"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ie,{className:"h-5 w-1/2"}),e.jsx(Ie,{className:"h-6 w-10 rounded-full"})]})]}),e.jsx(Ie,{className:"h-10 w-full mt-5"})]})}function ts(t){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",s.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const Vt=b.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Ze=()=>{const t=b.useContext(Vt);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};ts(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function rs(){const t=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(t)&&/Mobile/.test(t)||/FxiOS/.test(t))}function ss(){return At(/^Mac/)}function ns(){return At(/^iPhone/)}function Mt(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function as(){return At(/^iPad/)||ss()&&navigator.maxTouchPoints>1}function Wt(){return ns()||as()}function At(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const os=24,is=typeof window<"u"?u.useLayoutEffect:u.useEffect;function Ft(...t){return(...s)=>{for(let r of t)typeof r=="function"&&r(...s)}}const ht=typeof document<"u"&&window.visualViewport;function zt(t){let s=window.getComputedStyle(t);return/(auto|scroll)/.test(s.overflow+s.overflowX+s.overflowY)}function Xt(t){for(zt(t)&&(t=t.parentElement);t&&!zt(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const ls=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let ot=0,ft;function cs(t={}){let{isDisabled:s}=t;is(()=>{if(!s)return ot++,ot===1&&Wt()&&(ft=us()),()=>{ot--,ot===0&&ft?.()}},[s])}function us(){let t,s=0,r=p=>{t=Xt(p.target),!(t===document.documentElement&&t===document.body)&&(s=p.changedTouches[0].pageY)},a=p=>{if(!t||t===document.documentElement||t===document.body){p.preventDefault();return}let m=p.changedTouches[0].pageY,I=t.scrollTop,S=t.scrollHeight-t.clientHeight;S!==0&&((I<=0&&m>s||I>=S&&m<s)&&p.preventDefault(),s=m)},o=p=>{let m=p.target;Nt(m)&&m!==document.activeElement&&(p.preventDefault(),m.style.transform="translateY(-2000px)",m.focus(),requestAnimationFrame(()=>{m.style.transform=""}))},n=p=>{let m=p.target;Nt(m)&&(m.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{m.style.transform="",ht&&(ht.height<window.innerHeight?requestAnimationFrame(()=>{Ht(m)}):ht.addEventListener("resize",()=>Ht(m),{once:!0}))}))},v=()=>{window.scrollTo(0,0)},d=window.pageXOffset,w=window.pageYOffset,y=Ft(ds(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let f=Ft(Je(document,"touchstart",r,{passive:!1,capture:!0}),Je(document,"touchmove",a,{passive:!1,capture:!0}),Je(document,"touchend",o,{passive:!1,capture:!0}),Je(document,"focus",n,!0),Je(window,"scroll",v));return()=>{y(),f(),window.scrollTo(d,w)}}function ds(t,s,r){let a=t.style[s];return t.style[s]=r,()=>{t.style[s]=a}}function Je(t,s,r,a){return t.addEventListener(s,r,a),()=>{t.removeEventListener(s,r,a)}}function Ht(t){let s=document.scrollingElement||document.documentElement;for(;t&&t!==s;){let r=Xt(t);if(r!==document.documentElement&&r!==document.body&&r!==t){let a=r.getBoundingClientRect().top,o=t.getBoundingClientRect().top,n=t.getBoundingClientRect().bottom;const v=r.getBoundingClientRect().bottom+os;n>v&&(r.scrollTop+=o-a)}t=r.parentElement}}function Nt(t){return t instanceof HTMLInputElement&&!ls.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function ms(t,s){typeof t=="function"?t(s):t!=null&&(t.current=s)}function hs(...t){return s=>t.forEach(r=>ms(r,s))}function Kt(...t){return u.useCallback(hs(...t),t)}const Jt=new WeakMap;function G(t,s,r=!1){if(!t||!(t instanceof HTMLElement))return;let a={};Object.entries(s).forEach(([o,n])=>{if(o.startsWith("--")){t.style.setProperty(o,n);return}a[o]=t.style[o],t.style[o]=n}),!r&&Jt.set(t,a)}function fs(t,s){if(!t||!(t instanceof HTMLElement))return;let r=Jt.get(t);r&&(t.style[s]=r[s])}const J=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function it(t,s){if(!t)return null;const r=window.getComputedStyle(t),a=r.transform||r.webkitTransform||r.mozTransform;let o=a.match(/^matrix3d\((.+)\)$/);return o?parseFloat(o[1].split(", ")[J(s)?13:12]):(o=a.match(/^matrix\((.+)\)$/),o?parseFloat(o[1].split(", ")[J(s)?5:4]):null)}function ps(t){return 8*(Math.log(t+1)-2)}function pt(t,s){if(!t)return()=>{};const r=t.style.cssText;return Object.assign(t.style,s),()=>{t.style.cssText=r}}function xs(...t){return(...s)=>{for(const r of t)typeof r=="function"&&r(...s)}}const V={DURATION:.5,EASE:[.32,.72,0,1]},Gt=.4,gs=.25,bs=100,Qt=8,Pe=16,Ct=26,xt="vaul-dragging";function Zt(t){const s=b.useRef(t);return b.useEffect(()=>{s.current=t}),b.useMemo(()=>(...r)=>s.current==null?void 0:s.current.call(s,...r),[])}function vs({defaultProp:t,onChange:s}){const r=b.useState(t),[a]=r,o=b.useRef(a),n=Zt(s);return b.useEffect(()=>{o.current!==a&&(n(a),o.current=a)},[a,o,n]),r}function er({prop:t,defaultProp:s,onChange:r=()=>{}}){const[a,o]=vs({defaultProp:s,onChange:r}),n=t!==void 0,v=n?t:a,d=Zt(r),w=b.useCallback(y=>{if(n){const p=typeof y=="function"?y(t):y;p!==t&&d(p)}else o(y)},[n,t,o,d]);return[v,w]}function js({activeSnapPointProp:t,setActiveSnapPointProp:s,snapPoints:r,drawerRef:a,overlayRef:o,fadeFromIndex:n,onSnapPointChange:v,direction:d="bottom",container:w,snapToSequentialPoint:y}){const[f,p]=er({prop:t,defaultProp:r?.[0],onChange:s}),[m,I]=b.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);b.useEffect(()=>{function c(){I({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]);const S=b.useMemo(()=>f===r?.[r.length-1]||null,[r,f]),C=b.useMemo(()=>{var c;return(c=r?.findIndex(l=>l===f))!=null?c:null},[r,f]),j=r&&r.length>0&&(n||n===0)&&!Number.isNaN(n)&&r[n]===f||!r,i=b.useMemo(()=>{const c=w?{width:w.getBoundingClientRect().width,height:w.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var l;return(l=r?.map(h=>{const R=typeof h=="string";let O=0;if(R&&(O=parseInt(h,10)),J(d)){const T=R?O:m?h*c.height:0;return m?d==="bottom"?c.height-T:-c.height+T:T}const $=R?O:m?h*c.width:0;return m?d==="right"?c.width-$:-c.width+$:$}))!=null?l:[]},[r,m,w]),x=b.useMemo(()=>C!==null?i?.[C]:null,[i,C]),N=b.useCallback(c=>{var l;const h=(l=i?.findIndex(R=>R===c))!=null?l:null;v(h),G(a.current,{transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,transform:J(d)?`translate3d(0, ${c}px, 0)`:`translate3d(${c}px, 0, 0)`}),i&&h!==i.length-1&&n!==void 0&&h!==n&&h<n?G(o.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,opacity:"0"}):G(o.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,opacity:"1"}),p(r?.[Math.max(h,0)])},[a.current,r,i,n,o,p]);b.useEffect(()=>{if(f||t){var c;const l=(c=r?.findIndex(h=>h===t||h===f))!=null?c:-1;i&&l!==-1&&typeof i[l]=="number"&&N(i[l])}},[f,t,r,i,N]);function g({draggedDistance:c,closeDrawer:l,velocity:h,dismissible:R}){if(n===void 0)return;const O=d==="bottom"||d==="right"?(x??0)-c:(x??0)+c,$=C===n-1,T=C===0,F=c>0;if($&&G(o.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`}),!y&&h>2&&!F){R?l():N(i[0]);return}if(!y&&h>2&&F&&i&&r){N(i[r.length-1]);return}const Q=i?.reduce((Z,le)=>typeof Z!="number"||typeof le!="number"?Z:Math.abs(le-O)<Math.abs(Z-O)?le:Z),re=J(d)?window.innerHeight:window.innerWidth;if(h>Gt&&Math.abs(c)<re*.4){const Z=F?1:-1;if(Z>0&&S&&r){N(i[r.length-1]);return}if(T&&Z<0&&R&&l(),C===null)return;N(i[C+Z]);return}N(Q)}function E({draggedDistance:c}){if(x===null)return;const l=d==="bottom"||d==="right"?x-c:x+c;(d==="bottom"||d==="right")&&l<i[i.length-1]||(d==="top"||d==="left")&&l>i[i.length-1]||G(a.current,{transform:J(d)?`translate3d(0, ${l}px, 0)`:`translate3d(${l}px, 0, 0)`})}function U(c,l){if(!r||typeof C!="number"||!i||n===void 0)return null;const h=C===n-1;if(C>=n&&l)return 0;if(h&&!l)return 1;if(!j&&!h)return null;const O=h?C+1:C-1,$=h?i[O]-i[O-1]:i[O+1]-i[O],T=c/Math.abs($);return h?1-T:T}return{isLastSnapPoint:S,activeSnapPoint:f,shouldFade:j,getPercentageDragged:U,setActiveSnapPoint:p,activeSnapPointIndex:C,onRelease:g,onDrag:E,snapPointsOffset:i}}const ys=()=>()=>{};function ws(){const{direction:t,isOpen:s,shouldScaleBackground:r,setBackgroundColorOnScale:a,noBodyStyles:o}=Ze(),n=b.useRef(null),v=u.useMemo(()=>document.body.style.backgroundColor,[]);function d(){return(window.innerWidth-Ct)/window.innerWidth}b.useEffect(()=>{if(s&&r){n.current&&clearTimeout(n.current);const w=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!w)return;xs(a&&!o?pt(document.body,{background:"black"}):ys,pt(w,{transformOrigin:J(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${V.DURATION}s`,transitionTimingFunction:`cubic-bezier(${V.EASE.join(",")})`}));const y=pt(w,{borderRadius:`${Qt}px`,overflow:"hidden",...J(t)?{transform:`scale(${d()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${d()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{y(),n.current=window.setTimeout(()=>{v?document.body.style.background=v:document.body.style.removeProperty("background")},V.DURATION*1e3)}}},[s,r,v])}let Ge=null;function Ss({isOpen:t,modal:s,nested:r,hasBeenOpened:a,preventScrollRestoration:o,noBodyStyles:n}){const[v,d]=b.useState(()=>typeof window<"u"?window.location.href:""),w=b.useRef(0),y=b.useCallback(()=>{if(Mt()&&Ge===null&&t&&!n){Ge={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:p,innerHeight:m}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-w.current}px`,left:`${-p}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const I=m-window.innerHeight;I&&w.current>=m&&(document.body.style.top=`${-(w.current+I)}px`)}),300)}},[t]),f=b.useCallback(()=>{if(Mt()&&Ge!==null&&!n){const p=-parseInt(document.body.style.top,10),m=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Ge),window.requestAnimationFrame(()=>{if(o&&v!==window.location.href){d(window.location.href);return}window.scrollTo(m,p)}),Ge=null}},[v]);return b.useEffect(()=>{function p(){w.current=window.scrollY}return p(),window.addEventListener("scroll",p),()=>{window.removeEventListener("scroll",p)}},[]),b.useEffect(()=>{if(s)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||f()}},[s,f]),b.useEffect(()=>{r||!a||(t?(!window.matchMedia("(display-mode: standalone)").matches&&y(),s||window.setTimeout(()=>{f()},500)):f())},[t,a,v,s,r,y,f]),{restorePositionSetting:f}}function Ns({open:t,onOpenChange:s,children:r,onDrag:a,onRelease:o,snapPoints:n,shouldScaleBackground:v=!1,setBackgroundColorOnScale:d=!0,closeThreshold:w=gs,scrollLockTimeout:y=bs,dismissible:f=!0,handleOnly:p=!1,fadeFromIndex:m=n&&n.length-1,activeSnapPoint:I,setActiveSnapPoint:S,fixed:C,modal:j=!0,onClose:i,nested:x,noBodyStyles:N=!1,direction:g="bottom",defaultOpen:E=!1,disablePreventScroll:U=!0,snapToSequentialPoint:c=!1,preventScrollRestoration:l=!1,repositionInputs:h=!0,onAnimationEnd:R,container:O,autoFocus:$=!1}){var T,F;const[Q=!1,re]=er({defaultProp:E,prop:t,onChange:A=>{s?.(A),!A&&!x&&ee(),setTimeout(()=>{R?.(A)},V.DURATION*1e3),A&&!j&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),A||(document.body.style.pointerEvents="auto")}}),[Z,le]=b.useState(!1),[se,ve]=b.useState(!1),[fe,et]=b.useState(!1),ye=b.useRef(null),Ye=b.useRef(null),Ue=b.useRef(null),Ve=b.useRef(null),ne=b.useRef(null),me=b.useRef(!1),ke=b.useRef(null),qe=b.useRef(0),we=b.useRef(!1),tt=b.useRef(!E),rt=b.useRef(0),D=b.useRef(null),st=b.useRef(((T=D.current)==null?void 0:T.getBoundingClientRect().height)||0),nt=b.useRef(((F=D.current)==null?void 0:F.getBoundingClientRect().width)||0),We=b.useRef(0),ut=b.useCallback(A=>{n&&A===P.length-1&&(Ye.current=new Date)},[]),{activeSnapPoint:dt,activeSnapPointIndex:Se,setActiveSnapPoint:Xe,onRelease:L,snapPointsOffset:P,onDrag:z,shouldFade:je,getPercentageDragged:Re}=js({snapPoints:n,activeSnapPointProp:I,setActiveSnapPointProp:S,drawerRef:D,fadeFromIndex:m,overlayRef:ye,onSnapPointChange:ut,direction:g,container:O,snapToSequentialPoint:c});cs({isDisabled:!Q||se||!j||fe||!Z||!h||!U});const{restorePositionSetting:ee}=Ss({isOpen:Q,modal:j,nested:x??!1,hasBeenOpened:Z,preventScrollRestoration:l,noBodyStyles:N});function pe(){return(window.innerWidth-Ct)/window.innerWidth}function te(A){var H,B;!f&&!n||D.current&&!D.current.contains(A.target)||(st.current=((H=D.current)==null?void 0:H.getBoundingClientRect().height)||0,nt.current=((B=D.current)==null?void 0:B.getBoundingClientRect().width)||0,ve(!0),Ue.current=new Date,Wt()&&window.addEventListener("touchend",()=>me.current=!1,{once:!0}),A.target.setPointerCapture(A.pointerId),qe.current=J(g)?A.pageY:A.pageX)}function ce(A,H){var B;let M=A;const K=(B=window.getSelection())==null?void 0:B.toString(),oe=D.current?it(D.current,g):null,ae=new Date;if(M.tagName==="SELECT"||M.hasAttribute("data-vaul-no-drag")||M.closest("[data-vaul-no-drag]"))return!1;if(g==="right"||g==="left")return!0;if(Ye.current&&ae.getTime()-Ye.current.getTime()<500)return!1;if(oe!==null&&(g==="bottom"?oe>0:oe<0))return!0;if(K&&K.length>0)return!1;if(ne.current&&ae.getTime()-ne.current.getTime()<y&&oe===0||H)return ne.current=ae,!1;for(;M;){if(M.scrollHeight>M.clientHeight){if(M.scrollTop!==0)return ne.current=new Date,!1;if(M.getAttribute("role")==="dialog")return!0}M=M.parentNode}return!0}function ue(A){if(D.current&&se){const H=g==="bottom"||g==="right"?1:-1,B=(qe.current-(J(g)?A.pageY:A.pageX))*H,M=B>0,K=n&&!f&&!M;if(K&&Se===0)return;const oe=Math.abs(B),ae=document.querySelector("[data-vaul-drawer-wrapper]"),Ne=g==="bottom"||g==="top"?st.current:nt.current;let he=oe/Ne;const De=Re(oe,M);if(De!==null&&(he=De),K&&he>=1||!me.current&&!ce(A.target,M))return;if(D.current.classList.add(xt),me.current=!0,G(D.current,{transition:"none"}),G(ye.current,{transition:"none"}),n&&z({draggedDistance:B}),M&&!n){const xe=ps(B),at=Math.min(xe*-1,0)*H;G(D.current,{transform:J(g)?`translate3d(0, ${at}px, 0)`:`translate3d(${at}px, 0, 0)`});return}const Ce=1-he;if((je||m&&Se===m-1)&&(a?.(A,he),G(ye.current,{opacity:`${Ce}`,transition:"none"},!0)),ae&&ye.current&&v){const xe=Math.min(pe()+he*(1-pe()),1),at=8-he*8,kt=Math.max(0,14-he*14);G(ae,{borderRadius:`${at}px`,transform:J(g)?`scale(${xe}) translate3d(0, ${kt}px, 0)`:`scale(${xe}) translate3d(${kt}px, 0, 0)`,transition:"none"},!0)}if(!n){const xe=oe*H;G(D.current,{transform:J(g)?`translate3d(0, ${xe}px, 0)`:`translate3d(${xe}px, 0, 0)`})}}}b.useEffect(()=>{window.requestAnimationFrame(()=>{tt.current=!0})},[]),b.useEffect(()=>{var A;function H(){if(!D.current||!h)return;const B=document.activeElement;if(Nt(B)||we.current){var M;const K=((M=window.visualViewport)==null?void 0:M.height)||0,oe=window.innerHeight;let ae=oe-K;const Ne=D.current.getBoundingClientRect().height||0,he=Ne>oe*.8;We.current||(We.current=Ne);const De=D.current.getBoundingClientRect().top;if(Math.abs(rt.current-ae)>60&&(we.current=!we.current),n&&n.length>0&&P&&Se){const Ce=P[Se]||0;ae+=Ce}if(rt.current=ae,Ne>K||we.current){const Ce=D.current.getBoundingClientRect().height;let xe=Ce;Ce>K&&(xe=K-(he?De:Ct)),C?D.current.style.height=`${Ce-Math.max(ae,0)}px`:D.current.style.height=`${Math.max(xe,K-De)}px`}else rs()||(D.current.style.height=`${We.current}px`);n&&n.length>0&&!we.current?D.current.style.bottom="0px":D.current.style.bottom=`${Math.max(ae,0)}px`}}return(A=window.visualViewport)==null||A.addEventListener("resize",H),()=>{var B;return(B=window.visualViewport)==null?void 0:B.removeEventListener("resize",H)}},[Se,n,P]);function Ke(A){gr(),i?.(),A||re(!1),setTimeout(()=>{n&&Xe(n[0])},V.DURATION*1e3)}function _t(){if(!D.current)return;const A=document.querySelector("[data-vaul-drawer-wrapper]"),H=it(D.current,g);G(D.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`}),G(ye.current,{transition:`opacity ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,opacity:"1"}),v&&H&&H>0&&Q&&G(A,{borderRadius:`${Qt}px`,overflow:"hidden",...J(g)?{transform:`scale(${pe()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${pe()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${V.DURATION}s`,transitionTimingFunction:`cubic-bezier(${V.EASE.join(",")})`},!0)}function gr(){!se||!D.current||(D.current.classList.remove(xt),me.current=!1,ve(!1),Ve.current=new Date)}function br(A){if(!se||!D.current)return;D.current.classList.remove(xt),me.current=!1,ve(!1),Ve.current=new Date;const H=it(D.current,g);if(!A||!ce(A.target,!1)||!H||Number.isNaN(H)||Ue.current===null)return;const B=Ve.current.getTime()-Ue.current.getTime(),M=qe.current-(J(g)?A.pageY:A.pageX),K=Math.abs(M)/B;if(K>.05&&(et(!0),setTimeout(()=>{et(!1)},200)),n){L({draggedDistance:M*(g==="bottom"||g==="right"?1:-1),closeDrawer:Ke,velocity:K,dismissible:f}),o?.(A,!0);return}if(g==="bottom"||g==="right"?M>0:M<0){_t(),o?.(A,!0);return}if(K>Gt){Ke(),o?.(A,!1);return}var oe;const ae=Math.min((oe=D.current.getBoundingClientRect().height)!=null?oe:0,window.innerHeight);var Ne;const he=Math.min((Ne=D.current.getBoundingClientRect().width)!=null?Ne:0,window.innerWidth),De=g==="left"||g==="right";if(Math.abs(H)>=(De?he:ae)*w){Ke(),o?.(A,!1);return}o?.(A,!0),_t()}b.useEffect(()=>(Q&&(G(document.documentElement,{scrollBehavior:"auto"}),Ye.current=new Date),()=>{fs(document.documentElement,"scrollBehavior")}),[Q]);function vr(A){const H=A?(window.innerWidth-Pe)/window.innerWidth:1,B=A?-Pe:0;ke.current&&window.clearTimeout(ke.current),G(D.current,{transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,transform:J(g)?`scale(${H}) translate3d(0, ${B}px, 0)`:`scale(${H}) translate3d(${B}px, 0, 0)`}),!A&&D.current&&(ke.current=setTimeout(()=>{const M=it(D.current,g);G(D.current,{transition:"none",transform:J(g)?`translate3d(0, ${M}px, 0)`:`translate3d(${M}px, 0, 0)`})},500))}function jr(A,H){if(H<0)return;const B=(window.innerWidth-Pe)/window.innerWidth,M=B+H*(1-B),K=-Pe+H*Pe;G(D.current,{transform:J(g)?`scale(${M}) translate3d(0, ${K}px, 0)`:`scale(${M}) translate3d(${K}px, 0, 0)`,transition:"none"})}function yr(A,H){const B=J(g)?window.innerHeight:window.innerWidth,M=H?(B-Pe)/B:1,K=H?-Pe:0;H&&G(D.current,{transition:`transform ${V.DURATION}s cubic-bezier(${V.EASE.join(",")})`,transform:J(g)?`scale(${M}) translate3d(0, ${K}px, 0)`:`scale(${M}) translate3d(${K}px, 0, 0)`})}return b.useEffect(()=>{j||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[j]),b.createElement(Dr,{defaultOpen:E,onOpenChange:A=>{!f&&!A||(A?le(!0):Ke(!0),re(A))},open:Q},b.createElement(Vt.Provider,{value:{activeSnapPoint:dt,snapPoints:n,setActiveSnapPoint:Xe,drawerRef:D,overlayRef:ye,onOpenChange:s,onPress:te,onRelease:br,onDrag:ue,dismissible:f,shouldAnimate:tt,handleOnly:p,isOpen:Q,isDragging:se,shouldFade:je,closeDrawer:Ke,onNestedDrag:jr,onNestedOpenChange:vr,onNestedRelease:yr,keyboardIsOpen:we,modal:j,snapPointsOffset:P,activeSnapPointIndex:Se,direction:g,shouldScaleBackground:v,setBackgroundColorOnScale:d,noBodyStyles:N,container:O,autoFocus:$}},r))}const tr=b.forwardRef(function({...t},s){const{overlayRef:r,snapPoints:a,onRelease:o,shouldFade:n,isOpen:v,modal:d,shouldAnimate:w}=Ze(),y=Kt(s,r),f=a&&a.length>0;if(!d)return null;const p=b.useCallback(m=>o(m),[o]);return b.createElement(Or,{onMouseUp:p,ref:y,"data-vaul-overlay":"","data-vaul-snap-points":v&&f?"true":"false","data-vaul-snap-points-overlay":v&&n?"true":"false","data-vaul-animate":w?.current?"true":"false",...t})});tr.displayName="Drawer.Overlay";const rr=b.forwardRef(function({onPointerDownOutside:t,style:s,onOpenAutoFocus:r,...a},o){const{drawerRef:n,onPress:v,onRelease:d,onDrag:w,keyboardIsOpen:y,snapPointsOffset:f,activeSnapPointIndex:p,modal:m,isOpen:I,direction:S,snapPoints:C,container:j,handleOnly:i,shouldAnimate:x,autoFocus:N}=Ze(),[g,E]=b.useState(!1),U=Kt(o,n),c=b.useRef(null),l=b.useRef(null),h=b.useRef(!1),R=C&&C.length>0;ws();const O=(T,F,Q=0)=>{if(h.current)return!0;const re=Math.abs(T.y),Z=Math.abs(T.x),le=Z>re,se=["bottom","right"].includes(F)?1:-1;if(F==="left"||F==="right"){if(!(T.x*se<0)&&Z>=0&&Z<=Q)return le}else if(!(T.y*se<0)&&re>=0&&re<=Q)return!le;return h.current=!0,!0};b.useEffect(()=>{R&&window.requestAnimationFrame(()=>{E(!0)})},[]);function $(T){c.current=null,h.current=!1,d(T)}return b.createElement(Pr,{"data-vaul-drawer-direction":S,"data-vaul-drawer":"","data-vaul-delayed-snap-points":g?"true":"false","data-vaul-snap-points":I&&R?"true":"false","data-vaul-custom-container":j?"true":"false","data-vaul-animate":x?.current?"true":"false",...a,ref:U,style:f&&f.length>0?{"--snap-point-height":`${f[p??0]}px`,...s}:s,onPointerDown:T=>{i||(a.onPointerDown==null||a.onPointerDown.call(a,T),c.current={x:T.pageX,y:T.pageY},v(T))},onOpenAutoFocus:T=>{r?.(T),N||T.preventDefault()},onPointerDownOutside:T=>{if(t?.(T),!m||T.defaultPrevented){T.preventDefault();return}y.current&&(y.current=!1)},onFocusOutside:T=>{if(!m){T.preventDefault();return}},onPointerMove:T=>{if(l.current=T,i||(a.onPointerMove==null||a.onPointerMove.call(a,T),!c.current))return;const F=T.pageY-c.current.y,Q=T.pageX-c.current.x,re=T.pointerType==="touch"?10:2;O({x:Q,y:F},S,re)?w(T):(Math.abs(Q)>re||Math.abs(F)>re)&&(c.current=null)},onPointerUp:T=>{a.onPointerUp==null||a.onPointerUp.call(a,T),c.current=null,h.current=!1,d(T)},onPointerOut:T=>{a.onPointerOut==null||a.onPointerOut.call(a,T),$(l.current)},onContextMenu:T=>{a.onContextMenu==null||a.onContextMenu.call(a,T),l.current&&$(l.current)}})});rr.displayName="Drawer.Content";const Cs=250,Ts=120,Ls=b.forwardRef(function({preventCycle:t=!1,children:s,...r},a){const{closeDrawer:o,isDragging:n,snapPoints:v,activeSnapPoint:d,setActiveSnapPoint:w,dismissible:y,handleOnly:f,isOpen:p,onPress:m,onDrag:I}=Ze(),S=b.useRef(null),C=b.useRef(!1);function j(){if(C.current){N();return}window.setTimeout(()=>{i()},Ts)}function i(){if(n||t||C.current){N();return}if(N(),!v||v.length===0){y||o();return}if(d===v[v.length-1]&&y){o();return}const E=v.findIndex(c=>c===d);if(E===-1)return;const U=v[E+1];w(U)}function x(){S.current=window.setTimeout(()=>{C.current=!0},Cs)}function N(){S.current&&window.clearTimeout(S.current),C.current=!1}return b.createElement("div",{onClick:j,onPointerCancel:N,onPointerDown:g=>{f&&m(g),x()},onPointerMove:g=>{f&&I(g)},ref:a,"data-vaul-drawer-visible":p?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},b.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},s))});Ls.displayName="Drawer.Handle";function Es(t){const s=Ze(),{container:r=s.container,...a}=t;return b.createElement(Ir,{container:r,...a})}const be={Root:Ns,Content:rr,Overlay:tr,Portal:Es,Close:_r,Title:kr,Description:Rr},sr=({shouldScaleBackground:t=!0,...s})=>e.jsx(be.Root,{shouldScaleBackground:t,...s});sr.displayName="Drawer";const As=be.Portal,_s=be.Close,nr=u.forwardRef(({className:t,...s},r)=>e.jsx(be.Overlay,{ref:r,className:Te("fixed inset-0 z-50 bg-black/80",t),...s}));nr.displayName=be.Overlay.displayName;const ar=u.forwardRef(({className:t,children:s,...r},a)=>e.jsxs(As,{children:[e.jsx(nr,{}),e.jsxs(be.Content,{ref:a,className:Te("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",t),...r,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),s]})]}));ar.displayName="DrawerContent";const or=({className:t,...s})=>e.jsx("div",{className:Te("grid gap-1.5 p-4 text-center sm:text-left",t),...s});or.displayName="DrawerHeader";const ir=({className:t,...s})=>e.jsx("div",{className:Te("mt-auto flex flex-col gap-2 p-4",t),...s});ir.displayName="DrawerFooter";const lr=u.forwardRef(({className:t,...s},r)=>e.jsx(be.Title,{ref:r,className:Te("text-lg font-semibold leading-none tracking-tight",t),...s}));lr.displayName=be.Title.displayName;const cr=u.forwardRef(({className:t,...s},r)=>e.jsx(be.Description,{ref:r,className:Te("text-sm text-muted-foreground",t),...s}));cr.displayName=be.Description.displayName;const Qe=[{code:"CSCC 21.1",name:"Software Engineering 1",units:3,instructional:"integrated lec/lab"},{code:"CSCC 36",name:"Advanced Topics in Human Computer Interaction",units:3,instructional:"lecture only"},{code:"CSCC 37",name:"User Interface Design and Development",units:3,instructional:"integrated lec/lab"},{code:"CSCC 40",name:"Introduction to Artificial Intelligence",units:3,instructional:"lecture only"},{code:"CSCC 44",name:"Introduction to Data Mining",units:3,instructional:"integrated lec/lab"},{code:"CSCC 46",name:"Introduction to Robotics",units:3,instructional:"integrated lec/lab"},{code:"ISCC 11",name:"Organization and Management Concepts",units:3,instructional:"lecture only"},{code:"ISCC 12",name:"Financial Management",units:3,instructional:"lecture only"},{code:"ISCC 16",name:"Technopreneurship",units:3,instructional:"lecture only"},{code:"ISCC 17",name:"Electronic Commerce",units:3,instructional:"lecture only"},{code:"ISCC 18",name:"Introduction to Enterprise Resource Planning",units:3,instructional:"lecture only"},{code:"ISCC 21.1",name:"IS Project Management",units:3,instructional:"lecture only"},{code:"ISCC 22.1",name:"Systems Analysis and Design",units:3,instructional:"lecture only"},{code:"ISCC 31",name:"Current Issues and Trends in Computing",units:3,instructional:"lecture only"},{code:"ITCC 12",name:"Platform Technologies",units:3,instructional:"integrated lec/lab"},{code:"ITCC 17",name:"Advanced Systems Integration and Architecture",units:3,instructional:"integrated lec/lab"},{code:"ITCC 18",name:"Advanced Integrative Programming and Technologies",units:3,instructional:"lec and lab"},{code:"ITCC 19",name:"Introduction to Geographic Information Systems",units:3,instructional:"integrated lec/lab"},{code:"ITCC 34",name:"Contemporary Database Technologies",units:3,instructional:"integrated lec/lab"},{code:"ITCC 35",name:"Advanced Web Systems and Technologies",units:3,instructional:"integrated lec/lab"},{code:"ITCC 36",name:"Introduction to Cloud Computing",units:3,instructional:"integrated lec/lab"},{code:"ITCC 37",name:"Data Warehousing",units:3,instructional:"integrated lec/lab"},{code:"ITCC 38",name:"Parallel and Distributed Computing",units:3,instructional:"integrated lec/lab"},{code:"ITCC 39",name:"IT Industry Management",units:3,instructional:"lecture only"},{code:"ITCC 40",name:"Web Design and Development",units:3,instructional:"integrated lec/lab"},{code:"ITCC 41",name:"Mobile Applications Development",units:3,instructional:"integrated lec/lab"}],ks=(t,s)=>{const[r,a]=t.split(", "),[o,n]=s.split(", "),v=parseInt(r),d=parseInt(o);return v!==d?v-d:a?.includes("Summer")?1:n?.includes("Summer")||a?.includes("1st")?-1:n?.includes("1st")?1:0};function Rs({isOpen:t,onClose:s,program:r,onAddSemester:a,onEditSemester:o,onAddSubject:n,onEditSubject:v,onDeleteSubject:d,onSetSemesterStatus:w,refreshKey:y,updatedSubjectData:f,newSemesterData:p,updatedSemesterData:m}){const[I,S]=u.useState({}),[C,j]=u.useState(!1),[i,x]=u.useState(!1),[N,g]=u.useState(null),E=c=>{g(c),x(!0)};u.useEffect(()=>{if(!t)return;(async()=>{j(!0);const l=localStorage.getItem("accessToken");if(!l){_.error("Authentication required."),j(!1);return}try{const h=await de.get("/semester-with-subjects",{params:{program_id:r.id},headers:{Authorization:`Bearer ${l}`}}),R=Array.isArray(h.data.semesters)?h.data.semesters:[],O={};R.forEach($=>{const T=`${$.year_level}, ${$.semester_level}`;O[T]={id:$.id,subjects:($.subjects||[]).map(F=>({id:F.id,code:F.subject_code,name:F.des_title,unitsTotal:F.total_units,unitsLec:F.lec_units,unitsLab:F.lab_units,hoursTotal:F.total_hrs,hoursLec:F.total_lec_hrs,hoursLab:F.total_lab_hrs,prerequisite:F.pre_requisite||"None"})),isActive:$.status===1,startDate:$.start_date,endDate:$.end_date}}),S(O)}catch{_.error("Failed to load semester data.")}finally{j(!1)}})()},[t,r.id,y]),u.useEffect(()=>{if(f){const{semesterName:c,subject:l}=f;S(h=>{const R=JSON.parse(JSON.stringify(h)),O=R[c];if(O){const $=O.subjects.findIndex(T=>T.id===l.id);$!==-1?O.subjects[$]=l:O.subjects.push(l)}return R})}},[f]),u.useEffect(()=>{if(p){const{name:c,semester:l}=p;S(h=>({...h,[c]:l}))}},[p]),u.useEffect(()=>{if(m){const{name:c,semester:l,newName:h}=m;S(R=>{const O={...R},$=O[c];return $?(h&&h!==c?(O[h]={...$,...l},delete O[c]):O[c]={...$,...l},O):R})}},[m]);const U=u.useMemo(()=>Object.entries(I).sort(([c],[l])=>ks(c,l)),[I]);return e.jsxs(Oe,{open:t,onOpenChange:s,children:[e.jsxs($e,{className:"max-w-7xl h-[95vh] flex flex-col p-0",children:[e.jsxs(Me,{className:"p-6 pb-4 bg-muted/50 border-b rounded-t-lg",children:[e.jsxs(Fe,{className:"text-2xl md:text-3xl font-bold text-foreground flex items-center gap-3",children:[r.name,e.jsx("span",{className:"text-sm font-semibold text-primary bg-primary/10 px-3 py-1 rounded-full",children:r.abbreviation})]}),e.jsxs(lt,{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"h-4 w-4"}),"Academic Year of Effectivity: ",r.effectiveYear]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto px-6 py-4 space-y-8",children:C?e.jsx("div",{className:"space-y-6",children:[1,2].map(c=>e.jsxs("div",{className:"bg-card border rounded-xl p-4 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-muted/60 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-48 bg-muted/30 rounded"})]},c))}):U.length===0?e.jsxs("div",{className:"text-center py-20 text-muted-foreground flex flex-col items-center justify-center h-full",children:[e.jsx(Pt,{size:56,className:"mx-auto mb-4"}),e.jsx("h4",{className:"font-semibold text-xl text-foreground",children:"No Semesters Found"}),e.jsx("p",{className:"max-w-md mx-auto mt-2 text-sm",children:"This curriculum is empty."})]}):U.map(([c,l])=>e.jsxs("div",{className:`group/semester border rounded-xl overflow-hidden shadow-sm transition-opacity ${l.isActive?"bg-card":"opacity-70 bg-muted/20"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-muted/30 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground",children:c}),e.jsx(mt,{variant:l.isActive?"default":"destructive",children:l.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/semester:opacity-100 transition-opacity",children:[e.jsx(q,{variant:"ghost",size:"icon",title:"Set Status & Dates",className:"h-8 w-8 text-muted-foreground",onClick:()=>w(c,l,r.effectiveYear),children:e.jsx(Gr,{size:16})}),e.jsx(q,{variant:"ghost",size:"icon",title:"Rename Semester",className:"h-8 w-8 text-green-500 hover:text-green-500",onClick:()=>o(l.id,c),children:e.jsx(vt,{size:16})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(jt,{className:"min-w-[1200px]",children:[e.jsxs(yt,{className:"bg-muted/50 sticky top-0 z-10",children:[e.jsxs(ie,{children:[e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Course Code"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r w-[350px]",children:"Descriptive Title"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Units"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Hours per week"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Pre-requisite"}),e.jsx(Y,{rowSpan:2,className:"align-middle w-[100px] text-center",children:"Actions"})]}),e.jsxs(ie,{children:[e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"}),e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"})]})]}),e.jsx(wt,{children:l.subjects.length>0?l.subjects.map(h=>{const R=h.name.toUpperCase().startsWith("PROFESSIONAL ELECTIVE")&&h.code.toUpperCase().startsWith("ELECTIVE");return e.jsxs(ie,{children:[e.jsx(k,{className:"w-[150px] font-semibold uppercase text-center",children:h.code}),e.jsx(k,{children:R?e.jsx(q,{variant:"link",className:"text-left p-0 h-auto font-normal text-base text-blue-600 hover:underline",onClick:()=>E(h),children:h.name}):h.name}),e.jsx(k,{className:"text-center font-bold text-primary",children:h.unitsTotal}),e.jsx(k,{className:"text-center",children:h.unitsLec}),e.jsx(k,{className:"text-center",children:h.unitsLab}),e.jsx(k,{className:"text-center font-bold text-primary",children:h.hoursTotal}),e.jsx(k,{className:"text-center",children:h.hoursLec}),e.jsx(k,{className:"text-center",children:h.hoursLab}),e.jsx(k,{className:"w-[150px] text-center",children:h.prerequisite}),e.jsx(k,{className:"text-center",children:e.jsxs("div",{className:"flex justify-end items-center gap-1",children:[e.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-500 hover:text-green-500",onClick:()=>v(c,h),children:e.jsx(vt,{size:16})}),e.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>d(c,h.id),children:e.jsx(Tt,{size:16})})]})})]},h.id||h.code)}):e.jsx(ie,{children:e.jsx(k,{colSpan:10,className:"text-center h-24 text-muted-foreground",children:"No subjects added for this semester."})})}),e.jsx(St,{className:"sticky bottom-0 bg-muted/80 backdrop-blur-sm",children:e.jsxs(ie,{children:[e.jsx(k,{colSpan:2,className:"text-right font-bold text-lg",children:"SEMESTER TOTALS"}),e.jsx(k,{className:"text-center font-bold text-lg text-primary",children:l.subjects.reduce((h,R)=>h+(Number(R.unitsTotal)||0),0)}),e.jsx(k,{className:"text-center font-semibold",children:l.subjects.reduce((h,R)=>h+(Number(R.unitsLec)||0),0)}),e.jsx(k,{className:"text-center font-semibold",children:l.subjects.reduce((h,R)=>h+(Number(R.unitsLab)||0),0)}),e.jsx(k,{className:"text-center font-bold text-lg text-primary",children:l.subjects.reduce((h,R)=>h+(Number(R.hoursTotal)||0),0)}),e.jsx(k,{className:"text-center font-semibold",children:l.subjects.reduce((h,R)=>h+(Number(R.hoursLec)||0),0)}),e.jsx(k,{className:"text-center font-semibold",children:l.subjects.reduce((h,R)=>h+(Number(R.hoursLab)||0),0)}),e.jsx(k,{colSpan:2})]})})]})}),e.jsx("div",{className:"p-2 border-t",children:e.jsxs(q,{onClick:()=>n(c,l.id),variant:"link",children:[e.jsx(Lt,{size:16,className:"mr-1"})," Add Subject"]})})]},c))}),e.jsxs(ze,{className:"mt-auto p-6 bg-gray-50 border-t rounded-b-lg flex flex-col md:flex-row md:justify-end gap-2",children:[e.jsx(He,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",children:"Cancel"})}),e.jsxs(q,{onClick:a,className:"flex items-center gap-2",children:[e.jsx(Pt,{size:16})," Add Year/Semester"]})]})]}),e.jsx(sr,{open:i,onOpenChange:x,children:e.jsxs(ar,{className:"p-0",children:[e.jsxs(or,{className:"text-left px-5 py-4 border-b bg-background/95 backdrop-blur-sm sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(lr,{className:"text-xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(Wr,{className:"h-5 w-5 text-primary"}),N?.name||"Elective Subjects"]}),e.jsx(cr,{className:"text-sm mt-1 text-muted-foreground",children:"List of subjects that can be taken for this elective slot. (Read-only view)"})]}),e.jsxs(mt,{variant:"outline",className:"text-xs font-semibold py-1 px-3 mt-1 text-primary border-primary",children:[Qe.length," Options"]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-primary",children:"Placeholder Code:"})," ",N?.code,e.jsx("span",{className:"ml-4 font-medium text-primary",children:"Units Required:"})," ",N?.unitsTotal]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-y-auto px-5 py-4",children:e.jsxs(jt,{className:"min-w-[720px]",children:[e.jsx(yt,{className:"sticky top-0 bg-background z-10",children:e.jsxs(ie,{className:"[&>th]:py-3 [&>th]:text-xs [&>th]:text-white [&>th]:font-bold [&>th]:uppercase",children:[e.jsx(Y,{className:"w-[120px]",children:"Code"}),e.jsx(Y,{className:"w-[400px]",children:"Descriptive Title"}),e.jsx(Y,{className:"text-right w-[80px]",children:"Units"}),e.jsx(Y,{className:"w-[180px]",children:"Instructional Type"})]})}),e.jsx(wt,{children:Qe.length===0?e.jsx(ie,{children:e.jsx(k,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:"No elective subjects available."})}):Qe.map(c=>e.jsxs(ie,{className:"transition-colors [&>td]:py-3 text-sm",children:[e.jsx(k,{className:"font-semibold text-foreground",children:c.code}),e.jsx(k,{title:c.name,className:"font-medium text-wrap",children:c.name}),e.jsx(k,{className:"text-right tabular-nums font-bold text-primary",children:c.units}),e.jsx(k,{children:e.jsx(mt,{variant:"secondary",className:"capitalize text-xs font-medium",children:c.instructional.replace("integrated lec/lab","Lec/Lab").replace("lecture only","Lecture")})})]},c.code))}),Qe.length>0&&e.jsx(St,{className:"bg-muted/60 sticky bottom-0 z-10 backdrop-blur-sm",children:e.jsxs(ie,{className:"[&>td]:py-3",children:[e.jsx(k,{colSpan:2,className:"text-right font-bold text-base",children:"Total Units Available"}),e.jsx(k,{className:"text-right font-extrabold text-xl text-primary",children:Qe.reduce((c,l)=>c+(Number(l.units)||0),0)}),e.jsx(k,{})]})})]})}),e.jsx(ir,{className:"px-5 py-3 border-t bg-background/95 backdrop-blur-sm sticky bottom-0 z-20 flex justify-center",children:e.jsx(_s,{asChild:!0,children:e.jsx(q,{variant:"outline",size:"sm",className:"w-full max-w-xs",children:"Close View"})})})]})})]})}const Ds=()=>{const r=new Date().getFullYear()+5,a=[];for(let o=2015;o<=r;o++)a.push(String(o));return a},Yt=Ds();function Is({isOpen:t,onClose:s,onSave:r,initialData:a}){const[o,n]=u.useState(""),[v,d]=u.useState(""),[w,y]=u.useState(""),[f,p]=u.useState(""),[m,I]=u.useState(!1);u.useEffect(()=>{if(a){n(a.name),d(a.abbreviation);const[j="",i=""]=a.effectiveYear.split("-");y(j),p(i)}else{n(""),d("");const j=new Date().getFullYear();y(String(j)),p(String(j+1))}},[a,t]);const S=async j=>{j.preventDefault(),I(!0);const i={program_name:o,abbreviation:v,year_from:w,year_to:f},x=localStorage.getItem("accessToken");if(!x){_.error("Authentication required."),I(!1);return}const N={Authorization:`Bearer ${x}`};try{const g=!!a,E=g?`/edit-program/${a.id}`:"/add-program",c=await de["post"](E,i,{headers:N});_.success(c.data.message||"Program saved successfully!");const l=c.data.program,h=l.subjects||a?.subjects||{},R=typeof l.total_subjects=="number"?l.total_subjects:Object.keys(h).length,O=typeof l.total_units=="number"?l.total_units:a?.total_units??0,$={id:l.id,name:l.program_name,abbreviation:l.abbreviation,effectiveYear:`${l.year_from}-${l.year_to}`,semesters:l.semesters||a?.semesters||{},subjects:h,total_subjects:R,total_units:O,isActive:l.isActive??l.is_active??a?.isActive??!0};r($),s()}catch(g){if(de.isAxiosError(g)&&g.response){if(g.response.status===401){_.error("Your session has expired. Please log in again.");return}const E=g.response.data,U=E.errors;if(U&&typeof U=="object"&&Object.keys(U).length>0){const c=Object.keys(U)[0],l=U[c]?.[0];_.error(l||"A validation error occurred.")}else E&&typeof E.message=="string"?_.error(E.message):_.error("An unknown API error occurred.")}else _.error("Failed to connect to the server. Please check your connection."),console.error("Non-Axios error:",g)}finally{I(!1)}},C=j=>{y(j),p(String(Number(j)+1))};return e.jsx(Oe,{open:t,onOpenChange:s,children:e.jsxs($e,{children:[e.jsx(Me,{children:e.jsx(Fe,{children:a?"Edit Program":"Add New Program"})}),e.jsxs("form",{onSubmit:S,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"progName",children:"Program Name"}),e.jsx(W,{id:"progName",value:o,onChange:j=>n(j.target.value),placeholder:"e.g., Bachelor of Science...",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"progAbbr",children:"Abbreviation"}),e.jsx(W,{id:"progAbbr",value:v,onChange:j=>d(j.target.value),placeholder:"e.g., BSIT",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{children:"Effectivity A.Y."}),e.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr] items-center gap-2",children:[e.jsxs(Le,{value:w,onValueChange:C,required:!0,children:[e.jsx(Ee,{children:e.jsx(Ae,{placeholder:"Start Year"})}),e.jsx(_e,{children:Yt.map(j=>e.jsx(ge,{value:j,children:j},j))})]}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsxs(Le,{value:f,onValueChange:p,required:!0,children:[e.jsx(Ee,{children:e.jsx(Ae,{placeholder:"End Year"})}),e.jsx(_e,{children:Yt.map(j=>e.jsx(ge,{value:j,children:j},j))})]})]})]}),e.jsxs(ze,{className:"pt-4",children:[e.jsx(He,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:m,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:m,children:m?"Saving...":a?"Save Changes":"Save Program"})]})]})]})})}const gt={id:0,code:"",name:"",unitsTotal:0,unitsLec:"",unitsLab:"",hoursTotal:0,hoursLec:"",hoursLab:"",prerequisite:""},Ps=["1st Year","2nd Year","3rd Year","4th Year"],Os=["1st Semester","2nd Semester","Summer"];function $s({isOpen:t,onClose:s,onSave:r,programId:a}){const[o,n]=u.useState(""),[v,d]=u.useState(""),[w,y]=u.useState([gt]),[f,p]=u.useState(!1);u.useEffect(()=>{const i=w.map(x=>({...x,unitsTotal:(Number(x.unitsLec)||0)+(Number(x.unitsLab)||0),hoursTotal:(Number(x.hoursLec)||0)+(Number(x.hoursLab)||0)}));JSON.stringify(i)!==JSON.stringify(w)&&y(i)},[w]);const m=u.useMemo(()=>w.reduce((i,x)=>(i.totalUnits+=Number(x.unitsTotal)||0,i.totalLecUnits+=Number(x.unitsLec)||0,i.totalLabUnits+=Number(x.unitsLab)||0,i.totalHours+=Number(x.hoursTotal)||0,i.totalLecHours+=Number(x.hoursLec)||0,i.totalLabHours+=Number(x.hoursLab)||0,i),{totalUnits:0,totalLecUnits:0,totalLabUnits:0,totalHours:0,totalLecHours:0,totalLabHours:0}),[w]),I=()=>y(i=>[...i,{...gt}]),S=i=>y(x=>x.length>1?x.filter((N,g)=>g!==i):x),C=(i,x,N)=>y(g=>g.map((E,U)=>U===i?{...E,[x]:N}:E)),j=async i=>{if(i.preventDefault(),!o||!v){_.error("Please select a year level and semester.");return}if(w.some(x=>!x.code.trim()||!x.name.trim())){_.error("Please fill out all subject codes and titles.");return}p(!0);try{const x=localStorage.getItem("accessToken");if(!x){_.error("Authentication required."),p(!1);return}const N={program_id:a,year_level:o,semester_level:v,subjects:w.map(E=>({subject_code:E.code,des_title:E.name,total_units:E.unitsTotal,lec_units:Number(E.unitsLec)||0,lab_units:Number(E.unitsLab)||0,total_hrs:E.hoursTotal,total_lec_hrs:Number(E.hoursLec)||0,total_lab_hrs:Number(E.hoursLab)||0,pre_requisite:E.prerequisite||null}))},g=await de.post("/semester-with-subjects",N,{headers:{Authorization:`Bearer ${x}`}});if(g.status===201&&g.data.semester){_.success("Semester and subjects added successfully!");const E=g.data.semester,U=`${E.year_level}, ${E.semester_level}`,c={id:E.id,isActive:E.status===1,startDate:E.start_date,endDate:E.end_date,subjects:(E.subjects||[]).map(l=>({id:l.id,code:l.subject_code,name:l.des_title,unitsTotal:l.total_units,unitsLec:l.lec_units,unitsLab:l.lab_units,hoursTotal:l.total_hrs,hoursLec:l.total_lec_hrs,hoursLab:l.total_lab_hrs,prerequisite:l.pre_requisite||"None"}))};r&&r({name:U,semester:c}),s()}}catch(x){_.error(x.response?.data?.error||"Failed to save. Please try again.")}finally{p(!1)}};return u.useEffect(()=>{t&&(n(""),d(""),y([gt]))},[t]),e.jsx(Oe,{open:t,onOpenChange:s,children:e.jsx(Sr,{children:e.jsxs($e,{className:"max-w-7xl h-[95vh] flex flex-col",children:[e.jsxs(Me,{children:[e.jsx(Fe,{children:"Add New Semester and Subjects"}),e.jsx(lt,{children:"Add subjects in bulk for a new semester. Totals are calculated automatically."})]}),e.jsxs("form",{onSubmit:j,className:"flex-grow flex flex-col min-h-0 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"yearLevel",className:"text-base",children:"Year Level"}),e.jsxs(Le,{value:o,onValueChange:n,required:!0,children:[e.jsx(Ee,{id:"yearLevel",children:e.jsx(Ae,{placeholder:"Select a year level"})}),e.jsx(_e,{children:Ps.map(i=>e.jsx(ge,{value:i,children:i},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"semester",className:"text-base",children:"Semester"}),e.jsxs(Le,{value:v,onValueChange:d,required:!0,children:[e.jsx(Ee,{id:"semester",children:e.jsx(Ae,{placeholder:"Select a semester"})}),e.jsx(_e,{children:Os.map(i=>e.jsx(ge,{value:i,children:i},i))})]})]})]}),e.jsx("div",{className:"flex-grow overflow-auto border rounded-lg",children:e.jsxs(jt,{className:"min-w-[1200px]",children:[e.jsxs(yt,{className:"bg-muted/50 sticky top-0 z-10",children:[e.jsxs(ie,{children:[e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Course Code"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r w-[350px]",children:"Descriptive Title"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Units"}),e.jsx(Y,{colSpan:3,className:"text-center border-r",children:"Hours per week"}),e.jsx(Y,{rowSpan:2,className:"align-middle text-center border-r",children:"Pre-requisite"}),e.jsx(Y,{rowSpan:2,className:"align-middle w-[50px]"})]}),e.jsxs(ie,{children:[e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"}),e.jsx(Y,{className:"text-center border-r",children:"Total"}),e.jsx(Y,{className:"text-center border-r",children:"Lec"}),e.jsx(Y,{className:"text-center border-r",children:"Lab"})]})]}),e.jsx(wt,{children:w.map((i,x)=>e.jsxs(ie,{children:[e.jsx(k,{className:"w-[150px]",children:e.jsx(W,{required:!0,className:"uppercase",placeholder:"e.g. CS101",value:i.code,onChange:N=>C(x,"code",N.target.value)})}),e.jsx(k,{children:e.jsx(W,{required:!0,placeholder:"e.g. Intro to Programming",value:i.name,onChange:N=>C(x,"name",N.target.value)})}),e.jsx(k,{children:e.jsxs(Rt,{children:[e.jsx(Dt,{asChild:!0,children:e.jsx(W,{value:i.unitsTotal||"",readOnly:!0,className:"text-center font-bold bg-muted/50 cursor-not-allowed"})}),e.jsx(It,{children:"Auto-calculated"})]})}),e.jsx(k,{children:e.jsx(W,{min:"0",type:"number",value:i.unitsLec,onChange:N=>C(x,"unitsLec",N.target.value),className:"text-center"})}),e.jsx(k,{children:e.jsx(W,{min:"0",type:"number",value:i.unitsLab,onChange:N=>C(x,"unitsLab",N.target.value),className:"text-center"})}),e.jsx(k,{children:e.jsxs(Rt,{children:[e.jsx(Dt,{asChild:!0,children:e.jsx(W,{value:i.hoursTotal||"",readOnly:!0,className:"text-center font-bold bg-muted/50 cursor-not-allowed"})}),e.jsx(It,{children:"Auto-calculated"})]})}),e.jsx(k,{children:e.jsx(W,{min:"0",type:"number",value:i.hoursLec,onChange:N=>C(x,"hoursLec",N.target.value),className:"text-center"})}),e.jsx(k,{children:e.jsx(W,{min:"0",type:"number",value:i.hoursLab,onChange:N=>C(x,"hoursLab",N.target.value),className:"text-center"})}),e.jsx(k,{className:"w-[150px]",children:e.jsx(W,{placeholder:"None",value:i.prerequisite,onChange:N=>C(x,"prerequisite",N.target.value)})}),e.jsx(k,{className:"text-center",children:e.jsx(q,{type:"button",variant:"ghost",size:"icon",onClick:()=>S(x),disabled:w.length<=1,className:"text-destructive h-8 w-8 shrink-0 disabled:opacity-50",children:e.jsx(Tt,{size:16})})})]},x))}),e.jsx(St,{className:"sticky bottom-0 bg-muted/80 backdrop-blur-sm",children:e.jsxs(ie,{children:[e.jsx(k,{colSpan:2,className:"text-right font-bold text-lg",children:"SEMESTER TOTALS"}),e.jsx(k,{className:"text-center font-bold text-lg text-primary",children:m.totalUnits}),e.jsx(k,{className:"text-center font-semibold",children:m.totalLecUnits}),e.jsx(k,{className:"text-center font-semibold",children:m.totalLabUnits}),e.jsx(k,{className:"text-center font-bold text-lg text-primary",children:m.totalHours}),e.jsx(k,{className:"text-center font-semibold",children:m.totalLecHours}),e.jsx(k,{className:"text-center font-semibold",children:m.totalLabHours}),e.jsx(k,{colSpan:2})]})})]})}),e.jsxs(q,{type:"button",variant:"outline",onClick:I,className:"mt-4 w-full sm:w-auto",children:[e.jsx(Lt,{size:16,className:"mr-2"})," Add Subject Row"]}),e.jsxs(ze,{className:"mt-5 pt-4 border-t",children:[e.jsx(He,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:f,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"mr-2 h-4 w-4 animate-spin"})," Saving..."]}):"Save Curriculum"})]})]})]})})})}const Ms=["1st Year","2nd Year","3rd Year","4th Year"],Fs=["1st Semester","2nd Semester","Summer"];function zs({isOpen:t,onClose:s,onSaveSuccess:r,semesterId:a,initialData:o}){const[n,v]=u.useState(!1),[d,w]=u.useState(""),[y,f]=u.useState("");u.useEffect(()=>{if(t&&o){const m=o.split(", ");m.length===2&&(w(m[0]),f(m[1]))}},[t,o]);const p=async m=>{m.preventDefault();const I=`${d}, ${y}`;if(!d||!y){_.error("Please select both a year level and a semester.");return}if(I===o){_.info("No changes were made."),s();return}if(!a){_.error("Semester ID is missing.");return}v(!0);try{const S=localStorage.getItem("accessToken");if(!S){_.error("Authentication required."),v(!1);return}const C={year_level:d,semester_level:y};await de.put(`/semesters/${a}/rename`,C,{headers:{Authorization:`Bearer ${S}`}}),_.success("Semester renamed successfully!"),r(o,I),s()}catch(S){_.error(S.response?.data?.message||"Failed to rename semester.")}finally{v(!1)}};return e.jsx(Oe,{open:t,onOpenChange:s,children:e.jsxs($e,{children:[e.jsx(Me,{children:e.jsx(Fe,{children:"Rename Semester"})}),e.jsxs("form",{onSubmit:p,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"yearPart",children:"Year Level"}),e.jsxs(Le,{value:d,onValueChange:w,children:[e.jsx(Ee,{id:"yearPart",children:e.jsx(Ae,{placeholder:"Select a year level"})}),e.jsx(_e,{children:Ms.map(m=>e.jsx(ge,{value:m,children:m},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"semesterPart",children:"Semester"}),e.jsxs(Le,{value:y,onValueChange:f,children:[e.jsx(Ee,{id:"semesterPart",children:e.jsx(Ae,{placeholder:"Select a semester"})}),e.jsx(_e,{children:Fs.map(m=>e.jsx(ge,{value:m,children:m},m))})]})]}),e.jsxs(ze,{className:"pt-4",children:[e.jsx(He,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:n,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:n||!d||!y,children:n?e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"mr-2 h-4 w-4 animate-spin"})," Renaming..."]}):"Rename"})]})]})]})})}function Hs(t){const{isOpen:s,onClose:r,onSave:a,initialData:o}=t,[n,v]=u.useState({id:0,code:"",name:"",unitsTotal:0,unitsLec:0,unitsLab:0,hoursTotal:0,hoursLec:0,hoursLab:0,prerequisite:""}),[d,w]=u.useState(null);u.useEffect(()=>{const S=(Number(n.unitsLec)||0)+(Number(n.unitsLab)||0),C=(Number(n.hoursLec)||0)+(Number(n.hoursLab)||0);v(j=>({...j,unitsTotal:S,hoursTotal:C}))},[n.unitsLec,n.unitsLab,n.hoursLec,n.hoursLab]),u.useEffect(()=>{const S=Number(n.unitsLec)||0,C=Number(n.unitsLab)||0,j=Number(n.unitsTotal)||0,i=S+C>j?"Lec + Lab units cannot exceed Total.":null,x=Number(n.hoursLec)||0,N=Number(n.hoursLab)||0,g=Number(n.hoursTotal)||0,E=x+N>g?"Lec + Lab hours cannot exceed Total.":null;w(i||E?{unitError:i,hourError:E}:null)},[n]),u.useEffect(()=>{s&&v(o||{id:0,code:"",name:"",unitsTotal:0,unitsLec:0,unitsLab:0,hoursTotal:0,hoursLec:0,hoursLab:0,prerequisite:""})},[s,o]);const y=(S,C)=>{v(j=>({...j,[S]:C}))},f=(S,C)=>{const j=Number(C);y(S,j>=0?j:0)},[p,m]=u.useState(!1),I=async S=>{if(S.preventDefault(),d){_.error("Please fix the validation errors before saving.");return}const C=!!o;m(!0);try{await a(n,C),r()}catch(j){console.error("Subject save failed:",j),_.error("The subject code has already been taken")}finally{m(!1)}};return e.jsx(Oe,{open:s,onOpenChange:r,children:e.jsxs($e,{children:[e.jsx(Me,{children:e.jsx(Fe,{children:o?`Edit Subject: ${o.code}`:"Add New Subject"})}),e.jsxs("form",{onSubmit:I,className:"py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"code",children:"Course Code"}),e.jsx(W,{id:"code",value:n.code,onChange:S=>y("code",S.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"prerequisite",children:"Pre-requisite"}),e.jsx(W,{id:"prerequisite",value:n.prerequisite,onChange:S=>y("prerequisite",S.target.value),placeholder:"None"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"name",children:"Descriptive Title"}),e.jsx(W,{id:"name",value:n.name,onChange:S=>y("name",S.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx(X,{className:"font-semibold",children:"Unit Allocation"}),e.jsxs("div",{className:`grid grid-cols-3 gap-4 p-4 border rounded-lg bg-muted/30 ${d?.unitError?"border-destructive":""}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"unitsTotal",children:"Total"}),e.jsx(W,{id:"unitsTotal",type:"number",value:n.unitsTotal||"",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"unitsLec",children:"Lec"}),e.jsx(W,{id:"unitsLec",type:"number",value:n.unitsLec||"",onChange:S=>f("unitsLec",S.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"unitsLab",children:"Lab"}),e.jsx(W,{id:"unitsLab",type:"number",value:n.unitsLab||"",onChange:S=>f("unitsLab",S.target.value)})]})]}),d?.unitError&&e.jsxs("p",{className:"text-destructive text-sm flex items-center gap-2 mt-2",children:[e.jsx(Ot,{size:16}),d.unitError]})]}),e.jsxs("div",{className:"space-y-2 pt-2",children:[e.jsx(X,{className:"font-semibold",children:"Hour Allocation"}),e.jsxs("div",{className:`grid grid-cols-3 gap-4 p-4 border rounded-lg bg-muted/30 ${d?.hourError?"border-destructive":""}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"hoursTotal",children:"Total"}),e.jsx(W,{id:"hoursTotal",type:"number",value:n.hoursTotal||"",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"hoursLec",children:"Lec"}),e.jsx(W,{id:"hoursLec",type:"number",value:n.hoursLec||"",onChange:S=>f("hoursLec",S.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(X,{htmlFor:"hoursLab",children:"Lab"}),e.jsx(W,{id:"hoursLab",type:"number",value:n.hoursLab||"",onChange:S=>f("hoursLab",S.target.value)})]})]}),d?.hourError&&e.jsxs("p",{className:"text-destructive text-sm flex items-center gap-2 mt-2",children:[e.jsx(Ot,{size:16}),d.hourError]})]})]}),e.jsxs(ze,{className:"mt-8 pt-4 border-t",children:[e.jsx(He,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:p,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:!!d||p,children:p?"Saving...":o?"Save Changes":"Save Subject"})]})]})]})})}function Ys(t,s,{checkForDefaultPrevented:r=!0}={}){return function(o){if(t?.(o),r===!1||!o.defaultPrevented)return s?.(o)}}var ct="Switch",[qs,fn]=Cr(ct),[Bs,Us]=qs(ct),ur=u.forwardRef((t,s)=>{const{__scopeSwitch:r,name:a,checked:o,defaultChecked:n,required:v,disabled:d,value:w="on",onCheckedChange:y,form:f,...p}=t,[m,I]=u.useState(null),S=Bt(s,N=>I(N)),C=u.useRef(!1),j=m?f||!!m.closest("form"):!0,[i,x]=Nr({prop:o,defaultProp:n??!1,onChange:y,caller:ct});return e.jsxs(Bs,{scope:r,checked:i,disabled:d,children:[e.jsx(Ut.button,{type:"button",role:"switch","aria-checked":i,"aria-required":v,"data-state":fr(i),"data-disabled":d?"":void 0,disabled:d,value:w,...p,ref:S,onClick:Ys(t.onClick,N=>{x(g=>!g),j&&(C.current=N.isPropagationStopped(),C.current||N.stopPropagation())})}),j&&e.jsx(hr,{control:m,bubbles:!C.current,name:a,value:w,checked:i,required:v,disabled:d,form:f,style:{transform:"translateX(-100%)"}})]})});ur.displayName=ct;var dr="SwitchThumb",mr=u.forwardRef((t,s)=>{const{__scopeSwitch:r,...a}=t,o=Us(dr,r);return e.jsx(Ut.span,{"data-state":fr(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:s})});mr.displayName=dr;var Vs="SwitchBubbleInput",hr=u.forwardRef(({__scopeSwitch:t,control:s,checked:r,bubbles:a=!0,...o},n)=>{const v=u.useRef(null),d=Bt(v,n),w=Ar(r),y=Tr(s);return u.useEffect(()=>{const f=v.current;if(!f)return;const p=window.HTMLInputElement.prototype,I=Object.getOwnPropertyDescriptor(p,"checked").set;if(w!==r&&I){const S=new Event("click",{bubbles:a});I.call(f,r),f.dispatchEvent(S)}},[w,r,a]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:d,style:{...o.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});hr.displayName=Vs;function fr(t){return t?"checked":"unchecked"}var pr=ur,Ws=mr;const xr=u.forwardRef(({className:t,...s},r)=>e.jsx(pr,{className:Te("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...s,ref:r,children:e.jsx(Ws,{className:Te("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));xr.displayName=pr.displayName;function Xs({isOpen:t,onClose:s,onSaveSuccess:r,semesterId:a,semesterName:o,initialData:n,effectiveYear:v}){const[d,w]=u.useState(!1),[y,f]=u.useState(""),[p,m]=u.useState(""),[I,S]=u.useState(!1);u.useEffect(()=>{if(t&&n){w(n.isActive);const j=i=>{if(!i)return"";try{return new Date(i).toISOString().split("T")[0]}catch{return""}};f(j(n.startDate)),m(j(n.endDate))}},[t,n]);const C=async j=>{if(j.preventDefault(),!a){_.error("Semester ID is missing.");return}if(d&&(!y||!p)){_.error("Start and end dates are required when semester is Active.");return}if(y&&p&&new Date(y)>new Date(p)){_.error("Start date cannot be after the end date.");return}const i=localStorage.getItem("accessToken");if(!i){_.error("Authentication required.");return}S(!0);try{const x=`/semesters/${a}/status`,N={status:d?1:0,start_date:y||null,end_date:p||null},g=await de.put(x,N,{headers:{Authorization:`Bearer ${i}`}});_.success(g.data.message||"Semester status updated!"),r(o,{isActive:N.status===1,startDate:N.start_date||void 0,endDate:N.end_date||void 0})}catch(x){_.error(x.response?.data?.message||"Failed to update semester.")}finally{S(!1)}};return e.jsx(Oe,{open:t,onOpenChange:s,children:e.jsxs($e,{children:[e.jsxs(Me,{children:[e.jsx(Fe,{children:"Set Semester Status & Dates"}),e.jsxs(lt,{className:"flex items-center gap-2 pt-1",children:[e.jsx(Kr,{className:"h-4 w-4"}),"School Year: ",v]})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{children:"Semester"}),e.jsx("p",{className:"font-semibold text-lg",children:o})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(xr,{id:"semester-status",checked:d,onCheckedChange:w}),e.jsx(X,{htmlFor:"semester-status",className:"cursor-pointer",children:d?"Active":"Inactive"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"startDate",children:"Start Date"}),e.jsx(W,{id:"startDate",type:"date",value:y,onChange:j=>f(j.target.value),required:d})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"endDate",children:"End Date"}),e.jsx(W,{id:"endDate",type:"date",value:p,onChange:j=>m(j.target.value),required:d})]})]}),e.jsxs(ze,{className:"pt-4",children:[e.jsx(He,{asChild:!0,children:e.jsx(q,{type:"button",variant:"outline",disabled:I,children:"Cancel"})}),e.jsx(q,{type:"submit",disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"mr-2 h-4 w-4 animate-spin"})," Saving..."]}):"Save Settings"})]})]})]})})}function Ks(){const[t,s]=u.useState([]),[r,a]=u.useState(!0),[o,n]=u.useState(""),[v,d]=u.useState("All Years"),[w,y]=u.useState("Active"),[f,p]=u.useState(null),[m,I]=u.useState(!1),[S,C]=u.useState(null),[j,i]=u.useState(!1),[x,N]=u.useState(!1),[g,E]=u.useState(!1),[U,c]=u.useState(0),[l,h]=u.useState(null),[R,O]=u.useState(null),[$,T]=u.useState(null),[F,Q]=u.useState(null),[re,Z]=u.useState({id:null,name:null}),le=Lr(),[se,ve]=u.useState(null),fe=u.useCallback(async(L=!0)=>{L&&a(!0);const P=localStorage.getItem("accessToken");if(!P){_.error("Authentication required."),a(!1),le("/facultyscheduler/user-login");return}try{const z=await de.get("/program",{headers:{Authorization:`Bearer ${P}`}}),Re=(Array.isArray(z.data.programs)?z.data.programs:Object.values(z.data.programs||{})).map(ee=>({id:ee.id,name:ee.program_name||"",abbreviation:ee.abbreviation||"",effectiveYear:`${ee.year_from}-${ee.year_to}`,total_subjects:ee.total_subjects||0,total_units:ee.total_units||0,isActive:ee.status===0,semesters:ee.semesters?Object.entries(ee.semesters).reduce((pe,[te,ce])=>(pe[te]={id:ce.id,subjects:(ce.subjects||[]).map(ue=>({id:ue.id,code:ue.subject_code,name:ue.des_title,unitsTotal:ue.total_units,unitsLec:ue.lec_units,unitsLab:ue.lab_units,hoursTotal:ue.total_hrs,hoursLec:ue.total_lec_hrs,hoursLab:ue.total_lab_hrs,prerequisite:ue.pre_requisite||""})),isActive:ce.status===1,startDate:ce.start_date,endDate:ce.end_date},pe),{}):{},subjects:ee.subjects||{}}));s(Re)}catch{_.error("Failed to fetch programs.")}finally{L&&a(!1)}},[le]);u.useEffect(()=>{fe(!0)},[fe]),u.useEffect(()=>{l&&h(null)},[l]),u.useEffect(()=>{R&&O(null)},[R]),u.useEffect(()=>{$&&T(null)},[$]);const et=(L,P,z)=>{ve({name:L,semester:P,effectiveYear:z})},ye=(L,P)=>{Z({id:L,name:P}),N(!0)},Ye=()=>{fe(!1),I(!1)},Ue=()=>{C(null),I(!0)},Ve=L=>{C(L),I(!0)},[ne,me]=u.useState(null),[ke,qe]=u.useState(!1),we=L=>{me({open:!0,title:"Archive Program",description:"This will move the program to the archives and make it inactive.",confirmText:"Yes, archive it!",confirmVariant:"destructive",onConfirm:async()=>{const P=localStorage.getItem("accessToken");if(!P){_.error("Authentication required.");return}try{const z=await de.post(`/archive-program/${L}`,{},{headers:{Authorization:`Bearer ${P}`}});_.success(z.data?.message||"Program archived successfully."),await fe(!1)}catch{_.error("Failed to archive program.")}}})},tt=L=>{me({open:!0,title:"Restore Program",description:"This will make the program active again.",confirmText:"Yes, restore it!",confirmVariant:"default",onConfirm:async()=>{const P=localStorage.getItem("accessToken");if(!P){_.error("Authentication required.");return}try{await de.post(`/restore-program/${L}`,{},{headers:{Authorization:`Bearer ${P}`}}),_.success("Program restored successfully."),await fe(!1)}catch{_.error("Failed to restore program.")}}})},rt=(L,P)=>{Q({semester:L,semesterId:P,subject:null}),E(!0)},D=(L,P)=>{const z=f?.semesters?.[L]?.id;Q({semester:L,semesterId:z,subject:P}),E(!0)},st=(L,P)=>{if(!P){_.error("Could not find subject ID to delete.");return}me({open:!0,title:"Delete Subject",description:"This will permanently delete this subject. This action cannot be reverted.",confirmText:"Yes, delete it!",confirmVariant:"destructive",onConfirm:async()=>{const z=localStorage.getItem("accessToken");if(!z){_.error("Authentication required.");return}try{await de.delete(`/subjects/${P}`,{headers:{Authorization:`Bearer ${z}`}}),_.success("Subject deleted successfully!"),c(je=>je+1),await fe(!1)}catch{_.error("Failed to delete subject.")}}})},nt=async(L,P,z,je)=>{if(!f){_.error("No program selected.");return}const Re=localStorage.getItem("accessToken");if(!Re){_.error("Authentication required.");return}try{const ee=P??f?.semesters?.[L]?.id;if(!je&&!ee){_.error("Semester ID not found.");return}const pe={subject_code:z.code,des_title:z.name,total_units:z.unitsTotal,lec_units:z.unitsLec,lab_units:z.unitsLab,total_hrs:z.hoursTotal,total_lec_hrs:z.hoursLec,total_lab_hrs:z.hoursLab,pre_requisite:z.prerequisite||null};let te;if(je){if(!z.id){_.error("Subject ID missing for update.");return}te=await de.put(`/subjects/${z.id}`,pe,{headers:{Authorization:`Bearer ${Re}`}}),_.success("Subject updated successfully.")}else te=await de.post(`/semesters/${ee}/subjects`,pe,{headers:{Authorization:`Bearer ${Re}`}}),_.success("Subject added successfully.");if(te.data?.subject){const ce={id:te.data.subject.id,code:te.data.subject.subject_code,name:te.data.subject.des_title,unitsTotal:te.data.subject.total_units,unitsLec:te.data.subject.lec_units,unitsLab:te.data.subject.lab_units,hoursTotal:te.data.subject.total_hrs,hoursLec:te.data.subject.total_lec_hrs,hoursLab:te.data.subject.total_lab_hrs,prerequisite:te.data.subject.pre_requisite||"None"};h({semesterName:L,subject:ce})}else c(ce=>ce+1);await fe(!1)}catch{_.error("The subject code has already been taken")}},We=L=>{O(L),fe(!1)},ut=(L,P)=>{T({name:L,semester:P}),ve(null)},dt=(L,P)=>{T({name:L,semester:{},newName:P})},Se=u.useMemo(()=>{const L=new Set(t.map(P=>P.effectiveYear));return["All Years",...Array.from(L).sort((P,z)=>z.localeCompare(P))]},[t]),Xe=u.useMemo(()=>t.filter(L=>L.name.toLowerCase().includes(o.toLowerCase())||L.abbreviation.toLowerCase().includes(o.toLowerCase())).filter(L=>v==="All Years"||L.effectiveYear===v).filter(L=>w==="All"?!0:w==="Active"?L.isActive:!L.isActive),[t,o,v,w]);return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground tracking-tight",children:"Curriculum Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage academic programs, semesters, and their subjects."})]}),e.jsx("div",{className:"bg-card p-4 md:p-6 rounded-lg shadow-sm border border-border mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[e.jsxs("div",{className:"relative w-full md:flex-grow",children:[e.jsx(Fr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(W,{type:"text",placeholder:"Search program...",className:"pl-10 w-full",value:o,onChange:L=>n(L.target.value)})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto",children:[e.jsxs(Le,{value:v,onValueChange:d,children:[e.jsxs(Ee,{className:"w-full sm:w-auto md:w-[180px]",children:[e.jsx(qt,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx(Ae,{placeholder:"Filter by A.Y."})]}),e.jsx(_e,{children:Se.map(L=>e.jsx(ge,{value:L,children:L},L))})]}),e.jsxs(Le,{value:w,onValueChange:y,children:[e.jsxs(Ee,{className:"w-full sm:w-auto md:w-[180px]",children:[e.jsx(Hr,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx(Ae,{placeholder:"Filter by Status"})]}),e.jsxs(_e,{children:[e.jsx(ge,{value:"All",children:"All"}),e.jsx(ge,{value:"Active",children:"Active"}),e.jsx(ge,{value:"Inactive",children:"Inactive"})]})]}),e.jsxs(q,{onClick:Ue,className:"w-full sm:w-auto",children:[e.jsx(Lt,{size:16,className:"mr-2"})," Add Program"]})]})]})}),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:3}).map((L,P)=>e.jsx(es,{},P))}):e.jsx(Er,{children:Xe.length>0?e.jsx(bt.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Xe.map((L,P)=>e.jsx(Zr,{program:L,index:P,onEdit:Ve,onArchive:we,onRestore:tt,onManage:()=>p(L)},L.id))}):e.jsxs(bt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-20 text-muted-foreground",children:[e.jsx(Ur,{size:56,className:"mx-auto mb-4"}),e.jsx("h4",{className:"font-semibold text-xl text-foreground",children:"No Programs Found"}),e.jsx("p",{children:"Try adjusting your filters or add a new program."})]})}),e.jsx(Is,{isOpen:m,onClose:()=>I(!1),onSave:Ye,initialData:S}),ne&&e.jsx(Oe,{open:ne.open,onOpenChange:L=>!L&&me(null),children:e.jsxs($e,{children:[e.jsxs(Me,{children:[e.jsx(Fe,{children:ne.title}),ne.description&&e.jsx(lt,{children:ne.description})]}),e.jsxs(ze,{children:[e.jsx(He,{asChild:!0,children:e.jsx(q,{variant:"outline",disabled:ke,children:"Cancel"})}),e.jsx(q,{onClick:async()=>{if(ne?.onConfirm){qe(!0);try{await ne.onConfirm()}finally{qe(!1),me(null)}}},disabled:ke,variant:ne.confirmVariant,children:ke?"Processing...":ne.confirmText||"Confirm"})]})]})}),f&&e.jsx(Rs,{isOpen:!!f,onClose:()=>p(null),program:f,onAddSemester:()=>i(!0),onEditSemester:ye,onDeleteSemester:()=>{},onAddSubject:rt,onEditSubject:D,onDeleteSubject:st,onSetSemesterStatus:et,refreshKey:U,updatedSubjectData:l,newSemesterData:R,updatedSemesterData:$}),e.jsx($s,{isOpen:j,onClose:()=>i(!1),onSave:We,programId:f?f.id:0}),e.jsx(zs,{isOpen:x,onClose:()=>N(!1),onSaveSuccess:dt,semesterId:re.id,initialData:re.name||""}),F&&e.jsx(Hs,{isOpen:g,onClose:()=>E(!1),onSave:(L,P)=>nt(F.semester,F.semesterId,L,P),initialData:F.subject,programId:f?.id??0,semesterName:F.semester||"",semesterId:F.semesterId}),se&&e.jsx(Xs,{isOpen:!!se,onClose:()=>ve(null),onSaveSuccess:ut,semesterId:se.semester?.id||null,semesterName:se.name||"",initialData:se.semester||null,effectiveYear:se.effectiveYear})]})}function pn(){return e.jsx("main",{children:e.jsx(Ks,{})})}export{pn as default};
