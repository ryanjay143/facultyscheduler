import{c as N,r as o,j as e,m as U,U as ne,B as A,C as ie,a as R,R as oe,k as ce,i as de,A as me}from"./index-B66EeEgd.js";import{S as M}from"./sweetalert2.esm.all-ePrzfkxH.js";import{I as Y}from"./input-DhzeSTir.js";import{B as z}from"./badge-DlinDbuf.js";import{C as ue}from"./circle-plus-BgYd7LoS.js";import{S as j,L as xe}from"./skeleton-BZaSUgJF.js";import{D as Q,a as X,b as q,c as G,d as Z,e as he,f as fe}from"./dialog-D2hvU-cR.js";import{C as pe,S as ge}from"./sparkles-Cyeu4tXL.js";import{S as J}from"./search-_FKDntRC.js";import{C as je}from"./circle-check-big-BWZKIQBc.js";import{C as be}from"./calendar-x-2-DqZooqZ6.js";import"./Combination-DnarODhh.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ve=N("info",ye);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"m19 10-4 4",key:"1tz659"}],["path",{d:"m15 10 4 4",key:"1n7nei"}]],we=N("list-x",Ne);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],ke=N("list",Se);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M22 14a8 8 0 0 1-8 8",key:"56vcr3"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1agjmk"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1",key:"wdbh2u"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10",key:"1ibuk9"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"g6ys72"}]],Ae=N("pointer",Ce);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"m13.5 8.5-5 5",key:"1cs55j"}],["path",{d:"m8.5 8.5 5 5",key:"a8mexj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],_e=N("search-x",$e);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Fe=N("star",Me),Te={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:400,damping:30}}},_=["bg-sky-100 text-sky-800","bg-teal-100 text-teal-800","bg-violet-100 text-violet-800","bg-amber-100 text-amber-800","bg-rose-100 text-rose-800"];function Ee({faculty:s,onAssignClick:n,onViewSubjectsClick:a}){const[r,l]=o.useState(!1),i=`https://green-deer-882383.hostingersite.com/${s.profile_picture}`;return e.jsxs(U.div,{variants:Te,className:"bg-white rounded-xl overflow-hidden shadow-lg hover:shadow-primary/20 transition-all duration-300 border border-transparent hover:border-primary/30 group flex",children:[e.jsxs("div",{className:"relative flex-shrink-0 w-1/3 bg-slate-50 flex items-center justify-center p-6",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-primary/5 to-transparent transform -skew-x-12 -ml-8"}),e.jsx("div",{className:"relative z-10",children:r?e.jsx("div",{className:"w-24 h-24 rounded-full bg-slate-200 flex items-center justify-center border-4 border-white shadow-md",children:e.jsx(ne,{className:"w-12 h-12 text-slate-400"})}):e.jsx("img",{src:i,alt:`Profile of ${s.name}`,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-md group-hover:scale-105 transition-transform duration-300",onError:()=>l(!0)})})]}),e.jsxs("div",{className:"flex-grow flex flex-col p-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-foreground tracking-tight group-hover:text-primary transition-colors",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Computer Science Department"})]}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsx(Fe,{className:"w-3.5 h-3.5 text-amber-400 flex-shrink-0"}),e.jsx("h4",{className:"text-[10px] font-semibold uppercase text-slate-500 tracking-wider",children:"AREAS OF EXPERTISE"})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 min-h-[44px]",children:s.expertise.length>0?s.expertise.slice(0).map((m,d)=>e.jsx(z,{className:`border-transparent font-medium text-[11px] px-2 py-0.5 rounded-full hover:${_[d%_.length]} ${_[d%_.length]}`,children:m},m)):e.jsx("p",{className:"text-xs text-slate-500 italic px-1",children:"No expertise listed."})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsxs(A,{className:"w-full font-semibold transition-transform hover:scale-105",size:"sm",onClick:()=>n(s),children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Assign subjects"]}),e.jsxs(A,{className:"w-full font-semibold transition-transform hover:scale-105",size:"sm",variant:"ghost",onClick:()=>a(s),children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"View subjects"]})]})]})]})}function Le(){return e.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-lg border flex",children:[e.jsx("div",{className:"relative flex-shrink-0 w-1/3 bg-slate-50 flex items-center justify-center p-6",children:e.jsx(j,{className:"w-24 h-24 rounded-full"})}),e.jsxs("div",{className:"flex-grow flex flex-col p-5 w-2/3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{className:"h-6 w-4/5"}),e.jsx(j,{className:"h-4 w-3/5"})]}),e.jsx("div",{className:"flex-grow"}),e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsx(j,{className:"h-3 w-1/3"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(j,{className:"h-5 w-20 rounded-full"}),e.jsx(j,{className:"h-5 w-24 rounded-full"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx(j,{className:"h-9 w-full rounded-md"}),e.jsx(j,{className:"h-9 w-full rounded-md"})]})]})]})}const Ie=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],V=s=>{if(!s||!s.includes(":"))return"Invalid Time";const[n,a]=s.split(":");let r=parseInt(n,10);const l=r>=12?"PM":"AM";return r=r%12||12,`${r}:${a} ${l}`};function Oe({schedule:s}){const n=new Date().toLocaleString("en-US",{weekday:"long"});return e.jsx("div",{className:"bg-background p-2 rounded-lg border max-h-64 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 gap-2",children:Ie.map(a=>{const r=s[a],l=r&&r.length>0,i=a===n;return e.jsxs("div",{className:`rounded-md p-3 flex flex-col min-h-[80px] transition-all duration-200 ${i?"bg-primary/10 border-2 border-primary/80":"bg-muted/50 border border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:`font-bold text-sm ${i?"text-primary":"text-foreground"}`,children:a}),i&&e.jsx(z,{variant:"default",className:"text-[10px] h-5",children:"TODAY"})]}),l?e.jsx("div",{className:"space-y-1.5 flex-grow",children:r.map((m,d)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0"}),e.jsxs("p",{className:"font-mono text-xs text-foreground font-medium",children:[V(m.start)," - ",V(m.end)]})]},d))}):e.jsxs("div",{className:"flex flex-col items-center justify-center flex-grow text-center text-slate-400",children:[e.jsx(pe,{className:"h-5 w-5 mb-1"}),e.jsx("p",{className:"text-xs italic",children:"Not available"})]})]},a)})})})}const W=s=>{if(!s||!s.includes(":"))return"Invalid";const[n,a]=s.split(":");let r=parseInt(n,10);const l=r>=12?"PM":"AM";return r=r%12||12,`${r}:${a} ${l}`},B=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function De({isOpen:s,onClose:n,faculty:a,availableSubjects:r,onAssign:l}){const[i,m]=o.useState(""),[d,f]=o.useState(null),[u,g]=o.useState(""),[p,b]=o.useState(""),[h,w]=o.useState({}),[y,v]=o.useState(!0);o.useEffect(()=>{s&&a&&(async()=>{v(!0),g(""),b(""),f(null);const c=localStorage.getItem("accessToken");if(!c){v(!1);return}try{const x=await R.get(`/faculties/${a.id}/availability`,{headers:{Authorization:`Bearer ${c}`}});w(x.data)}catch(x){console.error("Could not fetch faculty schedule",x),w({})}finally{v(!1)}})()},[s,a]),o.useEffect(()=>{if(!y&&Object.keys(h).length>0){const t=B.find(c=>h[c]?.length>0);if(t){g(t);const c=h[t][0];c&&b(`${c.start}-${c.end}`)}}},[y,h]);const S=o.useMemo(()=>i.trim()?r.filter(t=>t.subject_code.toLowerCase().includes(i.toLowerCase())||t.des_title.toLowerCase().includes(i.toLowerCase())):r,[r,i]),k=o.useMemo(()=>!u||!h[u]?[]:h[u].map(t=>`${t.start}-${t.end}`),[u,h]),T=t=>{g(t);const c=h[t]?.[0];b(c?`${c.start}-${c.end}`:"")},E=()=>{!d||!u||!p||(l(a.id,d,{day:u,time:p}),n())},L=()=>{n()},I=()=>{M.fire({icon:"info",title:"AI Suggestions",text:"Generating subject recommendations based on faculty expertise...",timer:2500,showConfirmButton:!1})},O=Object.values(h).some(t=>t.length>0);return e.jsx(Q,{open:s,onOpenChange:L,children:e.jsxs(X,{className:"max-w-5xl h-[90vh] flex flex-col p-0",children:[e.jsxs(q,{className:"p-6 pb-4",children:[e.jsxs(G,{className:"text-2xl font-bold tracking-tight",children:["Assign Subject to ",a.name]}),e.jsx(Z,{children:"Follow the steps below to search, select, and schedule a subject for this faculty member."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 px-6 pb-6 flex-grow overflow-y-auto",children:[e.jsxs("div",{className:"bg-muted/40 p-4 rounded-lg flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-primary text-primary-foreground h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg",children:"1"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Select a Subject"})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx(Y,{placeholder:"Search subjects...",value:i,onChange:t=>m(t.target.value),className:"pl-10 bg-background"})]}),e.jsxs(A,{variant:"outline",onClick:I,children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Generate"]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 -mr-2 pr-2",children:S.length>0?S.map(t=>e.jsxs("button",{onClick:()=>f(t.id),className:`w-full text-left p-3 rounded-md border transition-all duration-200 relative ${d===t.id?"bg-primary/10 border-primary shadow-sm":"bg-background hover:border-primary/50 hover:bg-primary/5"}`,children:[d===t.id&&e.jsx(je,{className:"h-5 w-5 text-primary absolute top-3 right-3"}),e.jsxs("p",{className:"font-semibold text-foreground pr-6",children:[t.subject_code," - ",t.des_title]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Units: ",t.total_units]})]},t.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground rounded-lg bg-background border-2 border-dashed p-4",children:[e.jsx(_e,{className:"h-10 w-10 mb-3"}),e.jsx("p",{className:"font-semibold text-foreground",children:"No Subjects Found"}),i?e.jsxs("p",{className:"text-sm",children:['Your search for "',i,'" did not match any subjects.']}):e.jsx("p",{className:"text-sm",children:"There are no relevant subjects available for this faculty or please generate."})]})})]}),e.jsxs("div",{className:"bg-muted/40 p-4 rounded-lg flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg ${d?"bg-primary text-primary-foreground":"bg-muted-foreground/30 text-muted-foreground"}`,children:"2"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Set Schedule"})]}),d?y?e.jsx("div",{className:"flex items-center justify-center h-full bg-background rounded-lg",children:e.jsx(xe,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-4 flex-grow flex flex-col",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{className:"block text-sm font-semibold text-foreground mb-2",children:"Faculty's Weekly Availability"}),e.jsx(Oe,{schedule:h})]}),O?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"day",className:"block text-sm font-semibold text-foreground mb-1",children:"Day of Class"}),e.jsx("select",{id:"day",value:u,onChange:t=>T(t.target.value),className:"w-full p-2 border rounded-md bg-background disabled:opacity-50",children:B.map(t=>{const c=h[t]?.length>0;return e.jsxs("option",{value:t,disabled:!c,children:[t," ",!c&&"(Unavailable)"]},t)})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"time",className:"block text-sm font-semibold text-foreground mb-1",children:"Time of Class"}),e.jsx("select",{id:"time",value:p,onChange:t=>b(t.target.value),className:"w-full p-2 border rounded-md bg-background disabled:opacity-50",disabled:k.length===0,children:k.map(t=>{const[c,x]=t.split("-");return e.jsxs("option",{value:t,children:[W(c)," - ",W(x)]},t)})})]})]}):e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-destructive/10 border border-destructive/30 rounded-lg text-destructive",children:[e.jsx(be,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("p",{className:"text-sm font-medium",children:"This faculty has no availability set and cannot be assigned subjects."})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground rounded-lg bg-background border-2 border-dashed",children:[e.jsx(Ae,{className:"h-10 w-10 mb-3"}),e.jsx("p",{className:"font-semibold text-foreground",children:"Waiting for Subject Selection"}),e.jsx("p",{className:"text-sm",children:"Please select a subject from the list on the left."})]})]})]}),e.jsxs(he,{className:"p-6 pt-4 border-t bg-background",children:[e.jsx(fe,{asChild:!0,children:e.jsx(A,{variant:"outline",children:"Cancel"})}),e.jsx(A,{onClick:E,disabled:!d||!u||!p,children:"Assign Subject"})]})]})})}var Pe=Symbol.for("react.lazy"),F=oe[" use ".trim().toString()];function Re(s){return typeof s=="object"&&s!==null&&"then"in s}function K(s){return s!=null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===Pe&&"_payload"in s&&Re(s._payload)}function ze(s){const n=Ve(s),a=o.forwardRef((r,l)=>{let{children:i,...m}=r;K(i)&&typeof F=="function"&&(i=F(i._payload));const d=o.Children.toArray(i),f=d.find(Be);if(f){const u=f.props.children,g=d.map(p=>p===f?o.Children.count(u)>1?o.Children.only(null):o.isValidElement(u)?u.props.children:null:p);return e.jsx(n,{...m,ref:l,children:o.isValidElement(u)?o.cloneElement(u,void 0,g):null})}return e.jsx(n,{...m,ref:l,children:i})});return a.displayName=`${s}.Slot`,a}function Ve(s){const n=o.forwardRef((a,r)=>{let{children:l,...i}=a;if(K(l)&&typeof F=="function"&&(l=F(l._payload)),o.isValidElement(l)){const m=Ue(l),d=He(i,l.props);return l.type!==o.Fragment&&(d.ref=r?ce(r,m):m),o.cloneElement(l,d)}return o.Children.count(l)>1?o.Children.only(null):null});return n.displayName=`${s}.SlotClone`,n}var We=Symbol("radix.slottable");function Be(s){return o.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===We}function He(s,n){const a={...n};for(const r in n){const l=s[r],i=n[r];/^on[A-Z]/.test(r)?l&&i?a[r]=(...d)=>{const f=i(...d);return l(...d),f}:l&&(a[r]=l):r==="style"?a[r]={...l,...i}:r==="className"&&(a[r]=[l,i].filter(Boolean).join(" "))}return{...s,...a}}function Ue(s){let n=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,a=n&&"isReactWarning"in n&&n.isReactWarning;return a?s.ref:(n=Object.getOwnPropertyDescriptor(s,"ref")?.get,a=n&&"isReactWarning"in n&&n.isReactWarning,a?s.props.ref:s.props.ref||s.ref)}var Ye=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Qe=Ye.reduce((s,n)=>{const a=ze(`Primitive.${n}`),r=o.forwardRef((l,i)=>{const{asChild:m,...d}=l,f=m?a:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...d,ref:i})});return r.displayName=`Primitive.${n}`,{...s,[n]:r}},{}),Xe="Separator",H="horizontal",qe=["horizontal","vertical"],ee=o.forwardRef((s,n)=>{const{decorative:a,orientation:r=H,...l}=s,i=Ge(r)?r:H,d=a?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(Qe.div,{"data-orientation":i,...d,...l,ref:n})});ee.displayName=Xe;function Ge(s){return qe.includes(s)}var se=ee;const te=o.forwardRef(({className:s,orientation:n="horizontal",decorative:a=!0,...r},l)=>e.jsx(se,{ref:l,decorative:a,orientation:n,className:de("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));te.displayName=se.displayName;function Ze({isOpen:s,onClose:n,faculty:a}){if(!a)return null;const r=a.assignedSubjects&&a.assignedSubjects.length>0;return e.jsx(Q,{open:s,onOpenChange:n,children:e.jsxs(X,{className:"sm:max-w-lg",children:[e.jsxs(q,{children:[e.jsx(G,{className:"text-2xl",children:"Assigned Subjects"}),e.jsxs(Z,{children:["Viewing schedule for ",e.jsx("span",{className:"font-semibold text-primary",children:a.name}),"."]})]}),e.jsx("div",{className:"mt-4 max-h-[60vh] overflow-y-auto pr-2",children:r?e.jsx("ul",{className:"space-y-4",children:a.assignedSubjects.map((l,i)=>e.jsxs("li",{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:l.des_title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.subject_code})]}),e.jsx(z,{variant:"secondary",className:"font-mono text-xs",children:l.schedule.time})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Schedule: ",e.jsx("span",{className:"font-medium text-foreground",children:l.schedule.day})]}),i<a.assignedSubjects.length-1&&e.jsx(te,{className:"mt-4"})]},l.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center text-muted-foreground bg-muted/50 rounded-lg",children:[e.jsx(we,{size:40,className:"mb-4 text-slate-500"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"No Subjects Assigned"}),e.jsx("p",{className:"text-sm",children:"This faculty member does not have any subjects yet."})]})})]})})}const Je={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.08}}};function Ke(){const[s,n]=o.useState([]),[a,r]=o.useState([]),[l,i]=o.useState([]),[m,d]=o.useState(""),[f,u]=o.useState(!0),[g,p]=o.useState(!1),[b,h]=o.useState(null),[w,y]=o.useState(!1),[v,S]=o.useState(null);o.useEffect(()=>{(async()=>{u(!0);try{const c=localStorage.getItem("accessToken");if(!c){M.fire({icon:"warning",title:"Authentication Error",text:"You must be logged in."}),u(!1);return}const x={headers:{Authorization:`Bearer ${c}`}},[$,D]=await Promise.all([R.get("/faculties",x),R.get("/get-subjects",x)]),P=[{id:101,subject_code:"CS 101",des_title:"Intro to Programming",schedule:{day:"MWF",time:"10:00 - 11:00 AM"}},{id:102,subject_code:"IT 203",des_title:"Database Systems",schedule:{day:"TTH",time:"1:00 - 2:30 PM"}}],ae=$.data.faculties.map((C,re)=>({id:C.id,name:C.user.name,expertise:C.expertises.map(le=>le.list_of_expertise),availability:{},maxUnits:C.t_load_units,assignedSubjects:re===0?P:[],profile_picture:C.profile_picture}));n(ae),r(D.data.subject||[])}catch(c){console.error("Error fetching data:",c),M.fire({icon:"error",title:"Fetch Error",text:"Failed to retrieve data from the server."})}finally{u(!1)}})()},[]);const k=s.filter(t=>t.name.toLowerCase().includes(m.toLowerCase())||t.expertise.some(c=>c.toLowerCase().includes(m.toLowerCase()))),T=t=>{const c=t.expertise.map(x=>x.toLowerCase().trim());if(c.length===0)i(a);else{const x=a.filter($=>{const D=`${$.des_title} ${$.subject_code}`.toLowerCase();return c.some(P=>D.includes(P))});i(x)}h(t),p(!0)},E=()=>{p(!1),h(null),i([])},L=t=>{S(t),y(!0)},I=()=>{y(!1),S(null)},O=(t,c,x)=>{console.log("Assigning Subject:",{facultyId:t,subjectId:c,schedule:x}),M.fire({icon:"success",title:"Assignment Recorded",text:`Subject ${c} assigned to faculty ${t} on ${x.day} at ${x.time}.`,timer:2e3,showConfirmButton:!1})};return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[g&&b&&e.jsx(De,{isOpen:g,onClose:E,faculty:b,availableSubjects:l,onAssign:O}),w&&v&&e.jsx(Ze,{isOpen:w,onClose:I,faculty:v})]}),e.jsxs("header",{className:"mb-8 text-start",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground tracking-tight",children:"Faculty Loading"}),e.jsx("p",{className:"text-muted-foreground mt-3 ",children:"Assign subjects to faculty based on expertise and availability."})]}),e.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-sm border border-border",children:[e.jsx("div",{className:"flex justify-start mb-8",children:e.jsxs("div",{className:"relative w-full md:max-w-lg",children:[e.jsx(J,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(Y,{placeholder:"Search by faculty name or expertise...",value:m,onChange:t=>d(t.target.value),className:"pl-12 h-12 rounded-full text-base"})]})}),f?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Array.from({length:6}).map((t,c)=>e.jsx(Le,{},c))}):k.length>0?e.jsx(U.div,{variants:Je,initial:"hidden",animate:"visible",className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:k.map(t=>e.jsx(Ee,{faculty:t,onAssignClick:T,onViewSubjectsClick:L},t.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center text-muted-foreground bg-muted/50 rounded-lg border-2 border-dashed",children:[e.jsx(ve,{size:40,className:"mb-4 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"No Faculty Found"}),e.jsxs("p",{children:['Your search for "',m,'" did not match any faculty profiles.']})]})]})]})}function us(){return e.jsx("main",{children:e.jsx(Ke,{})})}export{us as default};
