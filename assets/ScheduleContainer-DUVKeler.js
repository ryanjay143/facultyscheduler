import{c as H,r as a,j as e,m as ue,U as Ce,B,C as ke,a as W,t as se,R as Te,k as $e,i as Ae,A as Le}from"./index-BuWw9RbP.js";import{S as te}from"./sweetalert2.esm.all-ePrzfkxH.js";import{I as J}from"./input-yEXRpp2T.js";import{B as ae}from"./badge-Dn7R22eS.js";import{C as Ee}from"./circle-plus-BZrtEclA.js";import{S as $,D as xe,a as he,b as fe,c as ge,d as pe,L as ce,e as Fe,f as Me}from"./dialog-CGt3SlMK.js";import{C as Re,S as Ie}from"./sparkles-BkYVtqzf.js";import{L as Q}from"./label-oBnjPk7O.js";import{C as X}from"./check-DwbWxxFu.js";import{S as be}from"./search-C5McUNk5.js";import{C as De}from"./circle-check-big-BvtuIthf.js";import{C as Oe}from"./calendar-x-2-C9tU_N2U.js";import{T as ze}from"./triangle-alert-DtfoSuJb.js";import"./Combination-F2TzrIMg.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ve=H("info",Pe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"m19 10-4 4",key:"1tz659"}],["path",{d:"m15 10 4 4",key:"1n7nei"}]],We=H("list-x",Be);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Ue=H("list",He);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"m13.5 8.5-5 5",key:"1cs55j"}],["path",{d:"m8.5 8.5 5 5",key:"a8mexj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],qe=H("search-x",Ye);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Xe=H("star",Qe),Ge={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:400,damping:30}}},G=["bg-sky-100 text-sky-800","bg-teal-100 text-teal-800","bg-violet-100 text-violet-800","bg-amber-100 text-amber-800","bg-rose-100 text-rose-800"];function Ze({faculty:t,onAssignClick:i,onViewSubjectsClick:r}){const[o,n]=a.useState(!1),c=`https://green-deer-882383.hostingersite.com/${t.profile_picture}`;return e.jsxs(ue.div,{variants:Ge,className:"bg-white rounded-xl overflow-hidden shadow-lg hover:shadow-primary/20 transition-all duration-300 border border-transparent hover:border-primary/30 group flex",children:[e.jsxs("div",{className:"relative flex-shrink-0 w-1/3 bg-slate-50 flex items-center justify-center p-6",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-primary/5 to-transparent transform -skew-x-12 -ml-8"}),e.jsx("div",{className:"relative z-10",children:o?e.jsx("div",{className:"w-24 h-24 rounded-full bg-slate-200 flex items-center justify-center border-4 border-white shadow-md",children:e.jsx(Ce,{className:"w-12 h-12 text-slate-400"})}):e.jsx("img",{src:c,alt:`Profile of ${t.name}`,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-md group-hover:scale-105 transition-transform duration-300",onError:()=>n(!0)})})]}),e.jsxs("div",{className:"flex-grow flex flex-col p-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-foreground tracking-tight group-hover:text-primary transition-colors",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Computer Science Department"})]}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsx(Xe,{className:"w-3.5 h-3.5 text-amber-400 flex-shrink-0"}),e.jsx("h4",{className:"text-[10px] font-semibold uppercase text-slate-500 tracking-wider",children:"AREAS OF EXPERTISE"})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 min-h-[44px]",children:t.expertise.length>0?t.expertise.slice(0).map((h,x)=>e.jsx(ae,{className:`border-transparent font-medium text-[11px] px-2 py-0.5 rounded-full hover:${G[x%G.length]} ${G[x%G.length]}`,children:h},h)):e.jsx("p",{className:"text-xs text-slate-500 italic px-1",children:"No expertise listed."})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsxs(B,{className:"w-full font-semibold transition-transform hover:scale-105",size:"sm",onClick:()=>i(t),children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Assign subjects"]}),e.jsxs(B,{className:"w-full font-semibold transition-transform hover:scale-105",size:"sm",variant:"ghost",onClick:()=>r(t),children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"View subjects"]})]})]})]})}function Je(){return e.jsxs("div",{className:"bg-white rounded-xl overflow-hidden shadow-lg border flex",children:[e.jsx("div",{className:"relative flex-shrink-0 w-1/3 bg-slate-50 flex items-center justify-center p-6",children:e.jsx($,{className:"w-24 h-24 rounded-full"})}),e.jsxs("div",{className:"flex-grow flex flex-col p-5 w-2/3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{className:"h-6 w-4/5"}),e.jsx($,{className:"h-4 w-3/5"})]}),e.jsx("div",{className:"flex-grow"}),e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsx($,{className:"h-3 w-1/3"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx($,{className:"h-5 w-20 rounded-full"}),e.jsx($,{className:"h-5 w-24 rounded-full"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx($,{className:"h-9 w-full rounded-md"}),e.jsx($,{className:"h-9 w-full rounded-md"})]})]})]})}const Ke=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],de=t=>{if(!t||!t.includes(":"))return"Invalid Time";const[i,r]=t.split(":");let o=parseInt(i,10);const n=o>=12?"PM":"AM";return o=o%12||12,`${o}:${r} ${n}`};function es({schedule:t}){const i=new Date().toLocaleString("en-US",{weekday:"long"});return e.jsx("div",{className:"bg-background p-2 rounded-lg border max-h-64 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 gap-2",children:Ke.map(r=>{const o=t[r],n=o&&o.length>0,c=r===i;return e.jsxs("div",{className:`rounded-md p-3 flex flex-col min-h-[80px] transition-all duration-200 ${c?"bg-primary/10 border-2 border-primary/80":"bg-muted/50 border border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:`font-bold text-sm ${c?"text-primary":"text-foreground"}`,children:r}),c&&e.jsx(ae,{variant:"default",className:"text-[10px] h-5",children:"TODAY"})]}),n?e.jsx("div",{className:"space-y-1.5 flex-grow",children:o.map((h,x)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0"}),e.jsxs("p",{className:"font-mono text-xs text-foreground font-medium",children:[de(h.start)," - ",de(h.end)]})]},x))}):e.jsxs("div",{className:"flex flex-col items-center justify-center flex-grow text-center text-slate-400",children:[e.jsx(Re,{className:"h-5 w-5 mb-1"}),e.jsx("p",{className:"text-xs italic",children:"Not available"})]})]},r)})})})}const Z=t=>{if(!t)return 0;const[i,r]=t.split(":").map(Number);return i*60+r},ss=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function ts({isOpen:t,onClose:i,faculty:r,availableSubjects:o=[],onAssign:n}){const[c,h]=a.useState(1),[x,w]=a.useState(""),[l,A]=a.useState(null),[u,D]=a.useState({lec:{day:"",startTime:"",endTime:""},lab:{day:"",startTime:"",endTime:""}}),[_,M]=a.useState({lec:null,lab:null}),[O,L]=a.useState({lec:[],lab:[]}),[U,R]=a.useState({lec:!1,lab:!1}),[k,Y]=a.useState({lec:null,lab:null}),[C,q]=a.useState({}),[ee,g]=a.useState(!0),j=()=>{h(1),w(""),A(null),D({lec:{day:"",startTime:"",endTime:""},lab:{day:"",startTime:"",endTime:""}}),M({lec:null,lab:null}),L({lec:[],lab:[]}),Y({lec:null,lab:null})};a.useEffect(()=>{t&&r&&(async()=>{j(),g(!0);const m=localStorage.getItem("accessToken");if(!m){g(!1);return}try{const f=await W.get(`/faculties/${r.id}/availability`,{headers:{Authorization:`Bearer ${m}`}});q(f.data)}catch{q({})}finally{g(!1)}})()},[t,r]),a.useEffect(()=>{l&&h(2)},[l]),a.useEffect(()=>{const s=(m,f)=>{const{day:d,startTime:N,endTime:T}=u[m];if(!N||!T||!l||!d||f===0)return null;const p=Z(N),S=Z(T),F=f*60,_e=S-p;if(p>=S)return"End time must be after start time.";if(_e>F)return`Duration cannot exceed ${f} hour(s). You may schedule shorter sessions as long as they do not exceed the total required hours.`;const oe=C[d];return oe?.length?oe.some(ne=>p>=Z(ne.start)&&S<=Z(ne.end))?null:"Time is outside faculty's availability.":"Faculty is not available on this day."};l&&Y({lec:s("lec",l.total_lec_hrs??0),lab:s("lab",l.total_lab_hrs??0)})},[u,l,C]);const y=a.useCallback(async s=>{const m=u[s];if(!m.day||!m.startTime||!m.endTime||k[s]){L(d=>({...d,[s]:[]}));return}R(d=>({...d,[s]:!0}));const f=localStorage.getItem("accessToken");if(!f){R(d=>({...d,[s]:!1}));return}try{const N=(await W.get("/rooms/availability",{headers:{Authorization:`Bearer ${f}`},params:{day:m.day,startTime:m.startTime,endTime:m.endTime,type:s==="lec"?"Lecture":"Laboratory"}})).data.rooms||[],T=await Promise.all(N.map(async p=>{try{const S=await W.get(`/rooms/${p.id}/availabilities`,{headers:{Authorization:`Bearer ${f}`}});return{...p,availabilities:S.data.availabilities||[]}}catch{return{...p,availabilities:[]}}}));L(p=>({...p,[s]:T}))}catch{se.error(`Failed to fetch available ${s} rooms.`),L(N=>({...N,[s]:[]}))}finally{R(d=>({...d,[s]:!1}))}},[u,k]),v=a.useMemo(()=>(l?.total_lec_hrs??0)>0?u.lec.day&&u.lec.startTime&&u.lec.endTime&&!k.lec:!0,[u.lec,k.lec,l]),b=a.useMemo(()=>(l?.total_lab_hrs??0)>0?u.lab.day&&u.lab.startTime&&u.lab.endTime&&!k.lab:!0,[u.lab,k.lab,l]);a.useEffect(()=>{v&&(l?.total_lec_hrs??0)>0&&y("lec")},[v,u.lec,l,y]),a.useEffect(()=>{b&&(l?.total_lab_hrs??0)>0&&y("lab")},[b,u.lab,l,y]),a.useEffect(()=>{v&&b&&l?h(3):l&&h(2)},[v,b,l]);const I=a.useMemo(()=>x.trim()?o.filter(s=>s.subject_code.toLowerCase().includes(x.toLowerCase())||s.des_title.toLowerCase().includes(x.toLowerCase())):o,[o,x]),z=(s,m,f)=>{D(d=>({...d,[s]:{...d[s],[m]:f}})),M(d=>({...d,[s]:null}))},E=()=>{if(!l)return;const s=[];if((l.total_lec_hrs??0)>0){const{day:m,startTime:f,endTime:d}=u.lec;if(!m||!f||!d||!_.lec){se.error("Incomplete lecture schedule or room selection.");return}s.push({type:"LEC",day:m,time:`${f}-${d}`,roomId:_.lec})}if((l.total_lab_hrs??0)>0){const{day:m,startTime:f,endTime:d}=u.lab;if(!m||!f||!d||!_.lab){se.error("Incomplete laboratory schedule or room selection.");return}s.push({type:"LAB",day:m,time:`${f}-${d}`,roomId:_.lab})}n(r.id,l.id,s),i()},P=(l?.total_lec_hrs??0)>0?!!_.lec:!0,V=(l?.total_lab_hrs??0)>0?!!_.lab:!0,we=!l||!v||!b||!P||!V,Se=Object.values(C).some(s=>s.length>0),re=({type:s,hours:m})=>{const f=a.useMemo(()=>{const d=u[s].day;if(!d||!C[d]?.length)return{min:void 0,max:void 0};const N=C[d],T=N.reduce((S,F)=>F.start<S?F.start:S,N[0].start),p=N.reduce((S,F)=>F.end>S?F.end:S,N[0].end);return{min:T,max:p}},[u[s].day,C]);return e.jsxs("div",{className:"pt-4 border-t space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-md text-foreground",children:[s==="lec"?"Lecture":"Laboratory"," Schedule (",m," hours)"]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx(Q,{htmlFor:`${s}-day`,children:"Day of Class"}),e.jsxs("select",{id:`${s}-day`,value:u[s].day,onChange:d=>z(s,"day",d.target.value),className:"w-full mt-1 p-2 border rounded-md bg-background disabled:opacity-50",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a day"}),ss.map(d=>e.jsxs("option",{value:d,disabled:!C[d]?.length,children:[d," ",!C[d]?.length&&"(Unavailable)"]},d))]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:`${s}-start-time`,children:"Start Time"}),e.jsx(J,{id:`${s}-start-time`,type:"time",value:u[s].startTime,onChange:d=>z(s,"startTime",d.target.value),className:"mt-1",step:"1800",min:f.min,max:f.max,disabled:!u[s].day})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:`${s}-end-time`,children:"End Time"}),e.jsx(J,{id:`${s}-end-time`,type:"time",value:u[s].endTime,onChange:d=>z(s,"endTime",d.target.value),className:"mt-1",step:"1800",min:f.min,max:f.max,disabled:!u[s].day})]})]}),k[s]&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-destructive/10 border-destructive/30 rounded-lg text-destructive text-sm",children:[e.jsx(ze,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("p",{children:k[s]})]})]})},le=s=>{if(!s)return"";const m=s.split(":");return m.length>=2?`${m[0].padStart(2,"0")}:${m[1].padStart(2,"0")}`:s},ie=({type:s})=>e.jsxs("div",{className:"pt-4 border-t space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-md text-foreground",children:[s==="lec"?"Lecture":"Laboratory"," Room"]}),U[s]?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx(ce,{className:"h-6 w-6 animate-spin text-primary"})}):O[s].length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto pr-2 -mr-2",children:O[s].map(m=>{const f=m.availabilities||[],d=u[s].day||"",N=f.filter(p=>(p.day||"").toString().toLowerCase()===d.toString().toLowerCase()),T=N.length>0?N.map(p=>`${le(p.start_time??p.start)}-${le(p.end_time??p.end)}`).join(", "):"No availability on selected day";return e.jsxs("button",{onClick:()=>M(p=>({...p,[s]:m.id})),className:`p-2 border rounded-md text-left transition-all relative ${_[s]===m.id?"bg-primary/10 border-primary shadow-sm":"bg-background hover:border-primary/50"}`,children:[_[s]===m.id&&e.jsx(X,{className:"h-4 w-4 text-primary absolute top-2 right-2"}),e.jsx("p",{className:"font-semibold text-sm",children:m.roomNumber}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Cap: ",m.capacity??"--"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:u[s].day?e.jsxs(e.Fragment,{children:[e.jsx("strong",{className:"text-foreground",children:"Day:"})," ",u[s].day," Â· ",e.jsx("strong",{className:"text-foreground",children:"Room avail:"})," ",T]}):"Select day to see room availability"})]},m.id)})}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No available rooms for this schedule."})]});return e.jsx(xe,{open:t,onOpenChange:i,children:e.jsxs(he,{className:"max-w-7xl w-[95%] h-[90vh] flex flex-col p-0",children:[e.jsxs(fe,{className:"p-6 pb-4 border-b",children:[e.jsxs(ge,{className:"text-2xl font-bold tracking-tight",children:["Assign Subject to ",r.name]}),e.jsx(pe,{children:"Follow the steps below to search, select, and schedule a subject."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 flex-grow overflow-y-auto px-6 py-6",children:[e.jsxs("div",{className:"bg-muted/40 p-4 rounded-lg flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg transition-colors ${l?"bg-green-500 text-white":"bg-primary text-primary-foreground"}`,children:l?e.jsx(X,{className:"h-5 w-5"}):"1"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Select a Subject"})]}),e.jsxs("div",{className:"flex flex-col flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(be,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx(J,{placeholder:"Search subjects...",value:x,onChange:s=>w(s.target.value),className:"pl-10 bg-background"})]}),e.jsxs(B,{variant:"outline",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"})," Generate"]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 -mr-2 pr-2",children:I.length>0?I.map(s=>e.jsxs("button",{onClick:()=>A(s),className:`w-full text-left p-3 rounded-md border transition-all duration-200 relative ${l?.id===s.id?"bg-primary/10 border-primary shadow-sm":"bg-background hover:border-primary/50 hover:bg-primary/5"}`,children:[l?.id===s.id&&e.jsx(De,{className:"h-5 w-5 text-primary absolute top-3 right-3"}),e.jsxs("p",{className:"font-semibold text-foreground pr-6",children:[s.subject_code," - ",s.des_title]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Total Hours: ",e.jsx("strong",{children:s.total_hrs??0})]}),e.jsxs("span",{children:["Lec Hrs: ",e.jsx("strong",{children:s.total_lec_hrs??0})]}),e.jsxs("span",{children:["Lab Hrs: ",e.jsx("strong",{children:s.total_lab_hrs??0})]})]})]},s.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground rounded-lg bg-background border-2 border-dashed p-4",children:[e.jsx(qe,{className:"h-10 w-10 mb-3"}),e.jsx("p",{className:"font-semibold",children:"No Subjects Found"}),e.jsx("p",{className:"text-sm",children:x?`No results for "${x}".`:"No subjects available."})]})})]})]}),e.jsxs("div",{className:`bg-muted/40 p-4 rounded-lg flex flex-col transition-all ${c<2&&"opacity-50 pointer-events-none"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg transition-colors ${c>=2&&v&&b?"bg-green-500 text-white":c>=2?"bg-primary text-primary-foreground":"bg-muted-foreground/30 text-muted-foreground"}`,children:c>=2&&v&&b?e.jsx(X,{className:"h-5 w-5"}):"2"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Set Schedule"})]}),c>=2&&e.jsx("div",{className:"flex-grow overflow-y-auto -mr-2 pr-2",children:ee?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(ce,{className:"h-8 w-8 animate-spin text-primary"})}):Se?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{className:"block text-sm font-semibold text-foreground mb-2",children:"Faculty's Weekly Availability"}),e.jsx(es,{schedule:C})]}),(l?.total_lec_hrs??0)>0&&e.jsx(re,{type:"lec",hours:l?.total_lec_hrs??0}),(l?.total_lab_hrs??0)>0&&e.jsx(re,{type:"lab",hours:l?.total_lab_hrs??0})]}):e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-destructive/10 border-destructive/30 rounded-lg text-destructive",children:[e.jsx(Oe,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("p",{className:"text-sm font-medium",children:"This faculty has no availability set."})]})})]}),e.jsxs("div",{className:`bg-muted/40 p-4 rounded-lg flex flex-col transition-all ${c<3&&"opacity-50 pointer-events-none"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center font-bold text-lg transition-colors ${c>=3&&P&&V?"bg-green-500 text-white":c>=3?"bg-primary text-primary-foreground":"bg-muted-foreground/30 text-muted-foreground"}`,children:c>=3&&P&&V?e.jsx(X,{className:"h-5 w-5"}):"3"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Select Room"})]}),c>=3&&e.jsxs("div",{className:"flex-grow overflow-y-auto -mr-2 pr-2 space-y-4",children:[(l?.total_lec_hrs??0)>0&&e.jsx(ie,{type:"lec"}),(l?.total_lab_hrs??0)>0&&e.jsx(ie,{type:"lab"})]})]})]}),e.jsxs(Fe,{className:"p-6 pt-4 border-t bg-background",children:[e.jsx(Me,{asChild:!0,children:e.jsx(B,{variant:"outline",children:"Cancel"})}),e.jsx(B,{onClick:E,disabled:we,children:"Assign Subject"})]})]})})}var as=Symbol.for("react.lazy"),K=Te[" use ".trim().toString()];function rs(t){return typeof t=="object"&&t!==null&&"then"in t}function je(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===as&&"_payload"in t&&rs(t._payload)}function ls(t){const i=is(t),r=a.forwardRef((o,n)=>{let{children:c,...h}=o;je(c)&&typeof K=="function"&&(c=K(c._payload));const x=a.Children.toArray(c),w=x.find(ns);if(w){const l=w.props.children,A=x.map(u=>u===w?a.Children.count(l)>1?a.Children.only(null):a.isValidElement(l)?l.props.children:null:u);return e.jsx(i,{...h,ref:n,children:a.isValidElement(l)?a.cloneElement(l,void 0,A):null})}return e.jsx(i,{...h,ref:n,children:c})});return r.displayName=`${t}.Slot`,r}function is(t){const i=a.forwardRef((r,o)=>{let{children:n,...c}=r;if(je(n)&&typeof K=="function"&&(n=K(n._payload)),a.isValidElement(n)){const h=ds(n),x=cs(c,n.props);return n.type!==a.Fragment&&(x.ref=o?$e(o,h):h),a.cloneElement(n,x)}return a.Children.count(n)>1?a.Children.only(null):null});return i.displayName=`${t}.SlotClone`,i}var os=Symbol("radix.slottable");function ns(t){return a.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===os}function cs(t,i){const r={...i};for(const o in i){const n=t[o],c=i[o];/^on[A-Z]/.test(o)?n&&c?r[o]=(...x)=>{const w=c(...x);return n(...x),w}:n&&(r[o]=n):o==="style"?r[o]={...n,...c}:o==="className"&&(r[o]=[n,c].filter(Boolean).join(" "))}return{...t,...r}}function ds(t){let i=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=i&&"isReactWarning"in i&&i.isReactWarning;return r?t.ref:(i=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=i&&"isReactWarning"in i&&i.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var ms=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],us=ms.reduce((t,i)=>{const r=ls(`Primitive.${i}`),o=a.forwardRef((n,c)=>{const{asChild:h,...x}=n,w=h?r:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(w,{...x,ref:c})});return o.displayName=`Primitive.${i}`,{...t,[i]:o}},{}),xs="Separator",me="horizontal",hs=["horizontal","vertical"],ye=a.forwardRef((t,i)=>{const{decorative:r,orientation:o=me,...n}=t,c=fs(o)?o:me,x=r?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return e.jsx(us.div,{"data-orientation":c,...x,...n,ref:i})});ye.displayName=xs;function fs(t){return hs.includes(t)}var ve=ye;const Ne=a.forwardRef(({className:t,orientation:i="horizontal",decorative:r=!0,...o},n)=>e.jsx(ve,{ref:n,decorative:r,orientation:i,className:Ae("shrink-0 bg-border",i==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...o}));Ne.displayName=ve.displayName;function gs({isOpen:t,onClose:i,faculty:r}){if(!r)return null;const o=r.assignedSubjects&&r.assignedSubjects.length>0;return e.jsx(xe,{open:t,onOpenChange:i,children:e.jsxs(he,{className:"sm:max-w-lg",children:[e.jsxs(fe,{children:[e.jsx(ge,{className:"text-2xl",children:"Assigned Subjects"}),e.jsxs(pe,{children:["Viewing schedule for ",e.jsx("span",{className:"font-semibold text-primary",children:r.name}),"."]})]}),e.jsx("div",{className:"mt-4 max-h-[60vh] overflow-y-auto pr-2",children:o?e.jsx("ul",{className:"space-y-4",children:r.assignedSubjects.map((n,c)=>e.jsxs("li",{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:n.des_title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.subject_code})]}),e.jsx(ae,{variant:"secondary",className:"font-mono text-xs",children:n.schedule.time})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Schedule: ",e.jsx("span",{className:"font-medium text-foreground",children:n.schedule.day})]}),c<r.assignedSubjects.length-1&&e.jsx(Ne,{className:"mt-4"})]},n.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center text-muted-foreground bg-muted/50 rounded-lg",children:[e.jsx(We,{size:40,className:"mb-4 text-slate-500"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"No Subjects Assigned"}),e.jsx("p",{className:"text-sm",children:"This faculty member does not have any subjects yet."})]})})]})})}const ps={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.08}}};function bs(){const[t,i]=a.useState([]),[r,o]=a.useState([]),[n,c]=a.useState([]),[h,x]=a.useState(""),[w,l]=a.useState(!0),[A,u]=a.useState(!1),[D,_]=a.useState(null),[M,O]=a.useState(!1),[L,U]=a.useState(null);a.useEffect(()=>{(async()=>{l(!0);try{const j=localStorage.getItem("accessToken");if(!j){te.fire({icon:"warning",title:"Authentication Error",text:"You must be logged in."}),l(!1);return}const y={headers:{Authorization:`Bearer ${j}`}},[v,b]=await Promise.all([W.get("/faculties",y),W.get("/get-subjects",y)]),I=[{id:101,subject_code:"CS 101",des_title:"Intro to Programming",schedule:{day:"MWF",time:"10:00 - 11:00 AM"}},{id:102,subject_code:"IT 203",des_title:"Database Systems",schedule:{day:"TTH",time:"1:00 - 2:30 PM"}}],z=v.data.faculties.map((E,P)=>({id:E.id,name:E.user.name,expertise:E.expertises.map(V=>V.list_of_expertise),availability:{},maxUnits:E.t_load_units,assignedSubjects:P===0?I:[],profile_picture:E.profile_picture}));i(z),o(b.data.subject||[])}catch(j){console.error("Error fetching data:",j),te.fire({icon:"error",title:"Fetch Error",text:"Failed to retrieve data from the server."})}finally{l(!1)}})()},[]);const R=t.filter(g=>g.name.toLowerCase().includes(h.toLowerCase())||g.expertise.some(j=>j.toLowerCase().includes(h.toLowerCase()))),k=g=>{const j=g.expertise.map(y=>y.toLowerCase().trim());if(j.length===0)c(r);else{const y=r.filter(v=>{const b=`${v.des_title} ${v.subject_code}`.toLowerCase();return j.some(I=>b.includes(I))});c(y)}_(g),u(!0)},Y=()=>{u(!1),_(null),c([])},C=g=>{U(g),O(!0)},q=()=>{O(!1),U(null)},ee=(g,j,y)=>{console.log("Assigning Subject:",{facultyId:g,subjectId:j,schedules:y});const v=y.map(b=>`${b.type} ${b.day} at ${b.time}${b.roomId?` (Room ${b.roomId})`:""}`).join("; ");te.fire({icon:"success",title:"Assignment Recorded",text:`Subject ${j} assigned to faculty ${g}: ${v}`,timer:2e3,showConfirmButton:!1})};return e.jsxs(e.Fragment,{children:[e.jsxs(Le,{children:[A&&D&&e.jsx(ts,{isOpen:A,onClose:Y,faculty:D,availableSubjects:n,onAssign:ee}),M&&L&&e.jsx(gs,{isOpen:M,onClose:q,faculty:L})]}),e.jsxs("header",{className:"mb-8 text-start",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground tracking-tight",children:"Faculty Loading"}),e.jsx("p",{className:"text-muted-foreground mt-3 ",children:"Assign subjects to faculty based on expertise and availability."})]}),e.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-sm border border-border",children:[e.jsx("div",{className:"flex justify-start mb-8",children:e.jsxs("div",{className:"relative w-full md:max-w-lg",children:[e.jsx(be,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(J,{placeholder:"Search by faculty name or expertise...",value:h,onChange:g=>x(g.target.value),className:"pl-12 h-12 rounded-full text-base"})]})}),w?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Array.from({length:6}).map((g,j)=>e.jsx(Je,{},j))}):R.length>0?e.jsx(ue.div,{variants:ps,initial:"hidden",animate:"visible",className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:R.map(g=>e.jsx(Ze,{faculty:g,onAssignClick:k,onViewSubjectsClick:C},g.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center text-muted-foreground bg-muted/50 rounded-lg border-2 border-dashed",children:[e.jsx(Ve,{size:40,className:"mb-4 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"No Faculty Found"}),e.jsxs("p",{children:['Your search for "',h,'" did not match any faculty profiles.']})]})]})]})}function Ms(){return e.jsx("main",{children:e.jsx(bs,{})})}export{Ms as default};
