import{c as je,j as e,B as _,r,X as Se,t as h,a as V,u as Ce}from"./index-DXcYVmw3.js";import{b as ae,e as v,T as _e,a as Ae,c as G,d as Fe}from"./table-BRYmrhPj.js";import{I as E}from"./input-Dh1ozGG5.js";import{S as re,a as ne,b as le,c as ie,d as K}from"./select-DGh_oc5I.js";import{B as me}from"./badge-DcyDaA5F.js";import{P as ke}from"./plus-D4orGtOb.js";import{D as he,a as xe,b as ve,c as be,e as ye,d as Te,f as Ie}from"./dialog-9bz0G8nn.js";import{L as z}from"./label-DdbtWDVU.js";import{C as Le}from"./circle-alert-R-vDJWKV.js";import{S as C}from"./skeleton-CGPDtiiA.js";import{L as Me,V as De,S as pe}from"./ViewAssignedSubjectsDialog-BTa-y5jA.js";import{L as $e}from"./loader-circle-B2W9qXRN.js";import{a as Ee,C as Pe}from"./tabs-Baoaaq0a.js";import{T as we}from"./trash-2-DrzAJ3lo.js";import{S as Be}from"./search-Dd19T1-d.js";import{F as ze}from"./funnel-CLA6V5we.js";import{C as Ve}from"./calendar-days-CsGDCGeC.js";import{S as Oe}from"./square-pen-CdpWP9vr.js";import{C as qe}from"./chevron-left-Cmo7lxGm.js";import"./Combination-Cuf1ytF1.js";import"./check-Bby-FiWF.js";import"./card-pjwBgWwe.js";import"./calendar-check-MGws4jZw.js";import"./presentation-z3vDVaLw.js";import"./map-pin-DFGNKCWs.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Re=je("briefcase",He);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],We=je("rotate-ccw",Ge);function Ye({onAdd:x}){return e.jsxs(_,{onClick:x,className:"w-full sm:w-auto",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Add Faculty"]})}const ge=[{bg:"bg-blue-100",text:"text-blue-800"},{bg:"bg-emerald-100",text:"text-emerald-800"},{bg:"bg-amber-100",text:"text-amber-800"},{bg:"bg-rose-100",text:"text-rose-800"},{bg:"bg-indigo-100",text:"text-indigo-800"},{bg:"bg-cyan-100",text:"text-cyan-800"}];function Je(x){let u=0;for(let f=0;f<x.length;f++)u=(u<<5)-u+x.charCodeAt(f),u|=0;return Math.abs(u)}function Ke({isOpen:x,onClose:u,onSave:f,initialData:p,expertiseOptions:y}){const[d,j]=r.useState({name:"",email:"",designation:"",department:"",expertise:[],status:"Active",avatar:"",profile_picture:"",deload_units:0,teaching_load_units:0,overload_units:0,t_load_units:0}),[T,w]=r.useState(null),[O,A]=r.useState(!1),[P,I]=r.useState(y),[U,l]=r.useState([]),[i,o]=r.useState(!1),[B,D]=r.useState(!1),[N,$]=r.useState(""),[oe,X]=r.useState(!1);r.useEffect(()=>{x&&(async()=>{o(!0);const n=localStorage.getItem("accessToken");if(!n){h.error("Authentication required."),o(!1);return}try{const a=await V.get("/department-program",{headers:{Authorization:`Bearer ${n}`}}),L=Array.isArray(a.data.programs)?a.data.programs:Object.values(a.data.programs||{}),F=[...new Set(L.map(ee=>ee.program_name))];l(F.sort())}catch{h.error("Failed to fetch departments.")}finally{o(!1)}})()},[x]),r.useEffect(()=>{if(p)j(p),w(p.profile_picture||null),I(y.filter(s=>!p.expertise.includes(s)));else{const s=`https://avatar.iran.liara.run/public/${Math.floor(Math.random()*100)}`;j({name:"",designation:"",expertise:[],department:"",email:"",status:"Active",avatar:s,profile_picture:"",deload_units:0,teaching_load_units:0,overload_units:0,t_load_units:0}),w(s),I(y)}$(""),X(!1)},[p,x,y]);const W=s=>{const{name:n,value:a}=s.target;let L=a;if(["deload_units","teaching_load_units","overload_units"].includes(n)){let F=Number(a);n==="teaching_load_units"&&F>24&&(h.warning("Teaching load cannot exceed 24 units."),F=24),L=F<0?0:a===""?"":F}j(F=>({...F,[n]:L}))},Z=(s,n)=>{j(a=>({...a,[s]:n}))},Y=s=>{const n=s.target.files?.[0];n&&w(URL.createObjectURL(n))},Q=s=>{$(s.target.value)},J=s=>{const n=s.trim();n&&!d.expertise.includes(n)&&(j(a=>({...a,expertise:[...a.expertise,n].sort()})),P.includes(n)&&I(a=>a.filter(L=>L!==n))),$("")},te=s=>{j(n=>({...n,expertise:n.expertise.filter(a=>a!==s)})),y.includes(s)&&!P.includes(s)&&I(n=>[...n,s].sort())},se=P.filter(s=>s.toLowerCase().includes(N.toLowerCase())).sort(),ce=oe&&(N.length>0||P.length>0),de=async s=>{s.preventDefault(),D(!0);let n;switch(d.designation){case"Dean":n=0;break;case"Program Head":n=1;break;case"Faculty":n=2;break;default:h.error("Invalid designation."),D(!1);return}const a=new FormData;a.append("name",d.name),a.append("email",d.email),a.append("role",String(n)),a.append("designation",d.designation),a.append("department",d.department),a.append("deload_units",String(d.deload_units||0)),a.append("t_load_units",String(d.teaching_load_units||0)),a.append("overload_units",String(d.overload_units||0)),d.expertise.forEach(S=>a.append("expertise[]",S));const L=document.getElementById("avatar-file");L?.files?.[0]&&a.append("avatar",L.files[0]);const F=localStorage.getItem("accessToken");if(!F){h.error("Authentication required."),D(!1);return}const ee={Authorization:`Bearer ${F}`,"Content-Type":"multipart/form-data"};try{const S=!!p,q=S?`/faculties/${p.id}`:"/faculties";S&&a.append("_method","PUT");const H=await V.post(q,a,{headers:ee});h.success(H.data.message||"Faculty saved successfully!");const b=H.data.faculty,ue={id:b.id,name:b.user?.name||"N/A",email:b.user?.email||"N/A",role:b.user?.role,designation:b.designation||"",department:b.department||"",status:b.status===0?"Active":"Inactive",profile_picture:b.profile_picture?`https://green-deer-882383.hostingersite.com/${b.profile_picture}`:`https://avatar.iran.liara.run/public/boy?username=${(b.user?.name||"").replace(/\s/g,"")}`,expertise:b.expertises?.map(t=>t.list_of_expertise)||[],deload_units:b.deload_units||0,t_load_units:b.t_load_units||0,overload_units:b.overload_units||0};f(ue),u()}catch(S){if(V.isAxiosError(S)&&S.response){const q=S.response.data.errors;if(q){const H=Object.values(q)[0][0];h.error(H)}else h.error(S.response.data.message||"An error occurred.")}else h.error("Failed to connect to the server.")}finally{D(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(he,{open:x,onOpenChange:u,children:e.jsxs(xe,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ve,{children:e.jsx(be,{className:"text-2xl font-bold text-foreground",children:p?"Edit Faculty":"Add New Faculty"})}),e.jsxs("form",{onSubmit:de,className:"py-4 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("button",{type:"button",onClick:()=>T&&A(!0),className:"focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary rounded-full disabled:cursor-not-allowed",disabled:!T,title:"Click to preview image",children:e.jsx("img",{src:T||"https://via.placeholder.com/80",alt:"Profile Preview",className:"w-20 h-20 rounded-full object-cover border-2 border-border cursor-pointer hover:opacity-80 transition-opacity"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(E,{id:"avatar-file",type:"file",accept:"image/png, image/jpeg",onChange:Y,className:"block w-full text-sm text-muted-foreground file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20 cursor-pointer"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"PNG or JPG. Max 2MB."})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"name",children:"Full Name"}),e.jsx(E,{id:"name",name:"name",value:d.name,onChange:W,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"email",children:"Email Address"}),e.jsx(E,{id:"email",name:"email",type:"email",value:d.email,onChange:W,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"designation",children:"Designation"}),e.jsxs(re,{value:d.designation,onValueChange:s=>Z("designation",s),required:!0,children:[e.jsx(ne,{children:e.jsx(le,{placeholder:"Select a designation"})}),e.jsxs(ie,{children:[e.jsx(K,{value:"Dean",children:"Dean"}),e.jsx(K,{value:"Program Head",children:"Program Head"}),e.jsx(K,{value:"Faculty",children:"Faculty"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"department",children:"Department"}),e.jsxs(re,{value:d.department,onValueChange:s=>Z("department",s),required:!0,children:[e.jsx(ne,{disabled:i,children:e.jsx(le,{placeholder:i?"Loading...":"Select a department"})}),e.jsx(ie,{children:U.length>0?U.map(s=>e.jsx(K,{value:s,children:s},s)):e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:i?"Loading...":"No departments."})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 border-t pt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"deload_units",children:"Deload Units"}),e.jsx(E,{id:"deload_units",name:"deload_units",type:"number",value:d.deload_units||"",onChange:W,placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"teaching_load_units",children:"Teaching Load"}),e.jsx(E,{id:"teaching_load_units",name:"teaching_load_units",type:"number",value:d.teaching_load_units||"",onChange:W,placeholder:"e.g. 18"}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Le,{size:12})," Max load is 24 units."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"overload_units",children:"Overload Units"}),e.jsx(E,{id:"overload_units",name:"overload_units",type:"number",value:d.overload_units||"",onChange:W,placeholder:"0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"expertise-input",children:"Expertise"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex flex-wrap items-center w-full rounded-md border border-input bg-background text-sm ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2 min-h-10 p-1.5",children:[d.expertise.map(s=>{const n=Je(s)%ge.length,a=ge[n];return e.jsxs(me,{className:`font-normal hover:${a.bg} ${a.bg} hover:${a.text} ${a.text} mr-1.5 mb-1.5`,children:[s,e.jsx("button",{type:"button",onClick:()=>te(s),className:"ml-1.5 rounded-full hover:bg-black/10 p-0.5","aria-label":`Remove ${s}`,children:e.jsx(Se,{size:14})})]},s)}),e.jsx(E,{id:"expertise-input",value:N,onChange:Q,onKeyDown:s=>{s.key==="Enter"&&N.trim()!==""&&(s.preventDefault(),J(N))},onFocus:()=>X(!0),onBlur:()=>{setTimeout(()=>X(!1),100)},placeholder:d.expertise.length===0?"Type to add or select expertise...":"",className:"border-none focus-visible:ring-0 focus-visible:ring-offset-0 h-8 p-0 flex-1 min-w-[50px] bg-transparent shadow-none",autoComplete:"off"})]}),ce&&e.jsxs("div",{className:"absolute z-10 w-full bg-popover border border-input rounded-md shadow-lg mt-1 max-h-48 overflow-y-auto",children:[!d.expertise.map(s=>s.toLowerCase()).includes(N.trim().toLowerCase())&&!P.map(s=>s.toLowerCase()).includes(N.trim().toLowerCase())&&N.trim()!==""&&e.jsxs("div",{className:"px-4 py-2 cursor-pointer bg-primary text-primary-foreground hover:bg-primary/90 text-center border-b font-medium",onClick:()=>J(N),onMouseDown:s=>s.preventDefault(),children:["Add New Expertise: **",N.trim(),"**"]}),se.length>0?se.map(s=>e.jsx("div",{className:"px-4 py-2 cursor-pointer hover:bg-accent hover:text-accent-foreground",onClick:()=>J(s),onMouseDown:n=>n.preventDefault(),children:s},s)):N.trim()===""&&e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"All expertise selected."})]})]})]}),e.jsxs(ye,{className:"mt-8 pt-4 border-t border-border",children:[e.jsx(Te,{asChild:!0,children:e.jsx(_,{type:"button",variant:"outline",disabled:B,children:"Cancel"})}),e.jsx(_,{type:"submit",disabled:B,children:B?"Saving...":p?"Save Changes":"Save Faculty"})]})]})]})}),e.jsx(he,{open:O,onOpenChange:A,children:e.jsx(xe,{className:"sm:max-w-lg p-2 bg-transparent border-none shadow-none",children:e.jsx("img",{src:T||"",alt:"Profile Preview Large",className:"w-full h-auto rounded-lg object-contain max-h-[80vh]"})})})]})}const Ue=()=>e.jsxs(ae,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{className:"h-11 w-11 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"h-4 w-40"}),e.jsx(C,{className:"h-3 w-24"})]})]})}),e.jsx(v,{children:e.jsx(C,{className:"h-4 w-48"})}),e.jsx(v,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{className:"h-5 w-20 rounded-full"}),e.jsx(C,{className:"h-5 w-20 rounded-full"})]})}),e.jsx(v,{className:"text-center",children:e.jsx(C,{className:"h-4 w-10 mx-auto"})}),e.jsx(v,{className:"text-center",children:e.jsx(C,{className:"h-4 w-10 mx-auto"})}),e.jsx(v,{className:"text-center",children:e.jsx(C,{className:"h-4 w-10 mx-auto"})}),e.jsx(v,{children:e.jsx(C,{className:"h-6 w-20 rounded-full"})}),e.jsx(v,{children:e.jsxs("div",{className:"flex justify-end items-center gap-1",children:[e.jsx(C,{className:"h-8 w-8 rounded-md"}),e.jsx(C,{className:"h-8 w-8 rounded-md"}),e.jsx(C,{className:"h-8 w-8 rounded-md"}),e.jsx(C,{className:"h-8 w-8 rounded-md"})]})})]}),Xe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Qe({isOpen:x,onClose:u,faculty:f}){const[p,y]=r.useState({}),[d,j]=r.useState(!0),[T,w]=r.useState(!1);if(r.useEffect(()=>{x&&f&&(async()=>{j(!0);const i=localStorage.getItem("accessToken");if(!i){h.error("Authentication required."),j(!1);return}try{const o=await V.get(`/faculties/${f.id}/availability`,{headers:{Authorization:`Bearer ${i}`}});y(o.data)}catch{h.error("Could not fetch the existing schedule for this faculty."),y({})}finally{j(!1)}})()},[x,f]),!f)return null;const O=l=>{const i={id:Date.now(),start:"",end:""};y(o=>({...o,[l]:[...o[l]||[],i]}))},A=(l,i,o,B)=>{y(D=>{const N=(D[l]||[]).map($=>$.id===i?{...$,[o]:B}:$);return{...D,[l]:N}})},P=(l,i)=>{y(o=>({...o,[l]:(o[l]||[]).filter(B=>B.id!==i)}))},I=async()=>{for(const i in p)for(const o of p[i]){if(!o.start||!o.end){h.error(`Please complete all time fields for ${i}.`);return}if(o.start>=o.end){h.error(`On ${i}, the end time must be after the start time.`);return}}w(!0);const l=localStorage.getItem("accessToken");if(!l){h.error("Authentication required. Please log in again."),w(!1);return}try{const i=await V.post(`/faculties/${f.id}/availability`,p,{headers:{Authorization:`Bearer ${l}`}});h.success(i.data.message||"Schedule updated successfully."),u()}catch(i){const o=i.response?.data?.message||"An unknown error occurred while saving.";h.error(o)}finally{w(!1)}},U=l=>{l||u()};return e.jsx(he,{open:x,onOpenChange:U,children:e.jsxs(xe,{className:"sm:max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs(ve,{children:[e.jsxs(be,{children:["Set Availability for ",f.name]}),e.jsx(Ie,{children:"Add or update time slots for each day the faculty is available to teach."})]}),e.jsx("div",{className:"flex-grow overflow-y-auto pr-4 -mr-4 space-y-6 py-4",children:d?e.jsxs("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:[e.jsx($e,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"ml-4",children:"Loading existing schedule..."})]}):Xe.map(l=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold",children:l}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>O(l),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Add time slot"]})]}),p[l]&&p[l].length>0?e.jsx("div",{className:"space-y-2 pl-4 border-l-2",children:p[l].map(i=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{type:"time",value:i.start,onChange:o=>A(l,i.id,"start",o.target.value)}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(E,{type:"time",value:i.end,onChange:o=>A(l,i.id,"end",o.target.value)}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>P(l,i.id),title:"Remove slot",children:e.jsx(we,{className:"h-4 w-4 text-destructive"})})]},i.id))}):e.jsx("p",{className:"text-sm text-muted-foreground pl-4",children:"Not available on this day."})]},l))}),e.jsxs(ye,{className:"mt-4 pt-4 border-t",children:[e.jsx(_,{variant:"outline",onClick:u,disabled:T,children:"Cancel"}),e.jsx(_,{onClick:I,disabled:T||d,children:T?"Saving...":"Save Schedule"})]})]})})}const fe=[{bg:"bg-blue-100",text:"text-blue-800"},{bg:"bg-emerald-100",text:"text-emerald-800"},{bg:"bg-amber-100",text:"text-amber-800"},{bg:"bg-rose-100",text:"text-rose-800"},{bg:"bg-indigo-100",text:"text-indigo-800"},{bg:"bg-cyan-100",text:"text-cyan-800"},{bg:"bg-pink-100",text:"text-pink-800"}],Ze=x=>{let u=0;for(let f=0;f<x.length;f++)u=(u<<5)-u+x.charCodeAt(f),u|=0;return Math.abs(u)};function et(){const[x,u]=r.useState([]),[f,p]=r.useState(!0),[y,d]=r.useState(""),[j,T]=r.useState({department:"All",status:"Active"}),[w,O]=r.useState(1),[A]=r.useState(10),[P,I]=r.useState(!1),[U,l]=r.useState(null),[i,o]=r.useState([]),[B,D]=r.useState(!1),[N,$]=r.useState(null),[oe,X]=r.useState(!1),[W,Z]=r.useState(null),[Y,Q]=r.useState(null),J=Ce(),te=r.useCallback(async()=>{p(!0);const t=localStorage.getItem("accessToken");if(!t){h.error("Authentication required."),p(!1),J("/facultyscheduler/user-login");return}try{const c=await V.get("/faculties",{headers:{Authorization:`Bearer ${t}`}}),m=c.data.faculties||[],g=c.data.inactive_faculties||[],R=k=>({id:k.id,name:k.user?.name||"N/A",email:k.user?.email||"N/A",role:k.user?.role,designation:k.designation||"",department:k.department||"",status:k.status===0?"Active":"Inactive",profile_picture:k.profile_picture?`https://green-deer-882383.hostingersite.com/${k.profile_picture}`:null,expertise:k.expertises?.map(Ne=>Ne.list_of_expertise)||[],deload_units:k.deload_units||0,t_load_units:k.t_load_units||0,overload_units:k.overload_units||0}),M=[...m.map(R),...g.map(R)];u(M)}catch{h.error("Failed to fetch faculty data."),J("/facultyscheduler/user-login")}finally{p(!1)}},[J]);r.useEffect(()=>{(async()=>{const c=localStorage.getItem("accessToken");if(c)try{const m=await V.get("/department-program",{headers:{Authorization:`Bearer ${c}`}}),g=Array.isArray(m.data.programs)?m.data.programs:Object.values(m.data.programs||{}),R=[...new Set(g.map(M=>M.program_name))];o(R.sort())}catch(m){console.error("Failed to fetch departments for filter:",m)}})()},[]),r.useEffect(()=>{te()},[te]);const se=t=>{if(I(!1),x.some(m=>m.id===t.id))u(m=>m.map(g=>g.id===t.id?t:g)),Q(t.id),globalThis.setTimeout(()=>Q(null),5e3);else{const m={...t,status:"Active"};u(g=>[m,...g]),O(1),Q(m.id),globalThis.setTimeout(()=>Q(null),5e3)}},ce=t=>{pe.fire({title:"Are you sure?",text:"This faculty will be marked as inactive.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, deactivate it!"}).then(async c=>{if(c.isConfirmed){const m=localStorage.getItem("accessToken");if(!m){h.error("Authentication required.");return}try{const g=await V.delete(`/faculties/${t}`,{headers:{Authorization:`Bearer ${m}`}});h.success(g.data.message||"Faculty deactivated."),u(R=>R.map(M=>M.id===t?{...M,status:"Inactive"}:M))}catch{h.error("Failed to deactivate faculty.")}}})},de=t=>{pe.fire({title:"Activate this faculty?",text:"This will make the faculty available again.",icon:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",confirmButtonText:"Yes, activate it!"}).then(async c=>{if(c.isConfirmed){const m=localStorage.getItem("accessToken");if(!m){h.error("Authentication required.");return}try{const g=await V.post(`/faculties/${t}/activate`,{},{headers:{Authorization:`Bearer ${m}`}});h.success(g.data.message||"Faculty activated."),u(R=>R.map(M=>M.id===t?{...M,status:"Active"}:M))}catch{h.error("Failed to activate faculty.")}}})},s=()=>{l(null),I(!0)},n=t=>{l(t),I(!0)},a=t=>{$(t),D(!0)},L=()=>{D(!1),$(null)},F=t=>{Z(t),X(!0)},ee=()=>{X(!1),Z(null)},S=r.useMemo(()=>x.filter(t=>t.id===Y||j.status==="All"||t.status===j.status).filter(t=>t.id===Y||j.department==="All"||t.department===j.department).filter(t=>{const c=y.toLowerCase();return t.id===Y||(t.name||"").toLowerCase().includes(c)||(t.department||"").toLowerCase().includes(c)||(t.designation||"").toLowerCase().includes(c)||(t.expertise||[]).some(m=>(m||"").toLowerCase().includes(c))}),[x,y,j,Y]),q=r.useMemo(()=>{const t=(w-1)*A;return S.slice(t,t+A)},[S,w,A]),H=Math.ceil(S.length/A),b=["All","Active","Inactive"],ue=["Computer Networks","HCI","Computer Graphics & Vision","Software Engineering","Software Development","Cyber Security","Programming","Mobile App Development","Data Science","Artificial Intelligence","Information Systems","Machine Learning","Robotics"];return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"mb-6 md:mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground tracking-tight",children:"Faculty Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"A centralized hub to add, edit, and manage all faculty members."})]}),e.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-lg shadow-sm border border-border",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center mb-6",children:[e.jsxs("div",{className:"relative w-full md:max-w-xs",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(E,{placeholder:"Search faculty...",className:"pl-10 w-full",value:y,onChange:t=>{d(t.target.value),O(1)}})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto",children:[e.jsxs(re,{value:j.department,onValueChange:t=>T(c=>({...c,department:t})),children:[e.jsxs(ne,{className:"w-full sm:w-auto md:w-[200px]",children:[e.jsx(Re,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx(le,{placeholder:"All Departments"})]}),e.jsxs(ie,{children:[e.jsx(K,{value:"All",children:"All Departments"}),i.map(t=>e.jsx(K,{value:t,children:t},t))]})]}),e.jsxs(re,{value:j.status,onValueChange:t=>T(c=>({...c,status:t})),children:[e.jsxs(ne,{className:"w-full sm:w-auto md:w-[180px]",children:[e.jsx(ze,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx(le,{placeholder:"All Statuses"})]}),e.jsx(ie,{children:b.map(t=>e.jsx(K,{value:t,children:t},t))})]}),e.jsx(Ye,{onAdd:s})]})]}),e.jsx("div",{className:"rounded-lg border border-border overflow-x-auto",children:e.jsxs(_e,{className:"min-w-[1000px]",children:[e.jsx(Ae,{className:"bg-muted/50",children:e.jsxs(ae,{children:[e.jsx(G,{className:"w-[300px]",children:"Faculty Member"}),e.jsx(G,{children:"Department"}),e.jsx(G,{children:"Expertise"}),e.jsx(G,{className:"text-center",children:"Teaching Load"}),e.jsx(G,{className:"text-center",children:"Deload"}),e.jsx(G,{className:"text-center",children:"Overload"}),e.jsx(G,{children:"Status"}),e.jsx(G,{className:"text-right w-[170px]",children:"Actions"})]})}),e.jsx(Fe,{children:f?Array.from({length:A}).map((t,c)=>e.jsx(Ue,{},c)):q.length===0?e.jsx(ae,{children:e.jsx(v,{colSpan:8,className:"text-center h-48 text-muted-foreground",children:"No Faculty Found"})}):q.map(t=>e.jsxs(ae,{className:`${Y===t.id?"ring-2 ring-yellow-400 bg-yellow-50":""}`,children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:t.profile_picture||`https://avatar.iran.liara.run/public/boy?username=${(t.name||"").replace(/\s/g,"")}`,alt:t.name,className:"w-11 h-11 rounded-full object-cover ring-2 ring-offset-2 ring-border"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground whitespace-nowrap",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-nowrap",children:t.designation})]})]})}),e.jsx(v,{className:"text-muted-foreground max-w-[200px] truncate",children:t.department}),e.jsx(v,{children:e.jsx("div",{className:"flex flex-wrap items-center gap-1.5 max-w-xs",children:t.expertise.map(c=>{const m=Ze(c)%fe.length,g=fe[m];return e.jsx(me,{className:`font-normal hover:${g.bg} ${g.bg} hover:${g.text} ${g.text}`,children:c},c)})})}),e.jsx(v,{className:"text-center font-medium",children:t.t_load_units}),e.jsx(v,{className:"text-center text-muted-foreground",children:t.deload_units}),e.jsx(v,{className:"text-center text-destructive",children:t.overload_units}),e.jsx(v,{children:e.jsx(me,{variant:t.status==="Active"?"default":"destructive",children:t.status})}),e.jsx(v,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end items-center gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",title:"View faculty load",onClick:()=>a(t),className:"h-8 w-8 text-muted-foreground hover:text-primary",children:e.jsx(Me,{className:"h-4 w-4 text-purple-500"})}),e.jsx(_,{variant:"ghost",size:"icon",title:"Set Availability",onClick:()=>F(t),className:"h-8 w-8 text-muted-foreground hover:text-primary",children:e.jsx(Ve,{className:"h-4 w-4 text-green-500"})}),e.jsx(_,{variant:"ghost",size:"icon",title:"Edit Faculty",onClick:()=>n(t),className:"h-8 w-8 text-muted-foreground hover:text-primary",children:e.jsx(Oe,{className:"h-4 w-4 text-blue-500"})}),t.status==="Active"?e.jsx(_,{variant:"ghost",size:"icon",title:"Deactivate Faculty",onClick:()=>ce(t.id),className:"h-8 w-8 text-muted-foreground hover:text-destructive",children:e.jsx(we,{className:"h-4 w-4 text-red-500"})}):e.jsx(_,{variant:"ghost",size:"icon",title:"Activate Faculty",onClick:()=>de(t.id),className:"h-8 w-8 text-muted-foreground hover:text-green-600",children:e.jsx(We,{className:"h-4 w-4 text-green-500"})})]})})]},t.id))})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-6 text-sm gap-4",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Showing ",e.jsx("strong",{children:q.length>0?(w-1)*A+1:0})," to ",e.jsx("strong",{children:Math.min(w*A,S.length)})," of ",e.jsx("strong",{children:S.length})," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>O(t=>Math.max(1,t-1)),disabled:w===1,children:[e.jsx(qe,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("span",{className:"font-medium text-foreground px-2",children:["Page ",w," of ",H||1]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>O(t=>Math.min(H,t+1)),disabled:w>=H,children:["Next",e.jsx(Pe,{className:"h-4 w-4 ml-1"})]})]})]})]}),e.jsx(Ke,{isOpen:P,onClose:()=>I(!1),onSave:se,initialData:U,expertiseOptions:ue}),e.jsx(De,{isOpen:B,onClose:L,faculty:N}),e.jsx(Qe,{isOpen:oe,onClose:ee,faculty:W})]})}function _t(){return e.jsx(et,{})}export{_t as default};
